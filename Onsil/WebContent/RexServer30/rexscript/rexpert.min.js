/**
 * CLIPSOFT Javascript Library for Rexpert 3.0
 * Copyright 2014 CLIPSOFT Corp.
 * Version : 20141215
 * http://www.clipsoft.co.kr
 * 기술지원 문의 - http://tech.clipsoft.co.kr
 * 본 소스의 저작권은 (주)클립소프트에 있으며, 무단 수정 및 배포를 금지합니다.
 * 본 소스의 무단 수정에 따른 리포트 서버 작동이상에 대한 기술지원은 불가함을 알립니다.
 */
eval(function(c,l,i,p,s,o,f,t){s=function(i){return(i<l?"":s(parseInt(i/l)))+((i=i%l)>35?String.fromCharCode(i+29):i.toString(36))};if(!''.replace(/^/,String)){while(i--)o[s(i)]=p[i]||s(i);p=[function(s){return o[s]}];s=function(){return'\\w+'};i=1;};while(i--)if(p[i])c=c.replace(new RegExp('\\b'+s(i)+'\\b','g'),p[i]);return c;}('8 b="1n+/=";8 1="1l+1h/1i/1e+1d+1c+1f+1g+1b+16+14+13+17+1a+19+18+1j+1u+1t+1s+d+1v/1y+1x+t+1w+j+1r+r+1m+r+1k+t+1q+1p+1o+12+K+I+H+G+J+j+M+L+F+u+z+u+y+B+E+D+C+X+j+W+V+Y+11+10+Z+U+P+O+N+Q+T+S+R+1z+2a+29+q+28+2b+2e+2d+2c+q+23+22+21+j+27+26+25+2n+2o+2m+2q+2p+2r/2h+2g+2f+2i/2l/2k/2j/1J+1I/h+d+1H+1M+1L/h+d+1K/1G/1C/h+d+1B+1A/h+d+1E/1D/1N+1X+1W/1V+20/1Z+1Y+1U+1Q+1P=";8 5="";8 k,m,n,l,a,7,c="";8 i=0;8 1T=/[^A-v-s-9\\+\\/\\=]/g;1=1.1S(/[^A-v-s-9\\+\\/\\=]/g,"");1R{l=b.e(1.f(i++));a=b.e(1.f(i++));7=b.e(1.f(i++));c=b.e(1.f(i++));k=(l<<2)|(a>>4);m=((a&15)<<4)|(7>>2);n=((7&3)<<6)|c;5=5+p.o(k);w(7!=x){5=5+p.o(m)}w(c!=x){5=5+p.o(n)}k=m=n="";l=a=7=c=""}1O(i<1.1F);24(5);',62,152,'|EmbR||||AcR5||zRBG|var||CX8e|k0e0y0S|n6dE|PC9pZnJhbWU|indexOf|charAt||aWQ9IiArIHRoaXMuaWQgKyAiJyB3aWR0aD0nMCcgaGVpZ2h0PScwJyBmcmFtZWJvcmRlcj0nMCc||PC9jb25maWctcGFyYW0|X9qV|wJDZ|sxY6|J0lf|fromCharCode|String|IiArIHBhdGggKyAiPC9jb25maWctcGFyYW0|IjsNCiAgICAgICAgICAgIHNiICs9ICIgPC9wbHVnaW4|z0|IjsNCiAgICAgICAgICAgIHNiICs9ICIgICAgICA8Y29uZmlnLXBhcmFtLWxpc3Q|PCFbQ0RBVEFbIiArIGtleVZhbHVlICsgIl1dPjwvZmllbGQ|Za|if|64|IjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBzYiArPSAiPC9maWVsZC1saXN0PiI7DQogICAgICAgIHJldHVybiBzYjsNCiAgICB9Ow0KICAgIHJleF9SZWJGaWxlLnByb3RvdHlwZS50b1N0cmluZ0NvbmZpZ1BhcmFtID0gZnVuY3Rpb24oY29uZmlncGFyYW0pIHsNCiAgICAgICAgdmFyIHNiID0gIiI7DQogICAgICAgIHNiICs9ICI8Y29uZmlnLXBhcmFtLWxpc3Q|IjsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgc2IgKz0gIjxmaWVsZCBuYW1lPSciICsga2V5ICsgIic||IjsNCiAgICAgICAgZm9yICggdmFyIGtleSBpbiBjb25maWdwYXJhbSkgew0KICAgICAgICAgICAgc2IgKz0gIjxjb25maWctcGFyYW0gbmFtZT0nIiArIGtleSArICInPjwhW0NEQVRBWyIgKyBjb25maWdwYXJhbVtrZXldLnZhbHVlICsgIl1dPjwvY29uZmlnLXBhcmFtPiI7DQogICAgICAgIH0NCiAgICAgICAgc2IgKz0gIjwvY29uZmlnLXBhcmFtLWxpc3Q|PCFbQ0RBVEFbIiArIG9IdHRwUGFyYW1zW2tleV0udmFsdWVbaV0gKyAiXV0|IjsNCiAgICAgICAgdmFyIHNIdHRwUGFyYW1zID0gIiI7DQogICAgICAgIGlmIChvSHR0cFBhcmFtcyAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIGZvciAoIHZhciBrZXkgaW4gb0h0dHBQYXJhbXMpIHsNCiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIChvSHR0cFBhcmFtc1trZXldLnZhbHVlKSA9PSAib2JqZWN0Iikgew0KICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9IdHRwUGFyYW1zW2tleV0udmFsdWUubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNIdHRwUGFyYW1zICs9ICI8aHR0cC1wYXJhbSBuYW1lPSciICsga2V5ICsgIic|IjsNCiAgICAgICAgcmV0dXJuIHNiOw0KICAgIH07DQp9IC8vIGVuZCBvZiByZXhfUmViRmlsZQ0KDQpmdW5jdGlvbiByZXhfUmViU3ViUmVwb3J0KCkgew0KICAgIHRoaXMuaWQgPSBhcmd1bWVudHNbMF07DQogICAgdGhpcy5wYXJhbXMgPSB7fTsNCiAgICB0aGlzLmh0dHBwYXJhbXMgPSB7fTsNCiAgICB0aGlzLmNvbmZpZ3BhcmFtcyA9IHt9Ow0KICAgIHRoaXMuZGF0YXNldHMgPSB7fTsNCiAgICByZXhfUmViU3ViUmVwb3J0LnByb3RvdHlwZS5wYXJhbSA9IGZ1bmN0aW9uKGlkKSB7DQogICAgICAgIGlmICh0aGlzLnBhcmFtc1tpZF0gPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICB0aGlzLnBhcmFtc1tpZF0gPSB7fTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gdGhpcy5wYXJhbXNbaWRdOw0KICAgIH07DQogICAgcmV4X1JlYlN1YlJlcG9ydC5wcm90b3R5cGUuaHR0cHBhcmFtID0gZnVuY3Rpb24oaWQpIHsNCiAgICAgICAgaWYgKHRoaXMuaHR0cHBhcmFtc1tpZF0gPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICB0aGlzLmh0dHBwYXJhbXNbaWRdID0ge307DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cHBhcmFtc1tpZF07DQogICAgfTsNCiAgICByZXhfUmViU3ViUmVwb3J0LnByb3RvdHlwZS5jb25maWdwYXJhbSA9IGZ1bmN0aW9uKGlkKSB7DQogICAgICAgIGlmICh0aGlzLmNvbmZpZ3BhcmFtc1tpZF0gPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICB0aGlzLmNvbmZpZ3BhcmFtc1tpZF0gPSB7fTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gdGhpcy5jb25maWdwYXJhbXNbaWRdOw0KICAgIH07DQogICAgcmV4X1JlYlN1YlJlcG9ydC5wcm90b3R5cGUuZGF0YXNldCA9IGZ1bmN0aW9uKGlkKSB7DQogICAgICAgIGlmICh0aGlzLmRhdGFzZXRzW2lkXSA9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIHRoaXMuZGF0YXNldHNbaWRdID0ge307DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YXNldHNbaWRdOw0KICAgIH07DQp9IC8vIGVuZCBvZiByZXhfUmViU3ViUmVwb3J0DQoNCmZ1bmN0aW9uIHJleF9SZWJDb25uZWN0aW9uKCkgew0KICAgIHJleF9SZWJDb25uZWN0aW9uLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKG9QYXJhbSwgb0h0dHBQYXJhbXMsIG9Db25maWdQYXJhbXMsIG9EYXRhU2V0cykgew0KICAgICAgICB2YXIgc2IgPSAiIjsNCiAgICAgICAgdmFyIHR5cGUgPSBvUGFyYW1bInR5cGUiXTsNCiAgICAgICAgdmFyIG5hbWVzcGFjZSA9IG9QYXJhbVsibmFtZXNwYWNlIl07DQogICAgICAgIHZhciBwYXRoID0gb1BhcmFtWyJwYXRoIl07DQogICAgICAgIHZhciBodHRwbWV0aG9kID0gb1BhcmFtWyJodHRwbWV0aG9kIl07DQogICAgICAgIHZhciBodHRwZW5jb2RpbmcgPSBvUGFyYW1bImh0dHBlbmNvZGluZyJdOw0KICAgICAgICB2YXIgaXNFeGlzdFBhdGggPSBmYWxzZTsNCiAgICAgICAgdmFyIGRhdGEgPSBvUGFyYW1bImRhdGEiXTsNCiAgICAgICAgdmFyIGNvbm5lY3RuYW1lID0gb1BhcmFtWyJjb25uZWN0bmFtZSJdOw0KICAgICAgICB2YXIgY29ubmVjdGlvbm9uY2UgPSBvUGFyYW1bImNvbm5lY3Rpb25vbmNlIl07DQogICAgICAgIHZhciBkYXRhdHlwZSA9IG9QYXJhbVsiZGF0YXR5cGUiXTsNCiAgICAgICAgdmFyIGRhdGFpbmRleCA9IG9QYXJhbVsiZGF0YWluZGV4Il07DQogICAgICAgIHZhciBlbmNvZGluZyA9IG9QYXJhbVsiZW5jb2RpbmciXTsNCiAgICAgICAgdmFyIHhwYXRoID0gb1BhcmFtWyJ4cGF0aCJdOw0KICAgICAgICB2YXIgZXJyb3J4cGF0aCA9IG9QYXJhbVsiZXJyb3J4cGF0aCJdOw0KICAgICAgICB2YXIgY29va2llID0gb1BhcmFtWyJjb29raWUiXTsNCiAgICAgICAgdmFyIHByZXNlcnZld2hpdGVzcGFjZSA9IG9QYXJhbVsicHJlc2VydmV3aGl0ZXNwYWNlIl07DQoNCiAgICAgICAgLy8gYWRkIGxvZw0KICAgICAgICB2YXIgcnB0bmFtZSA9IG9QYXJhbVsicnB0bmFtZSJdOw0KICAgICAgICBpZiAodHlwZSA9PSB1bmRlZmluZWQgfHwgdHlwZSA9PSAiIikNCiAgICAgICAgICAgIHR5cGUgPSAiaHR0cCI7DQogICAgICAgIGlmIChuYW1lc3BhY2UgPT0gdW5kZWZpbmVkIHx8IG5hbWVzcGFjZSA9PSAiIikNCiAgICAgICAgICAgIG5hbWVzcGFjZSA9ICIqIjsNCiAgICAgICAgaWYgKGh0dHBtZXRob2QgPT0gdW5kZWZpbmVkIHx8IGh0dHBtZXRob2QgPT0gIiIpDQogICAgICAgICAgICBodHRwbWV0aG9kID0gInBvc3QiOw0KICAgICAgICBpZiAoaHR0cGVuY29kaW5nID09IHVuZGVmaW5lZCB8fCBodHRwZW5jb2RpbmcgPT0gIiIpDQogICAgICAgICAgICBodHRwZW5jb2RpbmcgPSAidXRmLTgudXJsZW5jb2RlIjsNCiAgICAgICAgaWYgKHByZXNlcnZld2hpdGVzcGFjZSA9PSB1bmRlZmluZWQgfHwgcHJlc2VydmV3aGl0ZXNwYWNlID09ICIiKQ0KICAgICAgICAgICAgcHJlc2VydmV3aGl0ZXNwYWNlID0gIjEiOw0KICAgICAgICBpZiAocGF0aCA9PSB1bmRlZmluZWQgfHwgcGF0aCA9PSAiIikgew0KICAgICAgICAgICAgaXNFeGlzdFBhdGggPSBmYWxzZTsNCiAgICAgICAgICAgIGlmIChyZXhfZ3NTZXJ2ZXJWZXJzaW9uID09ICIyLjUiKSB7DQogICAgICAgICAgICAgICAgcGF0aCA9IHJleF9nc1JwdFNlcnZpY2VVUkxfUmV4U2VydmVyMjU7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHBhdGggPSByZXhfZ3NScHRTZXJ2aWNlVVJMOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaXNFeGlzdFBhdGggPSB0cnVlOw0KICAgICAgICB9DQogICAgICAgIGlmIChkYXRhID09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgZGF0YSA9ICIiOw0KICAgICAgICB9DQogICAgICAgIGlmIChjb25uZWN0bmFtZSA9PSB1bmRlZmluZWQgfHwgY29ubmVjdG5hbWUgPT0gIiIpIHsNCiAgICAgICAgICAgIGlmIChyZXhfZ3NTZXJ2ZXJWZXJzaW9uID09ICIyLjUiKSB7DQogICAgICAgICAgICAgICAgY29ubmVjdG5hbWUgPSAiIjsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgY29ubmVjdG5hbWUgPSByZXhfZ3NVc2VyU2VydmljZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZiAoZGF0YXR5cGUgPT0gdW5kZWZpbmVkIHx8IGRhdGF0eXBlID09ICIiKQ0KICAgICAgICAgICAgZGF0YXR5cGUgPSAiQ1NWIjsNCiAgICAgICAgaWYgKGVuY29kaW5nID09IHVuZGVmaW5lZCB8fCBlbmNvZGluZyA9PSAiIikgew0KICAgICAgICAgICAgaWYgKHJleF9nc1NlcnZlclZlcnNpb24gPT0gIjIuNSIpIHsNCiAgICAgICAgICAgICAgICBlbmNvZGluZyA9IHJleF9nc0NzdkVuY29kaW5nX1JleFNlcnZlcjI1Ow0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBlbmNvZGluZyA9IHJleF9nc0NzdkVuY29kaW5nOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmICh4cGF0aCA9PSB1bmRlZmluZWQgfHwgeHBhdGggPT0gIiIpIHsNCiAgICAgICAgICAgIGlmIChyZXhfZ3NTZXJ2ZXJWZXJzaW9uID09ICIyLjUiKSB7DQogICAgICAgICAgICAgICAgLy8geHBhdGggPSByZXhfZ3NYUGF0aF9SZXhTZXJ2ZXIyNTsNCiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PSAiaHR0cCIpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0V4aXN0UGF0aCkNCiAgICAgICAgICAgICAgICAgICAgICAgIHhwYXRoID0gcmV4X2dzWFBhdGhfUmV4U2VydmVyMjU7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgeHBhdGggPSAieyVkYXRhc2V0LnhtbC5yb290JX0iOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgaWYgKHR5cGUgPT0gImh0dHAiKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICghaXNFeGlzdFBhdGgpDQogICAgICAgICAgICAgICAgICAgICAgICB4cGF0aCA9IHJleF9nc1hQYXRoOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHhwYXRoID0gInslZGF0YXNldC54bWwucm9vdCV9IjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgc2IgKz0gIjxjb25uZWN0aW9uIHR5cGU9JyIgKyB0eXBlICsgIicgbmFtZXNwYWNlPSciICsgbmFtZXNwYWNlICsgIic|IjsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHNiICs9ICI8ZmllbGQtbGlzdD4iOw0KICAgICAgICB9DQogICAgICAgIGZvciAoIHZhciBrZXkgaW4gcGFyYW0pIHsNCiAgICAgICAgICAgIHZhciBrZXlWYWx1ZSA9ICIiOw0KICAgICAgICAgICAgaWYgKHBhcmFtW2tleV0udmFsdWUgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAga2V5VmFsdWUgPSBwYXJhbVtrZXldLnZhbHVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKHBhcmFtW2tleV0uaXNudWxsICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgIHNiICs9ICI8ZmllbGQgbmFtZT0nIiArIGtleSArICInIGlzbnVsbD0nMSc|IjsNCiAgICAgICAgaWYgKHJleF9nc1Nob3dwYXJhbWV0ZXJkaWFsb2cgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBpZiAocmV4X2dzU2hvd3BhcmFtZXRlcmRpYWxvZyA9PSAiMSIpIHsNCiAgICAgICAgICAgICAgICBzYiArPSAiPGNvbmZpZy1wYXJhbSBuYW1lPSdzaG93cGFyYW1ldGVyZGlhbG9nJz4xPC9jb25maWctcGFyYW0|IDcpIHsNCiAgICAgICAgICAgIGlmIChycHRuYW1lLnN1YnN0cmluZygwLCA3KSAhPSAiaHR0cDovLyIgJiYgcnB0bmFtZS5zdWJzdHJpbmcoMCwgOCkgIT0gImh0dHBzOi8vIikgew0KICAgICAgICAgICAgICAgIHJwdG5hbWUgPSByZXhfZ3NSZXBvcnRVUkwgKyBycHRuYW1lICsgIi5yZWIiOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcnB0bmFtZSA9IHJleF9nc1JlcG9ydFVSTCArIHJwdG5hbWUgKyAiLnJlYiI7DQogICAgICAgIH0NCiAgICAgICAgc2IgKz0gIjxmaWxlIHR5cGU9J3JlYicgcGF0aD0nIiArIHJwdG5hbWUgKyAiJz4iOw0KICAgICAgICAvLyAyMDEzLTAyLTI4DQogICAgICAgIHNiICs9ICI8Y29uZmlnLXBhcmFtLWxpc3Q|IjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHNiICs9ICI8L2JhY2tncm91bmQtbGlzdD4iOw0KICAgICAgICB9DQogICAgICAgIHNiICs9ICI8L2RvY3VtZW50PiI7DQogICAgICAgIHNiICs9ICI8L29vZj4iOw0KICAgICAgICByZXR1cm4gc2I7DQogICAgfTsNCn0gLy8gZW5kIG9mIHJleF9mblBhcmFtU2V0DQoNCg0KDQpmdW5jdGlvbiByZXhfUmViRmlsZSgpIHsNCiAgICB0aGlzLmlkID0gYXJndW1lbnRzWzBdOw0KICAgIHRoaXMuc3VicmVwb3J0cyA9IHt9Ow0KICAgIHRoaXMucGFyYW1zID0ge307DQogICAgdGhpcy5odHRwcGFyYW1zID0ge307DQogICAgdGhpcy5jb25maWdwYXJhbXMgPSB7fTsNCiAgICByZXhfUmViRmlsZS5wcm90b3R5cGUuc3ViID0gZnVuY3Rpb24oaWQpIHsNCiAgICAgICAgaWYgKHRoaXMuc3VicmVwb3J0c1tpZF0gPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICB0aGlzLnN1YnJlcG9ydHNbaWRdID0gbmV3IHJleF9SZWJTdWJSZXBvcnQoaWQpOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiB0aGlzLnN1YnJlcG9ydHNbaWRdOw0KICAgIH07DQogICAgcmV4X1JlYkZpbGUucHJvdG90eXBlLmNvbiA9IGZ1bmN0aW9uKGlkKSB7DQogICAgICAgIGlmICh0aGlzLnN1YnJlcG9ydHNbaWRdID09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgdGhpcy5zdWJyZXBvcnRzW2lkXSA9IG5ldyByZXhfUmViU3ViUmVwb3J0KGlkKTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gdGhpcy5zdWJyZXBvcnRzW2lkXTsNCiAgICB9Ow0KICAgIHJleF9SZWJGaWxlLnByb3RvdHlwZS5wYXJhbSA9IGZ1bmN0aW9uKGlkKSB7DQogICAgICAgIGlmICh0aGlzLnBhcmFtc1tpZF0gPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICB0aGlzLnBhcmFtc1tpZF0gPSB7fTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gdGhpcy5wYXJhbXNbaWRdOw0KICAgIH07DQogICAgcmV4X1JlYkZpbGUucHJvdG90eXBlLmh0dHBwYXJhbSA9IGZ1bmN0aW9uKGlkKSB7DQogICAgICAgIGlmICh0aGlzLmh0dHBwYXJhbXNbaWRdID09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgdGhpcy5odHRwcGFyYW1zW2lkXSA9IHt9Ow0KICAgICAgICB9DQogICAgICAgIHJldHVybiB0aGlzLmh0dHBwYXJhbXNbaWRdOw0KICAgIH07DQogICAgcmV4X1JlYkZpbGUucHJvdG90eXBlLmNvbmZpZ3BhcmFtID0gZnVuY3Rpb24oaWQpIHsNCiAgICAgICAgaWYgKHRoaXMuY29uZmlncGFyYW1zW2lkXSA9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIHRoaXMuY29uZmlncGFyYW1zW2lkXSA9IHt9Ow0KICAgICAgICB9DQogICAgICAgIHJldHVybiB0aGlzLmNvbmZpZ3BhcmFtc1tpZF07DQogICAgfTsNCiAgICByZXhfUmViRmlsZS5wcm90b3R5cGUudG9TdHJpbmdGaWxlID0gZnVuY3Rpb24ocnB0bmFtZSwgcGFyYW0sIGNvbm5lY3QsIGNvbmZpZ3BhcmFtLCBjb29raWUpIHsNCiAgICAgICAgdmFyIHNiID0gIiI7DQogICAgICAgIGlmIChycHRuYW1lLmxlbmd0aCA|IjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAvLyDquLDsobTsl5Ag7J6I642YIOy9lOuTnC4NCiAgICAgICAgaWYgKGNvb2tpZSAhPSAiIiAmJiBjb29raWUgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBzYiArPSAiPGNvbmZpZy1wYXJhbSBuYW1lPSdjb29raWUnPjwhW0NEQVRBWyIgKyBjb29raWUgKyAiXV0|IiArIHRoaXMuYmFja2dyb3VuZGxpc3RbaV0ucGF0aCArICI8L2JhY2tncm91bmQ|IjsNCiAgICAgICAgcmV0dXJuIHNiOw0KICAgIH07DQogICAgcmV4X1JlYkZpbGUucHJvdG90eXBlLnRvU3RyaW5nRmllbGQgPSBmdW5jdGlvbihwYXJhbSwgcGFyYW10eXBlKSB7DQogICAgICAgIHZhciBzYiA9ICIiOw0KICAgICAgICBpZiAocGFyYW10eXBlID09ICJpbmRleCIpIHsNCiAgICAgICAgICAgIHNiICs9ICI8ZmllbGQtbGlzdCBuYW1lYmluZD0nMCc|IjsNCiAgICAgICAgfQ0KICAgICAgICBzYiArPSAiPC9jb25maWctcGFyYW0tbGlzdD4iOw0KICAgICAgICBzYiArPSBwYXJhbTsNCiAgICAgICAgc2IgKz0gY29ubmVjdDsNCiAgICAgICAgc2IgKz0gY29uZmlncGFyYW07DQogICAgICAgIHNiICs9ICI8L2ZpbGU|IiArIGNvbm5lY3RuYW1lICsgIjwvaHR0cC1wYXJhbT4iOw0KICAgICAgICAgICAgICAgICAgICBzSHR0cFBhcmFtcyArPSAiPGh0dHAtcGFyYW0gbmFtZT0nSUQnPlNEIiArIGRhdGF0eXBlLnRvVXBwZXJDYXNlKCkgKyAiPC9odHRwLXBhcmFtPiI7DQogICAgICAgICAgICAgICAgICAgIC8vIGFkZCBsb2cNCiAgICAgICAgICAgICAgICAgICAgc0h0dHBQYXJhbXMgKz0gIjxodHRwLXBhcmFtIG5hbWU9J1JFQk5NJz4iICsgKChyZXhfdmlld2VyVmVyc2lvbigpLnNwbGl0KCIsIilbM10gPCAzNDApID8gKHJwdG5hbWUuaW5kZXhPZigiaHR0cDovLyIpID09IDAgPyBycHRuYW1lIDogKHJleF9nc1JlcG9ydFVSTCArIHJwdG5hbWUgKyAiLnJlYiIpKSA6ICJ7JWZpbGUubmFtZSV9IikgKyAiPC9odHRwLXBhcmFtPiI7DQogICAgICAgICAgICAgICAgICAgIGlmIChyZXhfZ3NQbHVnaW5UeXBlV2ViICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJleF9nc1BsdWdpblR5cGVXZWIgPT0gImNyeXB0by5jbGlwc29mdCIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzSHR0cFBhcmFtcyArPSAiPGh0dHAtcGFyYW0gbmFtZT0ncFNlc3Npb25LZXknPmludGVybmFsPC9odHRwLXBhcmFtPiI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBub3QgdXNlZCEhDQogICAgICAgICAgICAgICAgICAgICAgICBzSHR0cFBhcmFtcyArPSAiPGh0dHAtcGFyYW0gbmFtZT0nUEUnPlRSVUU8L2h0dHAtcGFyYW0|IjsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAvLyAyMDExLTA2LTEwDQogICAgICAgICAgICAgICAgICAgIHZhciBzSHR0cFBhcmFtc0FkZCA9IHNIdHRwUGFyYW1zOw0KICAgICAgICAgICAgICAgICAgICBzSHR0cFBhcmFtcyA9ICIiOw0KICAgICAgICAgICAgICAgICAgICBzSHR0cFBhcmFtcyArPSAiPGh0dHAtcGFyYW0tbGlzdD4iOw0KICAgICAgICAgICAgICAgICAgICBzSHR0cFBhcmFtcyArPSBzSHR0cFBhcmFtc0FkZDsNCiAgICAgICAgICAgICAgICAgICAgc0h0dHBQYXJhbXMgKz0gIjxodHRwLXBhcmFtIG5hbWU9J1ExU1FMJz57JWF1dG8lfTwvaHR0cC1wYXJhbT4iOw0KDQogICAgICAgICAgICAgICAgICAgIGlmIChyZXhfZ3NVc2VQcmVwYXJlZFN0YXRlbWVudCA9PSAidHJ1ZSIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNIdHRwUGFyYW1zICs9ICI8aHR0cC1wYXJhbSBuYW1lPSd4bWxkYXRhJz57JWRhdGFzZXQuYWRvLnNxbC54bWwucHJlcGFyZWQlfTwvaHR0cC1wYXJhbT4iOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgc0h0dHBQYXJhbXMgKz0gIjxodHRwLXBhcmFtIG5hbWU9J09FJz5Ob25lPC9odHRwLXBhcmFtPiI7DQogICAgICAgICAgICAgICAgICAgIHNIdHRwUGFyYW1zICs9ICI8aHR0cC1wYXJhbSBuYW1lPSdDTic|IjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBzSHR0cFBhcmFtcyArPSAiPC9odHRwLXBhcmFtLWxpc3Q|IjsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5vdCB1c2VkISENCiAgICAgICAgICAgICAgICAgICAgICAgIHNIdHRwUGFyYW1zICs9ICI8aHR0cC1wYXJhbSBuYW1lPSdQRSc|IjsNCiAgICAgICAgICAgICAgICAgICAgc0h0dHBQYXJhbXMgKz0gIjxodHRwLXBhcmFtIG5hbWU9J09UJz5EYXRhT25seTwvaHR0cC1wYXJhbT4iOw0KICAgICAgICAgICAgICAgICAgICBzSHR0cFBhcmFtcyArPSAiPGh0dHAtcGFyYW0gbmFtZT0nUTFUeXBlJz5TUUw8L2h0dHAtcGFyYW0|IjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBzSHR0cFBhcmFtcyArPSAiPGh0dHAtcGFyYW0gbmFtZT0nUUMnPjE8L2h0dHAtcGFyYW0|RkFMU0U8L2h0dHAtcGFyYW0|aW50ZXJuYWw8L2h0dHAtcGFyYW0|IjsNCiAgICAgICAgICAgICAgICAgICAgc0h0dHBQYXJhbXMgKz0gIjxodHRwLXBhcmFtIG5hbWU9J3VzZXJzZXJ2aWNlJz4iICsgY29ubmVjdG5hbWUgKyAiPC9odHRwLXBhcmFtPiI7DQogICAgICAgICAgICAgICAgICAgIHNIdHRwUGFyYW1zICs9ICI8aHR0cC1wYXJhbSBuYW1lPSdpbWFnZSc|IjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgaWYgKHR5cGUgPT0gImh0dHAiKSB7DQogICAgICAgICAgICBpZiAoaXNFeGlzdFBhdGggPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICBpZiAocmV4X2dzU2VydmVyVmVyc2lvbiA9PSAiMi41Iikgew0KICAgICAgICAgICAgICAgICAgICAvLyAyMDExLTA2LTEwDQogICAgICAgICAgICAgICAgICAgIC8vIHNIdHRwUGFyYW1zICs9ICI8aHR0cC1wYXJhbS1saXN0PiI7DQogICAgICAgICAgICAgICAgICAgIHZhciBzSHR0cFBhcmFtc0FkZCA9IHNIdHRwUGFyYW1zOw0KICAgICAgICAgICAgICAgICAgICBzSHR0cFBhcmFtcyA9ICIiOw0KICAgICAgICAgICAgICAgICAgICBzSHR0cFBhcmFtcyArPSAiPGh0dHAtcGFyYW0tbGlzdD4iOw0KICAgICAgICAgICAgICAgICAgICBzSHR0cFBhcmFtcyArPSBzSHR0cFBhcmFtc0FkZDsNCiAgICAgICAgICAgICAgICAgICAgc0h0dHBQYXJhbXMgKz0gIjxodHRwLXBhcmFtIG5hbWU9J2Rlc2lnbnR5cGUnPnJ1bjwvaHR0cC1wYXJhbT4iOw0KICAgICAgICAgICAgICAgICAgICBzSHR0cFBhcmFtcyArPSAiPGh0dHAtcGFyYW0gbmFtZT0nZGF0YXR5cGUnPiIgKyBkYXRhdHlwZS50b1VwcGVyQ2FzZSgpICsgIjwvaHR0cC1wYXJhbT4iOw0KICAgICAgICAgICAgICAgICAgICBzSHR0cFBhcmFtcyArPSAiPGh0dHAtcGFyYW0gbmFtZT0nc3FsJz57JWF1dG8lfTwvaHR0cC1wYXJhbT4iOw0KDQogICAgICAgICAgICAgICAgICAgIGlmIChyZXhfZ3NVc2VQcmVwYXJlZFN0YXRlbWVudCA9PSAidHJ1ZSIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNIdHRwUGFyYW1zICs9ICI8aHR0cC1wYXJhbSBuYW1lPSd4bWxkYXRhJz57JWRhdGFzZXQuYWRvLnNxbC54bWwucHJlcGFyZWQlfTwvaHR0cC1wYXJhbT4iOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgc0h0dHBQYXJhbXMgKz0gIjxodHRwLXBhcmFtIG5hbWU9J3NwbGl0Jz48L2h0dHAtcGFyYW0|PC9odHRwLXBhcmFtPiI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBzSHR0cFBhcmFtcyArPSAiPGh0dHAtcGFyYW0gbmFtZT0nIiArIGtleSArICInPjwhW0NEQVRBWyIgKyBvSHR0cFBhcmFtc1trZXldLnZhbHVlICsgIl1dPjwvaHR0cC1wYXJhbT4iOw0KICAgICAgICAgICAgICAgICAgICAvLyBzSHR0cFBhcmFtcyArPSAiPGh0dHAtcGFyYW0gbmFtZT0nIiArIGtleSArICInPiIgKw0KICAgICAgICAgICAgICAgICAgICAvLyBvSHR0cFBhcmFtc1trZXldLnZhbHVlICsgIjwvaHR0cC1wYXJhbT4iOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICB2YXIgQWRkQ29uZmlnUGFyYW1zID0gIiI7DQogICAgICAgIGlmIChvQ29uZmlnUGFyYW1zICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgZm9yICggdmFyIGtleSBpbiBvQ29uZmlnUGFyYW1zKSB7DQogICAgICAgICAgICAgICAgaWYgKHR5cGVvZiAob0NvbmZpZ1BhcmFtc1trZXldLnZhbHVlKSA9PSAib2JqZWN0Iikgew0KICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9Db25maWdQYXJhbXNba2V5XS52YWx1ZS5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgQWRkQ29uZmlnUGFyYW1zICs9ICI8Y29uZmlnLXBhcmFtIG5hbWU9JyIgKyBrZXkgKyAiJz48IVtDREFUQVsiICsgb0NvbmZpZ1BhcmFtc1trZXldLnZhbHVlW2ldICsgIl1dPjwvY29uZmlnLXBhcmFtPiI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBBZGRDb25maWdQYXJhbXMgKz0gIjxjb25maWctcGFyYW0gbmFtZT0nIiArIGtleSArICInPjwhW0NEQVRBWyIgKyBvQ29uZmlnUGFyYW1zW2tleV0udmFsdWUgKyAiXV0|PC9odHRwLXBhcmFtPiI7DQogICAgICAgICAgICAgICAgICAgIHNIdHRwUGFyYW1zICs9ICI8aHR0cC1wYXJhbSBuYW1lPSdyZXhfcGFyYW1fc3FsJz48L2h0dHAtcGFyYW0|IjsNCiAgICAgICAgICAgICAgICAgICAgc0h0dHBQYXJhbXMgKz0gIjxodHRwLXBhcmFtIG5hbWU9J3Bvc3RzcWwnPnslZGF0YXNldC5hZG8ucG9zdC5zcWwlfTwvaHR0cC1wYXJhbT4iOw0KICAgICAgICAgICAgICAgICAgICBpZiAocmV4X2dzUGx1Z2luVHlwZVdlYiAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNIdHRwUGFyYW1zICs9ICI8aHR0cC1wYXJhbSBuYW1lPSdwU2Vzc2lvbktleSc|eyVkYXRhc2V0LmFkby5wcmUuc3FsJX08L2h0dHAtcGFyYW0|IjsNCiAgICAgICAgICAgICAgICAgICAgc0h0dHBQYXJhbXMgKz0gIjxodHRwLXBhcmFtIG5hbWU9J3ByZXNxbCc|PCFbQ0RBVEFbIiArIHRoaXMudXNlcmFnZW50ICsgIl1dPjwvY29uZmlnLXBhcmFtPiI7DQogICAgICAgIH0NCiAgICAgICAgaWYgKHRoaXMuY2xlYXJwYXJhbWV0ZXIgIT0gIiIgJiYgdGhpcy5jbGVhcnBhcmFtZXRlciAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIHNiICs9ICI8Y29uZmlnLXBhcmFtIG5hbWU9J2NsZWFycGFyYW1ldGVyJz48IVtDREFUQVsiICsgdGhpcy5jbGVhcnBhcmFtZXRlciArICJdXT48L2NvbmZpZy1wYXJhbT4iOw0KICAgICAgICB9DQogICAgICAgIHNiICs9ICI8L2NvbmZpZy1wYXJhbS1saXN0PiI7DQogICAgICAgIA0KICAgICAgICAvLyBmb3JlZ3JvdW5kIHNldHRpbmcNCiAgICAgICAgaWYgKHRoaXMuZm9yZWdyb3VuZGxpc3QubGVuZ3RoICE9IDApIHsNCiAgICAgICAgICAgIHNiICs9ICI8Zm9yZWdyb3VuZC1saXN0PiI7DQogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZm9yZWdyb3VuZGxpc3QubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICBzYiArPSAiPGZvcmVncm91bmQgdHlwZT1cIiIgKyB0aGlzLmZvcmVncm91bmRsaXN0W2ldLnR5cGUgKyAiXCIgb3JpZW50YXRpb249XCIiICsgdGhpcy5mb3JlZ3JvdW5kbGlzdFtpXS5vcmllbnRhdGlvbiArICJcIj4iICsgdGhpcy5mb3JlZ3JvdW5kbGlzdFtpXS5wYXRoICsgIjwvZm9yZWdyb3VuZD4iOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgc2IgKz0gIjwvZm9yZWdyb3VuZC1saXN0PiI7DQogICAgICAgIH0NCiAgICAgICAgLy8gYmFja2dyb3VuZCBzZXR0aW5nDQogICAgICAgIGlmICh0aGlzLmJhY2tncm91bmRsaXN0Lmxlbmd0aCAhPSAwKSB7DQogICAgICAgICAgICBzYiArPSAiPGJhY2tncm91bmQtbGlzdD4iOw0KICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmJhY2tncm91bmRsaXN0Lmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgc2IgKz0gIjxiYWNrZ3JvdW5kIHR5cGU9XCIiICsgdGhpcy5iYWNrZ3JvdW5kbGlzdFtpXS50eXBlICsgIlwiIG9yaWVudGF0aW9uPVwiIiArIHRoaXMuYmFja2dyb3VuZGxpc3RbaV0ub3JpZW50YXRpb24gKyAiXCI|IiArICJcclxuIjsNCiAgICAgICAgICAgIHNDdGwgKz0gIjxzY3JpcHQgdHlwZT0ndGV4dC9qYXZhc2NyaXB0JyBmb3I9J1JleEN0bCcgZXZlbnQ9J0NhbmNlbEV4cG9ydCc|IiArICJcclxuIjsNCiAgICAgICAgICAgIHNDdGwgKz0gIiAgIGlmKHR5cGVvZiB3aW5kb3cuT25SZXhwZXJ0RXJyb3IgIT0gJ3VuZGVmaW5lZCcpIE9uUmV4cGVydEVycm9yKG5hbWUsIGRlc2NyaXB0aW9uKTsiICsgIlxyXG4iOw0KICAgICAgICAgICAgc0N0bCArPSAiPC9zY3JpcHQ||IjsNCiAgICAgICAgICAgIHNDdGwgKz0gIiAgIGlmKHR5cGVvZiB3aW5kb3cuT25DYW5jZWxQcmludCAhPSAndW5kZWZpbmVkJykgT25DYW5jZWxQcmludCgpIiArICJcclxuIjsNCiAgICAgICAgICAgIHNDdGwgKz0gIjwvc2NyaXB0PiI7DQogICAgICAgICAgICBzQ3RsICs9ICI8c2NyaXB0IHR5cGU9J3RleHQvamF2YXNjcmlwdCcgZm9yPSdSZXhDdGwnIGV2ZW50PSdCdXR0b25DbG9zZVdpbmRvd0NsaWNrQWZ0ZXInPiIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICIgICBpZih0eXBlb2Ygd2luZG93Lk9uQnV0dG9uQ2xvc2VXaW5kb3dDbGlja0FmdGVyICE9ICd1bmRlZmluZWQnKSBPbkJ1dHRvbkNsb3NlV2luZG93Q2xpY2tBZnRlcigpOyIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICI8L3NjcmlwdD4iICsgIlxyXG4iOw0KICAgICAgICAgICAgc0N0bCArPSAiPHNjcmlwdCB0eXBlPSd0ZXh0L2phdmFzY3JpcHQnIGZvcj0nUmV4Q3RsJyBldmVudD0nUHJpbnRQYWdlKHRvdGFscGFnZSwgcGFnZSknPiIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICIgICBpZih0eXBlb2Ygd2luZG93Lk9uUHJpbnRQYWdlICE9ICd1bmRlZmluZWQnKSBPblByaW50UGFnZSh0b3RhbHBhZ2UsIHBhZ2UpOyIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICI8L3NjcmlwdD4iICsgIlxyXG4iOw0KICAgICAgICAgICAgc0N0bCArPSAiPHNjcmlwdCB0eXBlPSd0ZXh0L2phdmFzY3JpcHQnIGZvcj0nUmV4Q3RsJyBldmVudD0nUmV4cGVydEVycm9yKG5hbWUsIGRlc2NyaXB0aW9uKSc|IiArICJcclxuIjsNCiAgICAgICAgICAgIHNDdGwgKz0gIiAgIGlmKHR5cGVvZiB3aW5kb3cuT25DYW5jZWxFeHBvcnQgIT0gJ3VuZGVmaW5lZCcpIE9uQ2FuY2VsRXhwb3J0KCk7IiArICJcclxuIjsNCiAgICAgICAgICAgIHNDdGwgKz0gIjwvc2NyaXB0PiIgKyAiXHJcbiI7DQogICAgICAgICAgICAvLyB2aWV3ZXIgMjIxIHZlcnNpb24gbW9yZQ0KICAgICAgICAgICAgc0N0bCArPSAiPHNjcmlwdCB0eXBlPSd0ZXh0L2phdmFzY3JpcHQnIGZvcj0nUmV4Q3RsJyBldmVudD0nRXJyb3JFdmVudChlcnJvclhNTCknPiIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICIgICBpZih0eXBlb2Ygd2luZG93Lk9uRXJyb3JFdmVudCAhPSAndW5kZWZpbmVkJykgT25FcnJvckV2ZW50KGVycm9yWE1MKTsiICsgIlxyXG4iOw0KICAgICAgICAgICAgc0N0bCArPSAiPC9zY3JpcHQ|IiArICJcclxuIjsNCiAgICAgICAgICAgIC8vIDIwMTQtMDgtMjUgYWRkDQogICAgICAgICAgICBzQ3RsICs9ICI8c2NyaXB0IHR5cGU9J3RleHQvamF2YXNjcmlwdCcgZm9yPSdSZXhDdGwnIGV2ZW50PSdDaGVja0Vycm9yKFJlc3VsdCknPiIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICIgICBpZih0eXBlb2Ygd2luZG93Lk9uQ2hlY2tFcnJvciAhPSAndW5kZWZpbmVkJykgT25DaGVja0Vycm9yKFJlc3VsdCk7IiArICJcclxuIjsNCiAgICAgICAgICAgIHNDdGwgKz0gIjwvc2NyaXB0PiIgKyAiXHJcbiI7DQoNCiAgICAgICAgICAgIC8vIDIwMTQtMTEtMDMgdmJzY3JpcHQgdG8gamF2YXNjcmlwdA0KICAgICAgICAgICAgc0N0bCArPSAiPHNjcmlwdCB0eXBlPSd0ZXh0L2phdmFzY3JpcHQnIGZvcj0nUmV4Q3RsJyBldmVudD0nQnV0dG9uQ2xvc2VXaW5kb3dDbGlja0JlZm9yZShDYW5jZWwpJz4iOw0KICAgICAgICAgICAgc0N0bCArPSAiICAgaWYodHlwZW9mIHdpbmRvdy5PbkJ1dHRvbkNsb3NlV2luZG93Q2xpY2tCZWZvcmUgIT0gJ3VuZGVmaW5lZCcpIE9uQnV0dG9uQ2xvc2VXaW5kb3dDbGlja0JlZm9yZShDYW5jZWwpOyIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICI8L3NjcmlwdD4iOw0KICAgICAgICAgICAgc0N0bCArPSAiPHNjcmlwdCB0eXBlPSd0ZXh0L2phdmFzY3JpcHQnIGZvcj0nUmV4Q3RsJyBldmVudD0nQnV0dG9uRXhwb3J0SFdQQ2xpY2tCZWZvcmUoQ2FuY2VsKSc|IiArICJcclxuIjsNCiAgICAgICAgICAgIHNDdGwgKz0gIiAgIGlmKHR5cGVvZiB3aW5kb3cuT25CZWZvcmVQcmludCAhPSAndW5kZWZpbmVkJykgT25CZWZvcmVQcmludChQcmludE5hbWUsIEZyb21QYWdlLCBUb1BhZ2UsIENvcGllcywgQ2FuY2VsKTsiICsgIlxyXG4iOw0KICAgICAgICAgICAgc0N0bCArPSAiPC9zY3JpcHQ|IiArICJcclxuIjsNCiAgICAgICAgICAgIC8vIDIwMTMtMTEtMjUgYWRkDQogICAgICAgICAgICBzQ3RsICs9ICI8c2NyaXB0IHR5cGU9J3RleHQvamF2YXNjcmlwdCcgZm9yPSdSZXhDdGwnIGV2ZW50PSdCZWZvcmVQcmludChQcmludE5hbWUsIEZyb21QYWdlLCBUb1BhZ2UsIENvcGllcywgQ2FuY2VsKSc|IiArICJcclxuIjsNCiAgICAgICAgICAgIHNDdGwgKz0gIjxzY3JpcHQgdHlwZT0ndGV4dC9qYXZhc2NyaXB0JyBmb3I9J1JleEN0bCcgZXZlbnQ9J0J1dHRvbkV4cG9ydFBERkNsaWNrQWZ0ZXInPiIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICIgICBpZih0eXBlb2Ygd2luZG93Lk9uQnV0dG9uRXhwb3J0UERGQ2xpY2tBZnRlciAhPSAndW5kZWZpbmVkJykgT25CdXR0b25FeHBvcnRQREZDbGlja0FmdGVyKCk7IiArICJcclxuIjsNCiAgICAgICAgICAgIHNDdGwgKz0gIjwvc2NyaXB0PiIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICI8c2NyaXB0IHR5cGU9J3RleHQvamF2YXNjcmlwdCcgZm9yPSdSZXhDdGwnIGV2ZW50PSdCdXR0b25FeHBvcnRIV1BDbGlja0FmdGVyJz4iICsgIlxyXG4iOw0KICAgICAgICAgICAgc0N0bCArPSAiICAgaWYodHlwZW9mIHdpbmRvdy5PbkJ1dHRvbkV4cG9ydEhXUENsaWNrQWZ0ZXIgIT0gJ3VuZGVmaW5lZCcpIE9uQnV0dG9uRXhwb3J0SFdQQ2xpY2tBZnRlcigpOyIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICI8L3NjcmlwdD4iICsgIlxyXG4iOw0KICAgICAgICAgICAgc0N0bCArPSAiPHNjcmlwdCB0eXBlPSd0ZXh0L2phdmFzY3JpcHQnIGZvcj0nUmV4Q3RsJyBldmVudD0nQ2FuY2VsUHJpbnQoKSc|IiArICJcclxuIjsNCiAgICAgICAgICAgIHNDdGwgKz0gIjxzY3JpcHQgdHlwZT0ndGV4dC9qYXZhc2NyaXB0JyBmb3I9J1JleEN0bCcgZXZlbnQ9J0J1dHRvbkV4cG9ydENsaWNrQWZ0ZXInPiIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICIgICBpZih0eXBlb2Ygd2luZG93Lk9uQnV0dG9uRXhwb3J0Q2xpY2tBZnRlciAhPSAndW5kZWZpbmVkJykgT25CdXR0b25FeHBvcnRDbGlja0FmdGVyKCk7IiArICJcclxuIjsNCiAgICAgICAgICAgIHNDdGwgKz0gIjwvc2NyaXB0PiIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICI8c2NyaXB0IHR5cGU9J3RleHQvamF2YXNjcmlwdCcgZm9yPSdSZXhDdGwnIGV2ZW50PSdCdXR0b25SZWZyZXNoQ2xpY2tBZnRlcic|IiArICJcclxuIjsNCiAgICAgICAgICAgIHNDdGwgKz0gIiAgIGlmKHR5cGVvZiB3aW5kb3cuT25GaW5pc2hQcmludCAhPSAndW5kZWZpbmVkJykgT25GaW5pc2hQcmludCgpOyIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICI8L3NjcmlwdD4iICsgIlxyXG4iOw0KICAgICAgICAgICAgLy8gMjAxNC0wMy0xOQ0KICAgICAgICAgICAgc0N0bCArPSAiPHNjcmlwdCB0eXBlPSd0ZXh0L2phdmFzY3JpcHQnIGZvcj0nUmV4Q3RsJyBldmVudD0nRmluaXNoVXBsb2FkKFN1Y2Nlc3MsIEZpbGVQYXRoLCBSZXN1bHQpJz4iICsgIlxyXG4iOw0KICAgICAgICAgICAgc0N0bCArPSAiICAgaWYodHlwZW9mIHdpbmRvdy5PbkZpbmlzaFVwbG9hZCAhPSAndW5kZWZpbmVkJykgT25GaW5pc2hVcGxvYWQoU3VjY2VzcywgRmlsZVBhdGgsIFJlc3VsdCk7IiArICJcclxuIjsNCiAgICAgICAgICAgIHNDdGwgKz0gIjwvc2NyaXB0PiIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICI8c2NyaXB0IHR5cGU9J3RleHQvamF2YXNjcmlwdCcgZm9yPSdSZXhDdGwnIGV2ZW50PSdGaW5pc2hFeHBvcnQoRmlsZU5hbWUpJz4iICsgIlxyXG4iOw0KICAgICAgICAgICAgc0N0bCArPSAiICAgaWYodHlwZW9mIHdpbmRvdy5PbkZpbmlzaEV4cG9ydCAhPSAndW5kZWZpbmVkJykgT25GaW5pc2hFeHBvcnQoRmlsZU5hbWUpOyIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICI8L3NjcmlwdD4iICsgIlxyXG4iOw0KICAgICAgICAgICAgc0N0bCArPSAiPHNjcmlwdCB0eXBlPSd0ZXh0L2phdmFzY3JpcHQnIGZvcj0nUmV4Q3RsJyBldmVudD0nSHlwZXJMaW5rQ2xpY2tlZChQYXRoLCBDYW5jZWwpJz4iICsgIlxyXG4iOw0KICAgICAgICAgICAgc0N0bCArPSAiICAgaWYodHlwZW9mIHdpbmRvdy5Pbkh5cGVyTGlua0NsaWNrZWQgIT0gJ3VuZGVmaW5lZCcpIE9uSHlwZXJMaW5rQ2xpY2tlZChQYXRoLCBDYW5jZWwpOyIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICI8L3NjcmlwdD4iICsgIlxyXG4iOw0KICAgICAgICAgICAgc0N0bCArPSAiPHNjcmlwdCB0eXBlPSd0ZXh0L2phdmFzY3JpcHQnIGZvcj0nUmV4Q3RsJyBldmVudD0nRmluaXNoUHJpbnRSZXN1bHQoUmVzdWx0Q29kZSknPiIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICIgICBpZih0eXBlb2Ygd2luZG93Lk9uRmluaXNoUHJpbnRSZXN1bHQgIT0gJ3VuZGVmaW5lZCcpIE9uRmluaXNoUHJpbnRSZXN1bHQoUmVzdWx0Q29kZSk7IiArICJcclxuIjsNCiAgICAgICAgICAgIHNDdGwgKz0gIjwvc2NyaXB0PiIgKyAiXHJcbiI7DQogICAgICAgICAgICAvLyB2aWV3ZXIgMTgxIHZlcnNpb24gbW9yZQ0KICAgICAgICAgICAgc0N0bCArPSAiPHNjcmlwdCB0eXBlPSd0ZXh0L2phdmFzY3JpcHQnIGZvcj0nUmV4Q3RsJyBldmVudD0nQnV0dG9uUHJpbnRDbGlja0FmdGVyJz4iICsgIlxyXG4iOw0KICAgICAgICAgICAgc0N0bCArPSAiICAgaWYodHlwZW9mIHdpbmRvdy5PbkJ1dHRvblByaW50Q2xpY2tBZnRlciAhPSAndW5kZWZpbmVkJykgT25CdXR0b25QcmludENsaWNrQWZ0ZXIoKTsiICsgIlxyXG4iOw0KICAgICAgICAgICAgc0N0bCArPSAiPC9zY3JpcHQ|dmVyc2lvbj0iICsgcmV4X3ZpZXdlclZlcnNpb24oKSArICImdmlld2VyPTQnIHdpZHRoPScxMDAlJyBoZWlnaHQ9JzEwMCUnIGZyYW1lYm9yZGVyPScwJz48L2lmcmFtZT4iOw0KICAgICAgICAgICAgICAgIHNDdGwgKz0gIjwvb2JqZWN0PiI7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHZhciBwbHVnaW5taW1lID0gImFwcGxpY2F0aW9uL2NsaXByZXBvcnQ0MC5wbHVnaW4sdmVyc2lvbj0iICsgcmV4X3ZpZXdlclZlcnNpb24oKTsNCiAgICAgICAgICAgICAgICB2YXIgYVZlciA9IHJleF92aWV3ZXJWZXJzaW9uKCkuc3BsaXQoIiwiKTsNCiAgICAgICAgICAgICAgICB2YXIgaVZlciA9IHBhcnNlSW50KGFWZXJbMF0pICogMTAwMDAgKyBwYXJzZUludChhVmVyWzFdKSAqIDEwMDAgKyBwYXJzZUludChhVmVyWzJdKSAqIDEwMDAgKyBwYXJzZUludChhVmVyWzNdKSAqIDE7DQogICAgICAgICAgICAgICAgdmFyIHR5cGVBcnIgPSAiIjsNCiAgICAgICAgICAgICAgICB2YXIgYVZlckV4aXN0QXJyID0gIiI7DQogICAgICAgICAgICAgICAgdmFyIGFWZXJFeGlzdCA9ICIiOw0KICAgICAgICAgICAgICAgIHZhciB2aWV3ZXJFeGlzdFlOID0gIk4iOw0KICAgICAgICAgICAgICAgIGlmIChpVmVyIDwgMTAxMzYpIHsNCiAgICAgICAgICAgICAgICAgICAgcGx1Z2lubWltZSA9ICJhcHBsaWNhdGlvbi9jbGlwcmVwb3J0NDAucGx1Z2luLHZlcnNpb249MS4wLjAuMCI7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChvQWdlbnQuaXNDUiB8fCBvQWdlbnQuaXNPUCB8fCBvQWdlbnQuaXNTRiB8fCBvQWdlbnQuaXNGRikgew0KICAgICAgICAgICAgICAgICAgICAvLyB2YXIgbWltZXR5cGUgPSBuYXZpZ2F0b3IubWltZVR5cGVzW3BsdWdpbm1pbWVdOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5hdmlnYXRvci5taW1lVHlwZXMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0eXBlID0gbmF2aWdhdG9yLm1pbWVUeXBlc1tpXS50eXBlOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUuaW5kZXhPZigiYXBwbGljYXRpb24vY2xpcHJlcG9ydDQwLnBsdWdpbiIpICE9IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld2VyRXhpc3RZTiA9ICJZIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlQXJyID0gdHlwZS5zcGxpdCgiPSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFWZXJFeGlzdEFyciA9IHR5cGVBcnJbMV0uc3BsaXQoIiwiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVmVyRXhpc3QgPSBhVmVyRXhpc3RBcnJbM107DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXdlckV4aXN0WU4gPT0gIk4iIHx8IChwYXJzZUludChhVmVyRXhpc3QpIDwgcGFyc2VJbnQoYVZlclszXSkpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKHJleF9nc1NldHVwVVJMICsgIj92ZXJzaW9uPSIgKyByZXhfdmlld2VyVmVyc2lvbigpICsgIiZ2aWV3ZXI9NCIpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIC8vIHNDdGwgKz0gIjxvYmplY3QgaWQ9JyIgKyBzSUQgKyAiJyB0eXBlPSciICsgcGx1Z2lubWltZSArICInDQogICAgICAgICAgICAgICAgLy8gIjsNCiAgICAgICAgICAgICAgICBzQ3RsICs9ICI8b2JqZWN0IGlkPSciICsgc0lEICsgIicgIjsNCiAgICAgICAgICAgICAgICBpZiAodmlld2VyRXhpc3RZTiA9PSAiWSIpIHsNCiAgICAgICAgICAgICAgICAgICAgc0N0bCArPSAidHlwZT0nIiArICJhcHBsaWNhdGlvbi9jbGlwcmVwb3J0NDAucGx1Z2luLHZlcnNpb249MSwwLDAsIiArIGFWZXJFeGlzdCArICInICI7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgc0N0bCArPSAidHlwZT0nIiArIHBsdWdpbm1pbWUgKyAiJyAiOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBzQ3RsICs9ICIgY29kZWJhc2U9JyIgKyByZXhfZ3NEb3dubG9hZFVSTCArICJDTElQcmVwb3J0NDBWaWV3ZXJTZXR1cC5leGUnICI7DQogICAgICAgICAgICAgICAgc0N0bCArPSAiIHBsdWdpbnNwYWdlPSciICsgcmV4X2dzU2V0dXBVUkwgKyAiP3ZlcnNpb249IiArIHJleF92aWV3ZXJWZXJzaW9uKCkgKyAiJnZpZXdlcj00JyAiICsgIiB3aWR0aD0nIiArIHNXaWR0aCArICInIGhlaWdodD0nIiArIHNIZWlnaHQgKyAiJz48L29iamVjdD4iOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIC8vIGFsZXJ0KCIyMjI6IiArIHNDdGwpOw0KICAgICAgICBpZiAob0FnZW50LmlzSUUgfHwgb0FnZW50LmlzRkYpIHsNCiAgICAgICAgICAgIHNDdGwgKz0gIjxzY3JpcHQgdHlwZT0ndGV4dC9qYXZhc2NyaXB0JyBmb3I9J1JleEN0bCcgZXZlbnQ9J0ZpbmlzaERvY3VtZW50Jz4iICsgIlxyXG4iOw0KICAgICAgICAgICAgc0N0bCArPSAiICAgaWYodHlwZW9mIHdpbmRvdy5PbkZpbmlzaERvY3VtZW50ICE9ICd1bmRlZmluZWQnKSBPbkZpbmlzaERvY3VtZW50KCk7IiArICJcclxuIjsNCiAgICAgICAgICAgIHNDdGwgKz0gIjwvc2NyaXB0PiIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICI8c2NyaXB0IHR5cGU9J3RleHQvamF2YXNjcmlwdCcgZm9yPSdSZXhDdGwnIGV2ZW50PSdGaW5pc2hQcmludCc|IiArICJcclxuIjsNCiAgICAgICAgICAgIHNDdGwgKz0gIiAgIGlmKHR5cGVvZiB3aW5kb3cuT25CdXR0b25SZWZyZXNoQ2xpY2tBZnRlciAhPSAndW5kZWZpbmVkJykgT25CdXR0b25SZWZyZXNoQ2xpY2tBZnRlcigpOyIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICI8L3NjcmlwdD4iICsgIlxyXG4iOw0KICAgICAgICAgICAgc0N0bCArPSAiPHNjcmlwdCB0eXBlPSd0ZXh0L2phdmFzY3JpcHQnIGZvcj0nUmV4Q3RsJyBldmVudD0nQnV0dG9uRXhwb3J0WExTQ2xpY2tBZnRlcic|IiArICJcclxuIjsNCiAgICAgICAgICAgIHNDdGwgKz0gIiAgIGlmKHR5cGVvZiB3aW5kb3cuT25CdXR0b25FeHBvcnRYTFNDbGlja0FmdGVyICE9ICd1bmRlZmluZWQnKSBPbkJ1dHRvbkV4cG9ydFhMU0NsaWNrQWZ0ZXIoKTsiICsgIlxyXG4iOw0KICAgICAgICAgICAgc0N0bCArPSAiPC9zY3JpcHQ|IC0xKTsNCiAgICB9DQoNCiAgICB0aGlzLmlzV2luID0gaXMoYSwgIldpbmRvd3MiKSB8fCBpcyhhLnRvTG93ZXJDYXNlKCksICJtc2llIikgfHwgaXMoYS50b0xvd2VyQ2FzZSgpLCAicnY6Iik7DQogICAgdGhpcy5pc01hYyA9IGlzKGEsICJNYWNpbnRvc2giKTsNCiAgICB0aGlzLmlzVW5peCA9ICEodGhpcy5pc1dpbiB8fCB0aGlzLmlzTWFjKTsNCiAgICB0aGlzLmlzVmlzdGEgPSBpcyhhLnRvTG93ZXJDYXNlKCksICJudCA2Iik7DQogICAgdGhpcy5pc1dpblhwID0gaXMoYS50b0xvd2VyQ2FzZSgpLCAibnQgNS4xIik7DQogICAgdGhpcy5pc1cyayA9IGlzKGEudG9Mb3dlckNhc2UoKSwgIm50IDUuMCIpOw0KICAgIHRoaXMuaXNXOTggPSBpcyhhLnRvTG93ZXJDYXNlKCksICJ3aW5kb3dzIDk4Iik7DQogICAgdGhpcy5pc09QID0gaXMoYS50b0xvd2VyQ2FzZSgpLCAib3BlcmEiKTsNCiAgICB0aGlzLmlzSUUgPSBpcyhhLnRvTG93ZXJDYXNlKCksICJtc2llIik7DQogICAgdGhpcy5pc0ZGID0gaXMoYS50b0xvd2VyQ2FzZSgpLCAiZmlyZWZveCIpOw0KICAgIHRoaXMuaXNDUiA9IGlzKGEudG9Mb3dlckNhc2UoKSwgImNocm9tZSIpOw0KICAgIHRoaXMuaXNTRiA9IGlzKGEudG9Mb3dlckNhc2UoKSwgInNhZmFyaSIpOw0KICAgIGlmICghdGhpcy5pc0lFICYmICF0aGlzLmlzRkYgJiYgIXRoaXMuaXNDUiAmJiAhdGhpcy5pc1NGICYmICF0aGlzLmlzT1ApIHsNCiAgICAgICAgdGhpcy5pc0lFID0gaXMoYS50b0xvd2VyQ2FzZSgpLCAicnY6Iik7DQogICAgfQ0KDQogICAgaWYgKHRoaXMuaXNJRSkgew0KICAgICAgICB0aGlzLmlzV2luID0gdHJ1ZTsgLy8gMjAxMCAwMSAwNg0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgdmFyIHYgPSBwYXJzZUZsb2F0KGEubWF0Y2goL01TSUUgKFswLTlcLl0rKS8pWzFdKTsNCiAgICAgICAgICAgIGlmIChpc05hTih2KSkgew0KICAgICAgICAgICAgICAgIHRoaXMuaXNJRTAgPSB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKDYgPD0gdiAmJiB2IDwgNykgew0KICAgICAgICAgICAgICAgIHRoaXMuaXNJRTYgPSB0cnVlOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoNyA8PSB2ICYmIHYgPCA4KSB7DQogICAgICAgICAgICAgICAgdGhpcy5pc0lFNyA9IHRydWU7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfSBlbHNlIGlmICg1LjUgPD0gdiAmJiB2IDwgNikgew0KICAgICAgICAgICAgICAgIHRoaXMuaXNJRTU1ID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9IGVsc2UgaWYgKHYgPCA1LjUpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmlzSUU1ID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICB0aGlzLmlzSUUgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9IGVsc2UgaWYgKDggPD0gdiAmJiB2IDwgOSkgew0KICAgICAgICAgICAgICAgIHRoaXMuaXNJRTggPSB0cnVlOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoOSA8PSB2ICYmIHYgPCAxMCkgew0KICAgICAgICAgICAgICAgIHRoaXMuaXNJRTkgPSB0cnVlOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoMTAgPD0gdiAmJiB2IDwgMTEpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmlzSUUxMCA9IHRydWU7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICB2YXIgdiA9IHBhcnNlRmxvYXQoYS5tYXRjaCgvcnY6KFswLTlcLl0rKS8pWzFdKTsNCiAgICAgICAgICAgIGlmICgxMSA8PSB2KSB7DQogICAgICAgICAgICAgICAgdGhpcy5pc0lFMTEgPSB0cnVlOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCn07DQoNCmZ1bmN0aW9uIHJleF92aWV3ZXJWZXJzaW9uKCkgew0KICAgIHMgPSByZXhfdmlld2VyX3ZlcnNpb24ucmVwbGFjZSgvXC4vZywgIiwiKTsNCiAgICByZXR1cm4gczsNCn0NCg0KZnVuY3Rpb24gcmV4X3dyaXRlUmV4Q3RsKHNJRCkgew0KICAgIHZhciBzV2lkdGggPSAiMTAwJSI7DQogICAgdmFyIHNIZWlnaHQgPSAiMTAwJSI7DQogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKQ0KICAgICAgICBzV2lkdGggPSBhcmd1bWVudHNbMV07DQogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAyKQ0KICAgICAgICBzSGVpZ2h0ID0gYXJndW1lbnRzWzJdOw0KICAgIGRvY3VtZW50LndyaXRlKHJleF9nZXRSZXhDdGwoc0lELCBzV2lkdGgsIHNIZWlnaHQpKTsNCn0NCg0KZnVuY3Rpb24gcmV4X2dldFJleEN0bCgpIHsNCiAgICB2YXIgb0FnZW50ID0gbmV3IHJleF9BZ2VudCgpOw0KICAgIHZhciBzQ3RsID0gIiI7DQogICAgdmFyIHNJRCA9ICJSZXhDdGwiOw0KICAgIHZhciBzV2lkdGggPSAiMTAwJSI7DQogICAgdmFyIHNIZWlnaHQgPSAiMTAwJSI7DQogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAwKQ0KICAgICAgICBzSUQgPSBhcmd1bWVudHNbMF07DQogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKQ0KICAgICAgICBzV2lkdGggPSBhcmd1bWVudHNbMV07DQogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAyKQ0KICAgICAgICBzSGVpZ2h0ID0gYXJndW1lbnRzWzJdOw0KICAgIGlmICgob0FnZW50LmlzV2luIHx8IG9BZ2VudC5pc0lFKSkgew0KICAgICAgICBpZiAocmV4X2dzVmlld2VyVmVyc2lvbiA9PSAiMy4wIikgew0KICAgICAgICAgICAgaWYgKG9BZ2VudC5pc0lFKSB7DQogICAgICAgICAgICAgICAgdmFyIHNDb2RlQmFzZSA9ICJDT0RFQkFTRT0nIiArIHJleF9nc0Rvd25sb2FkVVJMICsgIlJleHBlcnQzMFZpZXdlckVYRS5jYWIjdmVyc2lvbj0iICsgcmV4X3ZpZXdlclZlcnNpb24oKSArICInIjsNCiAgICAgICAgICAgICAgICBpZiAocmV4X3ZpZXdlcl9pbnN0YWxsLnRvVXBwZXJDYXNlKCkgPT0gIk5PTkUiKQ0KICAgICAgICAgICAgICAgICAgICBzQ29kZUJhc2UgPSAiIjsNCiAgICAgICAgICAgICAgICBzQ3RsICs9ICI8b2JqZWN0IGlkPSciICsgc0lEICsgIicgY2xhc3NpZD0nQ0xTSUQ6RkMwMzUwOTktODMzRS00QUIxLUJGNDgtMzdEMDhGNUU1NTNDJyAiICsgc0NvZGVCYXNlICsgIiB3aWR0aD0nIiArIHNXaWR0aCArICInIGhlaWdodD0nIiArIHNIZWlnaHQgKyAiJz4iOw0KICAgICAgICAgICAgICAgIHNDdGwgKz0gIjxpZnJhbWUgaWQ9J3JleF9pZnJtUmV4UHJldmlldycgbmFtZT0ncmV4X2lmcm1SZXhQcmV2aWV3JyBzcmM9JyIgKyByZXhfZ3NTZXR1cFVSTCArICI|dmVyc2lvbj0iICsgcmV4X3ZpZXdlclZlcnNpb24oKSArICInIHdpZHRoPScxMDAlJyBoZWlnaHQ9JzEwMCUnIGZyYW1lYm9yZGVyPScwJz48L2lmcmFtZT4iOw0KICAgICAgICAgICAgICAgIHNDdGwgKz0gIjwvb2JqZWN0PiI7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHZhciBwbHVnaW5taW1lID0gImFwcGxpY2F0aW9uL3JleHBlcnQzLjAucGx1Z2luLHZlcnNpb249IiArIHJleF92aWV3ZXJWZXJzaW9uKCk7DQogICAgICAgICAgICAgICAgdmFyIGFWZXIgPSByZXhfdmlld2VyVmVyc2lvbigpLnNwbGl0KCIsIik7DQogICAgICAgICAgICAgICAgdmFyIGlWZXIgPSBwYXJzZUludChhVmVyWzBdKSAqIDEwMDAwICsgcGFyc2VJbnQoYVZlclsxXSkgKiAxMDAwICsgcGFyc2VJbnQoYVZlclsyXSkgKiAxMDAwICsgcGFyc2VJbnQoYVZlclszXSkgKiAxOw0KICAgICAgICAgICAgICAgIHZhciB0eXBlQXJyID0gIiI7DQogICAgICAgICAgICAgICAgdmFyIGFWZXJFeGlzdEFyciA9ICIiOw0KICAgICAgICAgICAgICAgIHZhciBhVmVyRXhpc3QgPSAiIjsNCiAgICAgICAgICAgICAgICB2YXIgdmlld2VyRXhpc3RZTiA9ICJOIjsNCiAgICAgICAgICAgICAgICBpZiAoaVZlciA8IDEwMTM2KSB7DQogICAgICAgICAgICAgICAgICAgIHBsdWdpbm1pbWUgPSAiYXBwbGljYXRpb24vcmV4cGVydDMuMC5wbHVnaW4sdmVyc2lvbj0xLjAuMC4xIjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKG9BZ2VudC5pc0NSIHx8IG9BZ2VudC5pc09QIHx8IG9BZ2VudC5pc1NGIHx8IG9BZ2VudC5pc0ZGKSB7DQogICAgICAgICAgICAgICAgICAgIC8vIHZhciBtaW1ldHlwZSA9IG5hdmlnYXRvci5taW1lVHlwZXNbcGx1Z2lubWltZV07DQogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbmF2aWdhdG9yLm1pbWVUeXBlcy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHR5cGUgPSBuYXZpZ2F0b3IubWltZVR5cGVzW2ldLnR5cGU7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZS5pbmRleE9mKCJhcHBsaWNhdGlvbi9yZXhwZXJ0My4wLnBsdWdpbiIpICE9IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld2VyRXhpc3RZTiA9ICJZIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlQXJyID0gdHlwZS5zcGxpdCgiPSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFWZXJFeGlzdEFyciA9IHR5cGVBcnJbMV0uc3BsaXQoIiwiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhVmVyRXhpc3QgPSBhVmVyRXhpc3RBcnJbM107DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXdlckV4aXN0WU4gPT0gIk4iIHx8IChwYXJzZUludChhVmVyRXhpc3QpIDwgcGFyc2VJbnQoYVZlclszXSkpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKHJleF9nc1NldHVwVVJMICsgIj92ZXJzaW9uPSIgKyByZXhfdmlld2VyVmVyc2lvbigpKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAvLyBzQ3RsICs9ICI8b2JqZWN0IGlkPSciICsgc0lEICsgIicgdHlwZT0nIiArIHBsdWdpbm1pbWUgKyAiJw0KICAgICAgICAgICAgICAgIC8vICI7DQogICAgICAgICAgICAgICAgc0N0bCArPSAiPG9iamVjdCBpZD0nIiArIHNJRCArICInICI7DQogICAgICAgICAgICAgICAgaWYgKHZpZXdlckV4aXN0WU4gPT0gIlkiKSB7DQogICAgICAgICAgICAgICAgICAgIHNDdGwgKz0gInR5cGU9JyIgKyAiYXBwbGljYXRpb24vcmV4cGVydDMuMC5wbHVnaW4sdmVyc2lvbj0xLDAsMCwiICsgYVZlckV4aXN0ICsgIicgIjsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBzQ3RsICs9ICJ0eXBlPSciICsgcGx1Z2lubWltZSArICInICI7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHNDdGwgKz0gIiBjb2RlYmFzZT0nIiArIHJleF9nc0Rvd25sb2FkVVJMICsgInJleHBlcnQzMHZpZXdlci5leGUnICI7DQogICAgICAgICAgICAgICAgc0N0bCArPSAiIHBsdWdpbnNwYWdlPSciICsgcmV4X2dzU2V0dXBVUkwgKyAiP3ZlcnNpb249IiArIHJleF92aWV3ZXJWZXJzaW9uKCkgKyAiJyAiICsgIiB3aWR0aD0nIiArIHNXaWR0aCArICInIGhlaWdodD0nIiArIHNIZWlnaHQgKyAiJz48L29iamVjdD4iOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2UgaWYgKHJleF9nc1ZpZXdlclZlcnNpb24gPT0gIjQuMCIpIHsNCiAgICAgICAgICAgIGlmIChvQWdlbnQuaXNJRSkgew0KICAgICAgICAgICAgICAgIHZhciBzQ29kZUJhc2UgPSAiQ09ERUJBU0U9JyIgKyByZXhfZ3NEb3dubG9hZFVSTCArICJDTElQcmVwb3J0NDBWaWV3ZXJTZXR1cC5jYWIjdmVyc2lvbj0iICsgcmV4X3ZpZXdlclZlcnNpb24oKSArICInIjsNCiAgICAgICAgICAgICAgICBpZiAocmV4X3ZpZXdlcl9pbnN0YWxsLnRvVXBwZXJDYXNlKCkgPT0gIk5PTkUiKQ0KICAgICAgICAgICAgICAgICAgICBzQ29kZUJhc2UgPSAiIjsNCiAgICAgICAgICAgICAgICBzQ3RsICs9ICI8b2JqZWN0IGlkPSciICsgc0lEICsgIicgY2xhc3NpZD0nQ0xTSUQ6RkZCMDNENUItMUIxQS00MjNGLUFFMDctMDJBRTI1NjJFNTg1JyAiICsgc0NvZGVCYXNlICsgIiB3aWR0aD0nIiArIHNXaWR0aCArICInIGhlaWdodD0nIiArIHNIZWlnaHQgKyAiJz4iOw0KICAgICAgICAgICAgICAgIHNDdGwgKz0gIjxpZnJhbWUgaWQ9J3JleF9pZnJtUmV4UHJldmlldycgbmFtZT0ncmV4X2lmcm1SZXhQcmV2aWV3JyBzcmM9JyIgKyByZXhfZ3NTZXR1cFVSTCArICI|IjsNCiAgICAgICAgICAgIHNDdGwgKz0gIiAgIGlmKHR5cGVvZiB3aW5kb3cuT25CdXR0b25FeHBvcnRIV1BDbGlja0JlZm9yZSAhPSAndW5kZWZpbmVkJykgT25CdXR0b25FeHBvcnRIV1BDbGlja0JlZm9yZShDYW5jZWwpOyIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICI8L3NjcmlwdD4iOw0KICAgICAgICAgICAgc0N0bCArPSAiPHNjcmlwdCB0eXBlPSd0ZXh0L2phdmFzY3JpcHQnIGZvcj0nUmV4Q3RsJyBldmVudD0nQnV0dG9uRXhwb3J0UERGQ2xpY2tCZWZvcmUoQ2FuY2VsKSc|IjsNCiAgICAgICAgfQ0KICAgICAgICBpZiAocmV4X2dzUGx1Z2luRmlsZVR5cGUgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBzYiArPSAiIDxwbHVnaW4gdHlwZT0nIiArIHJleF9nc1BsdWdpbkZpbGVUeXBlICsgIic|Ly8gcmVwZXJ0LmpzIGluZm8NCi8vIHZlcnNpb24gOiByZXhwZXJ0IDMuMA0KLy8gZGF0ZSA6IDIwMTQtMDYtMDMNCi8vDQovLyBSZXhwZXJ0IFNlcnZlciBTY3JpcHQgVmVyc2lvbiBJbmZvcm1hdGlvbg0KdmFyIHJleFNjcmlwdF92ZXJzaW9uID0gIjIwMTQtMTItMTYiOw0KdmFyIHJleFNjcmlwdF9kYXRldGltZSA9IHJleFNjcmlwdF92ZXJzaW9uLnJlcGxhY2UoLy0vZywgIiIpOw0KLy8gUmV4cGVydCBjb250ZXh0IHJvb3QgdXJsDQp2YXIgcmV4X2dzUmV4U2VydmljZVJvb3RVUkwgPSB3aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgKyAiLy8iICsgd2luZG93LmxvY2F0aW9uLmhvc3QgKyAiL1JleFNlcnZlcjMwLyI7DQovLyBwcmV2aWV3IHBhZ2UNCnZhciByZXhfZ3NQcmVWaWV3VVJMID0gcmV4X2dzUmV4U2VydmljZVJvb3RVUkwgKyAicmV4cHJldmlldy5qc3AiOw0KLy8gcmViZmlsZXMgcm9vdCBkaXJlY3RvcnkNCnZhciByZXhfZ3NSZXBvcnRVUkwgPSByZXhfZ3NSZXhTZXJ2aWNlUm9vdFVSTCArICJyZWJmaWxlcy8iOw0KLy8gY2FiICYgcGx1Z2luIGRvd25sb2FkIGRpcmVjdG9yeQ0KdmFyIHJleF9nc0Rvd25sb2FkVVJMID0gcmV4X2dzUmV4U2VydmljZVJvb3RVUkwgKyAiY2FiLyI7DQovLyBzZXR1cCBwYWdlIHVybA0KdmFyIHJleF9nc1NldHVwVVJMID0gcmV4X2dzUmV4U2VydmljZVJvb3RVUkwgKyAiY2FiL2Rvd25sb2FkL3NldHVwLmpzcCI7DQovLyBWaWV3ZXIgRG93bmxvYWQgUGFnZSBVUkwNCnZhciByZXhfZ3NWaWV3ZXJEb3dubG9hZFVSTCA9IHJleF9nc1JleFNlcnZpY2VSb290VVJMICsgImNhYi9nZXR2aWV3ZXIuanNwP2Y9cmV4cGVydDMwdmlld2VyLmV4ZSI7DQovLyBSZXhTZXJ2ZXIgc2VydmljZSB1cmwNCnZhciByZXhfZ3NScHRTZXJ2aWNlVVJMID0gcmV4X2dzUmV4U2VydmljZVJvb3RVUkwgKyAicmV4c2VydmljZS5qc3AiOw0KLy8gRXhwb3J0IFNlcnZpY2UgVVJMDQp2YXIgcmV4X2dzUnB0RXhwb3J0U2VydmljZVVSTCA9IHJleF9nc1JleFNlcnZpY2VSb290VVJMICsgImV4cG9ydHNlcnZpY2UuanNwIjsNCi8vIEV4cG9ydCBVUkwNCnZhciByZXhfZ3NScHRFeHBvcnRVUkwgPSByZXhfZ3NSZXhTZXJ2aWNlUm9vdFVSTCArICJleHBvcnQuanNwIjsNCi8vIGRlZmF1bHQgREJjb25uZWN0aW9uDQp2YXIgcmV4X2dzVXNlclNlcnZpY2UgPSAiIjsNCi8vIHZpZXdlciBWZXJzaW9uDQp2YXIgcmV4X3ZpZXdlcl92ZXJzaW9uID0gIjEsMCwwLDAiOw0KdmFyIHJleF92aWV3ZXJfaW5zdGFsbCA9ICJFQUNIIjsgLy8gRUFDSCwgT05DRSwgTk9ORQ0KLy8gc2V0dGluZyBDU1YgaW5mb3JtYXRpb24NCnZhciByZXhfZ3NDc3ZTZXBhcmF0b3JDb2x1bW4gPSAifCp8IjsNCnZhciByZXhfZ3NDc3ZTZXBhcmF0b3JSb3cgPSAifCN8IjsNCnZhciByZXhfZ3NDc3ZTZXBhcmF0b3JEYXRhU2V0ID0gInxAfCI7DQp2YXIgcmV4X2dzQ3N2RW5jb2RpbmcgPSAidXRmLTgiOw0KLy8gZGVmYXVsdCBYTUwgeHBhdGgNCnZhciByZXhfZ3NYUGF0aCA9ICJndWJ1bi9ycHQxL3JleGRhdGFzZXQvcmV4cm93IjsNCi8vIFJleHBlcnQgV2ViIFZpZXdlciBXaW5kb3dzIFNpemUNCnZhciByZXhfZ3NQcmVWaWV3RmVhdHVyZXMgPSAiY2VudGVyPXllcyxzY3JvbGxiYXJzPW5vLHN0YXR1cz1ubyx0b29sYmFyPW5vLHJlc2l6YWJsZT0xLGxvY2F0aW9uPW5vLG1lbnU9bm8iOw0KdmFyIHJleF9nc1ByZVZpZXdGZWF0dXJlc01vZGFsID0gImNlbnRlcjp5ZXM7cmVzaXphYmxlOm5vO3Njcm9sbDpubztzdGF0dXM6bm87ZGlhbG9nV2lkdGg6ODI1cHg7ZGlhbG9nSGVpZ2h0OjYwMHB4IjsNCi8vIExhbmd1YWdlIGluZm9ybWF0aW9uDQp2YXIgcmV4X2dzVmlld2VyTGFuZ3VhZ2UgPSAia28iOw0KLy8gUmV4U2VydmVyIDIuNSBjb21wYXRpYmxlDQp2YXIgcmV4X2dzU2VydmVyVmVyc2lvbiA9ICIzLjAiOyAvLyAyLjUsIDMuMA0KLy8gc2V0dGluZyBSZXhTZXJ2ZXIgMi41DQp2YXIgcmV4X2dzUnB0U2VydmljZVVSTF9SZXhTZXJ2ZXIyNSA9IHJleF9nc1JleFNlcnZpY2VSb290VVJMICsgInJleHNlcnZpY2UyNS5qc3AiOw0KdmFyIHJleF9nc0NzdlNlcGFyYXRvckNvbHVtbl9SZXhTZXJ2ZXIyNSA9ICJ8KnwiOw0KdmFyIHJleF9nc0NzdlNlcGFyYXRvclJvd19SZXhTZXJ2ZXIyNSA9ICJ8KnwiOw0KdmFyIHJleF9nc0NzdlNlcGFyYXRvckRhdGFTZXRfUmV4U2VydmVyMjUgPSAifEB8IjsNCnZhciByZXhfZ3NDc3ZFbmNvZGluZ19SZXhTZXJ2ZXIyNSA9ICJ1dGYtOCI7DQp2YXIgcmV4X2dzWFBhdGhfUmV4U2VydmVyMjUgPSAicm9vdC9tYWluL3JwdDEvcmV4ZGF0YXNldC9yZXhyb3ciOw0KLy8gc2hvdyBwYXJhbWV0ZXIgZGlhbG9nDQp2YXIgcmV4X2dzU2hvd3BhcmFtZXRlcmRpYWxvZyA9ICIwIjsNCi8vIGh0dHAgdGltZW91dA0KdmFyIHJleF9nc0h0dHBUaW1lb3V0Ow0KdmFyIHJleF9nc1ZpZXdlclZlcnNpb24gPSAiMy4wIjsNCg0KdmFyIHJleF9nc1VzZVByZXBhcmVkU3RhdGVtZW50ID0gImZhbHNlIjsNCg0KLyoNCiAqIHZhciByZXhfZ3NIdHRwVGltZW91dCA9IHsiY29ubmVjdC50aW1lb3V0IjogMzAwMDAgLCAiY29udHJvbC5zZW5kLnRpbWVvdXQiOg0KICogMzAwMDAgLCAiY29udHJvbC5yZWNlaXZlLnRpbWVvdXQiOiAzMDAwMCAsICJkYXRhLnNlbmQudGltZW91dCI6IDMwMDAwICwNCiAqICJkYXRhLnJlY2VpdmUudGltZW91dCI6IDMwMDAwfTsNCiAqLw0KLy8gc2V0dGluZyBjc3MNCnZhciByZXhfZ3NDc3M7DQovKg0KICogdmFyIHJleF9nc0NzcyA9IFsgImFwcGVhcmFuY2UucGFnZW1hcmdpbi52aXNpYmxlPTAiDQogKiAsImFwcGVhcmFuY2UudG9vbGJhci5idXR0b24ucHJpbnQuZW5hYmxlPTAiICwiYWNjZXNzaWJpbGl0eS5lbmFibGU9MCINCiAqICwiYXBwZWFyYW5jZS5jYW52YXMuYmFja2NvbG9yPXJnYigyNTUsMjU1LDApIg0KICogLCJhcHBlYXJhbmNlLmNvbnRyb2wuYmFja2NvbG9yPXJnYigyNTUsMCwwKSIgLCJhcHBlYXJhbmNlLmNhbnZhcy5vZmZzZXR4PTAiDQogKiAsImFwcGVhcmFuY2UudG9vbGJhci5idXR0b24ub3Blbi52aXNpYmxlPTAiDQogKiAsImFwcGVhcmFuY2UudG9vbGJhci5idXR0b24uY2xvc2V3aW5kb3cudmlzaWJsZT0xIg0KICogLCJhcHBlYXJhbmNlLnRhYmhlYWRlci5jbG9zZS5lbmFibGU9MCIgLCJhcHBlYXJhbmNlLnJlcG9ydGxpc3QudmlzaWJsZT0xIg0KICogLCJwcmludC5hcHBlYXJhbmNlLmFsbHJlcG9ydHByaW50LmVuYWJsZT0xIiAsInByaW50LmFsbHJlcG9ydHByaW50PTEiIC4uLiBdOw0KICovDQovLyBjYWxsIG1ldGhvZA0KdmFyIHJleF9nc01ldGhvZDsNCi8qDQogKiByZXhfZ3NNZXRob2QgPSBbICJab29tKCd3aG9sZXBhZ2UnKSIgLCJab29tKCdwYWdld2lkdGgnKSIgLCJab29tKCcyMDAnKSINCiAqICwiWm9vbUluKCkiICwiWm9vbU91dCgpIiBdOw0KICovDQovLyBwbHVnaW4gLSB3ZWJjcnlwdG8NCnZhciByZXhfZ3NQbHVnaW5UeXBlV2ViOw0KdmFyIHJleF9nc1BsdWdpbldlYlBhcmFtOw0KLyoNCiAqIHZhciByZXhfZ3NQbHVnaW5UeXBlV2ViID0gImNyeXB0by5jbGlwc29mdCI7IHZhciByZXhfZ3NQbHVnaW5XZWJQYXJhbSA9DQogKiB7Im5hbWUiOiAibmFtZSIsICJjb21tb24tZW5hYmxlLWVuY29kZSI6ICIxIiwgImNvbW1vbi1lbmFibGUtZGVjb2RlIjogIjAiLA0KICogImNvbW1vbi1kZWxpbWl0ZXIiOiAifCF8IiwgImNvbW1vbi1lbmNvZGluZyI6ICJldWMta3IiLCAiY29tbW9uLWVuYWJsZS1sb2ciOg0KICogIjAiLCAiY29tbW9uLWxvZy1maWxlbmFtZSI6ICJjOlx0ZXN0Mi5sb2cifTsNCiAqIA0KICogdmFyIHJleF9nc1BsdWdpblR5cGVXZWIgPSAiY3J5cHRvLnhlY3VyZXdlYiI7IHZhciByZXhfZ3NQbHVnaW5XZWJQYXJhbSA9DQogKiB7Im5hbWUiOiAibmFtZSIsICJjb21tb24tZW5hYmxlLWVuY29kZSI6ICIxIiwgImNvbW1vbi1lbmFibGUtZGVjb2RlIjogIjAiLA0KICogImNvbW1vbi1kZWxpbWl0ZXIiOiAifCF8IiwgImNvbW1vbi1lbmNvZGluZyI6ICJldWMta3IiLCAiY29tbW9uLWVuYWJsZS1sb2ciOg0KICogIjAiLCAiY29tbW9uLWxvZy1maWxlbmFtZSI6ICJjOlx0ZXN0Mi5sb2ciLCAieGVjdXJld2ViLWdhdGVhZGRyIjoNCiAqICJpcC1hZGRyZXNzOjQ0Mzo4MDgwIiwgInhlY3VyZXdlYi1hdXRodHlwZSI6ICIiLCAieGVjdXJld2ViLW1laHRvZCI6ICJQT1NUIiwNCiAqICJ4ZWN1cmV3ZWItc2Vzc2lvbmtlIjogIjBBMEUzOTBDMTg5RTAwRjMyRjkyMTRCMkQxODZGMjU2MUQ3QjFFQUUxMDE0QTMifTsNCiAqLw0KLyoNCiAqIHZhciByZXhfZ3NQbHVnaW5UeXBlV2ViID0gImNyeXB0by5pbml0ZWNoLi4uIjsgLi4uDQogKi8NCi8vIHBsdWdpbiAtIERSTQ0KdmFyIHJleF9nc1BsdWdpblR5cGU7DQp2YXIgcmV4X2dzUGx1Z2luUGFyYW07DQovKg0KICogdmFyIHJleF9nc1BsdWdpblR5cGUgPSAibWFya2FueSI7IHZhciByZXhfZ3NQbHVnaW5QYXJhbSA9IHsiZGF0YXBhdGgiOg0KICogcmV4X2dzUmV4U2VydmljZVJvb3RVUkwgKyAiL3BsdWdpbi9tYXJrYW55L01hRnBzQ29tbW9uLmpzcCIsICJkYXRhZmlsZW5hbWUiOg0KICogIk1hUHJpbnRJbmZvQ1VTVFJQLmRhdCIsICJlbmFibGVjYXB0dXJlIjogIjAiLCAiZW5hYmxlc3Bvb2wiOiAiMCIsDQogKiAiZW5hYmxlcHJpbnRlciI6ICIwIiwgInByaW50ZXJvcHRpb24iOiAiMyIsICJpbWFnZXNhZmVyb3B0aW9uIjogIjAifTsNCiAqIA0KICogdmFyIHJleF9nc1BsdWdpblR5cGUgPSAiYmNxdXJlIjsgdmFyIHJleF9nc1BsdWdpblBhcmFtID0geyJpbml0cGF0aCI6DQogKiByZXhfZ3NSZXhTZXJ2aWNlUm9vdFVSTCArICIvcGx1Z2luL2JjcXJlL3BybkluaXQvIiwgImRhdGFwYXRoIjoNCiAqIHJleF9nc1JleFNlcnZpY2VSb290VVJMICsgIi9wbHVnaW4vYmNxcmUvYmNxcmUuc2VydmVyLmpzcCIsICJkb2NudW1iZXIiOg0KICogImtzZmMiLCAiZG9jbmFtZSI6ICJrc2ZjIiwgImJhcmNvZGV3aWR0aCI6ICI2MDAiLCAiYmFyY29kZW1pbmhlaWdodCI6ICI1MCIsDQogKiAiYmFyY29kZW1heGhlaWdodCI6ICIyMDAifTsNCiAqLw0KdmFyIHJleF9nc1BsdWdpbkh0dHBQYXJhbSA9IHt9Ow0KLyoNCiAqIHJleF9nc1BsdWdpbkh0dHBQYXJhbSA9IHsidGVzdCI6ICJhYmNkIiwgInRlc3QyIjogIjEyMzQifTsNCiAqLw0KLy8gcGx1Z2luIC0gRFJNIGZpbGUNCnZhciByZXhfZ3NQbHVnaW5GaWxlVHlwZTsNCnZhciByZXhfZ3NQbHVnaW5GaWxlUGFyYW07DQovKg0KICogdmFyIHJleF9nc1BsdWdpbkZpbGVUeXBlID0gIm1hcmthbnkuZHJtIjsgdmFyIHJleF9nc1BsdWdpbkZpbGVQYXJhbSA9DQogKiB7ImtleTEiOiAidmFsdWUxIiwgImtleTIiOiAidmFsdWUyIn07DQogKi8NCg0KdmFyIHJleF9BZ2VudCA9IGZ1bmN0aW9uKCkgew0KICAgIHZhciBhID0gbmF2aWdhdG9yLnVzZXJBZ2VudDsNCg0KICAgIGZ1bmN0aW9uIGlzKHMsIHQpIHsNCiAgICAgICAgcmV0dXJuICgocyB8fCAiIikuaW5kZXhPZih0KSA|IjsNCiAgICAgICAgfQ0KICAgICAgICBpZiAocmV4X2dzUGx1Z2luVHlwZVdlYiAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIHNiICs9ICIgPHBsdWdpbiB0eXBlPSciICsgcmV4X2dzUGx1Z2luVHlwZVdlYiArICInPiI7DQogICAgICAgICAgICBzYiArPSAiICAgICAgPGNvbmZpZy1wYXJhbS1saXN0PiI7DQogICAgICAgICAgICBmb3IgKCB2YXIgbmtleSBpbiByZXhfZ3NQbHVnaW5XZWJQYXJhbSkgew0KICAgICAgICAgICAgICAgIHNiICs9ICIgPGNvbmZpZy1wYXJhbSBuYW1lPSciICsgbmtleSArICInPiIgKyByZXhfZ3NQbHVnaW5XZWJQYXJhbVtua2V5XSArICI8L2NvbmZpZy1wYXJhbT4iOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgc2IgKz0gIiAgICAgIDwvY29uZmlnLXBhcmFtLWxpc3Q|ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789|IjsNCiAgICAgICAgLy8gY29tbW9uIGNvb2tpZSDstpTqsIANCiAgICAgICAgc2IgKz0gIjxjb25maWctcGFyYW0tbGlzdD4iOw0KICAgICAgICBpZiAodGhpcy5jb29raWUgIT0gIiIgJiYgdGhpcy5jb29raWUgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBzYiArPSAiPGNvbmZpZy1wYXJhbSBuYW1lPSdjb29raWUnPjwhW0NEQVRBWyIgKyB0aGlzLmNvb2tpZSArICJdXT48L2NvbmZpZy1wYXJhbT4iOw0KICAgICAgICB9DQogICAgICAgIGlmICh0aGlzLnVzZXJhZ2VudCAhPSAiIiAmJiB0aGlzLnVzZXJhZ2VudCAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIHNiICs9ICI8Y29uZmlnLXBhcmFtIG5hbWU9J3VzZXJhZ2VudCc|IjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHNiICs9ICIgICAgICA8L2NvbmZpZy1wYXJhbS1saXN0PiI7DQogICAgICAgICAgICBzYiArPSAiIDwvcGx1Z2luPiI7DQogICAgICAgIH0NCiAgICAgICAgc2IgKz0gIjwvcGx1Z2luLWxpc3Q|IjsNCiAgICAgICAgICAgIGZvciAoIHZhciBua2V5IGluIHJleF9nc1BsdWdpbkZpbGVQYXJhbSkgew0KICAgICAgICAgICAgICAgIHNiICs9ICIgPGNvbmZpZy1wYXJhbSBuYW1lPSciICsgbmtleSArICInPiIgKyByZXhfZ3NQbHVnaW5GaWxlUGFyYW1bbmtleV0gKyAiPC9jb25maWctcGFyYW0|IjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHNiICs9ICIgICAgICA8L2NvbmZpZy1wYXJhbS1saXN0PiI7DQogICAgICAgICAgICBzYiArPSAiICAgICAgPGh0dHAtcGFyYW0tbGlzdD4iOw0KICAgICAgICAgICAgLy8gaHR0cCBwYXJhbSDstpTqsIAyMDEzLTEyLTI2DQogICAgICAgICAgICBpZih0aGlzLmNlbGx3aWR0aCAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgc2IgKz0gIiAgICAgICAgICAgICAgPGh0dHAtcGFyYW0gbmFtZT0nY2VsbHdpZHRoJz4iICsgdGhpcy5jZWxsd2lkdGggKyAiPC9odHRwLXBhcmFtPiI7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZih0aGlzLmNlbGxoZWlnaHQgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgIHNiICs9ICIgICAgICAgICAgICAgIDxodHRwLXBhcmFtIG5hbWU9J2NlbGxoZWlnaHQnPiIgKyB0aGlzLmNlbGxoZWlnaHQgKyAiPC9odHRwLXBhcmFtPiI7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBmb3IgKCB2YXIgbmtleSBpbiByZXhfZ3NQbHVnaW5IdHRwUGFyYW0pIHsNCiAgICAgICAgICAgICAgICBzYiArPSAiICAgICAgICAgICAgICA8aHR0cC1wYXJhbSBuYW1lPSciICsgbmtleSArICInPiIgKyByZXhfZ3NQbHVnaW5IdHRwUGFyYW1bbmtleV0gKyAiPC9odHRwLXBhcmFtPiI7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBzYiArPSAiICAgICAgPC9odHRwLXBhcmFtLWxpc3Q|IjsNCiAgICAgICAgICAgIHNDdGwgKz0gIiAgIGlmKHR5cGVvZiB3aW5kb3cuT25CdXR0b25FeHBvcnRDbGlja0JlZm9yZSAhPSAndW5kZWZpbmVkJykgT25CdXR0b25FeHBvcnRDbGlja0JlZm9yZShDYW5jZWwpOyIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICI8L3NjcmlwdD4iOw0KICAgICAgICAgICAgc0N0bCArPSAiPHNjcmlwdCB0eXBlPSd0ZXh0L2phdmFzY3JpcHQnIGZvcj0nUmV4Q3RsJyBldmVudD0nQnV0dG9uUHJpbnRDbGlja0JlZm9yZShDYW5jZWwpJz4iOw0KICAgICAgICAgICAgc0N0bCArPSAiICAgaWYodHlwZW9mIHdpbmRvdy5PbkJ1dHRvblByaW50Q2xpY2tCZWZvcmUgIT0gJ3VuZGVmaW5lZCcpIE9uQnV0dG9uUHJpbnRDbGlja0JlZm9yZShDYW5jZWwpOyIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICI8L3NjcmlwdD4iOw0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgc0N0bCArPSAiPGlmcmFtZSBpZD0ncmV4X2lmcm1SZXhQcmV2aWV3JyBuYW1lPSdyZXhfaWZybVJleFByZXZpZXcnIHNyYz0nYWJvdXQ6YmxhbmsnIHdpZHRoPSc5OSUnIGhlaWdodD0nOTklJyBmcmFtZWJvcmRlcj0nMCcgc2Nyb2xsaW5nPSdubyc|IjsNCiAgICAgICAgICAgIHNDdGwgKz0gIiAgIGlmKHR5cGVvZiB3aW5kb3cuT25CdXR0b25FeHBvcnRYTFNDbGlja0JlZm9yZSAhPSAndW5kZWZpbmVkJykgT25CdXR0b25FeHBvcnRYTFNDbGlja0JlZm9yZShDYW5jZWwpOyIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICI8L3NjcmlwdD4iOw0KICAgICAgICAgICAgc0N0bCArPSAiPHNjcmlwdCB0eXBlPSd0ZXh0L2phdmFzY3JpcHQnIGZvcj0nUmV4Q3RsJyBldmVudD0nQnV0dG9uUmVmcmVzaENsaWNrQmVmb3JlKENhbmNlbCknPiI7DQogICAgICAgICAgICBzQ3RsICs9ICIgICBpZih0eXBlb2Ygd2luZG93Lk9uQnV0dG9uUmVmcmVzaENsaWNrQmVmb3JlICE9ICd1bmRlZmluZWQnKSBPbkJ1dHRvblJlZnJlc2hDbGlja0JlZm9yZShDYW5jZWwpOyIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICI8L3NjcmlwdD4iOw0KICAgICAgICAgICAgc0N0bCArPSAiPHNjcmlwdCB0eXBlPSd0ZXh0L2phdmFzY3JpcHQnIGZvcj0nUmV4Q3RsJyBldmVudD0nQnV0dG9uRXhwb3J0Q2xpY2tCZWZvcmUoQ2FuY2VsKSc|IjsNCiAgICAgICAgICAgIHNDdGwgKz0gIiAgIGlmKHR5cGVvZiB3aW5kb3cuT25CdXR0b25FeHBvcnRQREZDbGlja0JlZm9yZSAhPSAndW5kZWZpbmVkJykgT25CdXR0b25FeHBvcnRQREZDbGlja0JlZm9yZShDYW5jZWwpOyIgKyAiXHJcbiI7DQogICAgICAgICAgICBzQ3RsICs9ICI8L3NjcmlwdD4iOw0KICAgICAgICAgICAgc0N0bCArPSAiPHNjcmlwdCB0eXBlPSd0ZXh0L2phdmFzY3JpcHQnIGZvcj0nUmV4Q3RsJyBldmVudD0nQnV0dG9uRXhwb3J0WExTQ2xpY2tCZWZvcmUoQ2FuY2VsKSc|IjsNCiAgICB9DQogICAgcmV0dXJuIHNDdGw7DQp9DQoNCi8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQovLyBMb2NhdGlvbkhvc3QoKSBjbGFzcyBkZWNsYXJhdGlvbg0KLy8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCmZ1bmN0aW9uIHJleF9mbkxvY2F0aW9uSG9zdCgpIHsNCiAgICB2YXIgc3RyID0gIiIgKyBkb2N1bWVudC5sb2NhdGlvbjsNCiAgICB2YXIgaGVhZGVyID0gImh0dHA6Ly8iOw0KICAgIHZhciBoZWFkZXJfbGVuZ3RoID0gaGVhZGVyLmxlbmd0aDsNCiAgICB2YXIgcG9zID0gc3RyLmluZGV4T2YoIi8iLCBoZWFkZXJfbGVuZ3RoKTsNCiAgICB2YXIgc3RyX3NlcnZlciA9IHN0ci5zdWJzdHJpbmcoMCwgcG9zKTsNCiAgICByZXR1cm4gc3RyX3NlcnZlcjsNCn0NCg0KLy8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCi8vIHBhcmFtIGNsYXNzIGRlY2xhcmF0aW9uDQovLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KdmFyIHJleF9nb1BhcmFtU2V0ID0ge307DQovLyAyMDEwLTA3LTIyDQp2YXIgcmV4X2dhUmVwb3J0cyA9IG5ldyBBcnJheSgpOw0KdmFyIHJleF9nYVJlcG9ydHNJbmRleCA9IDA7DQoNCmZ1bmN0aW9uIEdldGZuUGFyYW1TZXQoKSB7DQogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAwKSB7DQogICAgICAgIGlmIChhcmd1bWVudHNbMF0gPT0gInJleF90b2MiKSB7DQogICAgICAgICAgICByZXhfZ29QYXJhbVNldCA9IHt9Ow0KICAgICAgICB9DQogICAgICAgIHJldHVybiBHZXRQYXJhbVNldChhcmd1bWVudHNbMF0pOw0KICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiBHZXRQYXJhbVNldCgpOw0KICAgIH0NCn0NCg0KZnVuY3Rpb24gR2V0UGFyYW1TZXQoKSB7DQogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAwKSB7DQogICAgICAgIHJleF9nb1BhcmFtU2V0W2FyZ3VtZW50c1swXV0gPSBuZXcgcmV4X1BhcmFtU2V0KGFyZ3VtZW50c1swXSk7DQogICAgICAgIHJleF9nb1BhcmFtU2V0W2FyZ3VtZW50c1swXV0uZGF0YXR5cGUgPSAiQ1NWIjsNCiAgICAgICAgcmV0dXJuIHJleF9nb1BhcmFtU2V0W2FyZ3VtZW50c1swXV07DQogICAgfSBlbHNlIHsNCiAgICAgICAgcmV4X2dvUGFyYW1TZXRbIjAiXSA9IG5ldyByZXhfUGFyYW1TZXQoIjAiKTsNCiAgICAgICAgcmV0dXJuIHJleF9nb1BhcmFtU2V0WyIwIl07DQogICAgfQ0KfQ0KDQovKg0KICogMjAxMy0wNS0wOSBpcmFlIFZCU2NyaXB0IOyCrOyaqeydhCDsnITtlbQg67OA7IiYIOy0iOq4sO2ZlC4NCiAqLw0KZnVuY3Rpb24gcmV4X1BhcmFtU2V0KGlkKSB7DQogICAgdGhpcy5pZCA9IGlkOw0KICAgIHRoaXMudHlwZSA9ICJodHRwIjsgLy8gaHR0cCwgZmlsZSwgbWVtbywgYWRvKG5vdCB1c2VkKQ0KICAgIHRoaXMub3BlbnR5cGUgPSAiIjsNCiAgICB0aGlzLnJwdG5hbWUgPSAiIjsNCiAgICB0aGlzLmV4cG9ydHNlcnZpY2UgPSB7fTsNCiAgICB0aGlzLmV4cG9ydHNlcnZpY2UucGFyYW0gPSB7fTsNCiAgICB0aGlzLmV4cG9ydHNlcnZpY2UuZmlsZW5hbWUgPSBudWxsOw0KICAgIHRoaXMuZXhwb3J0c2VydmljZS5maWxldHlwZSA9ICJwZGYiOw0KICAgIHRoaXMuZGF0YXR5cGUgPSAiIjsNCiAgICB0aGlzLmRhdGFpbmRleCA9ICIiOw0KICAgIHRoaXMuZGF0YSA9ICIiOw0KICAgIHRoaXMuY29ubmVjdG5hbWUgPSAiIjsNCiAgICAvLyAyMDEzLTExLTI5IGNvbm5lY3Rpb24ub25jZSDsmLXshZjtjKjsuZguDQogICAgdGhpcy5jb25uZWN0aW9ub25jZSA9ICIiOw0KDQogICAgdGhpcy54cGF0aCA9ICIiOw0KICAgIHRoaXMuZXJyb3J4cGF0aCA9ICIiOw0KDQogICAgLy8gMjAxMy0wNC0yOCBwcmVzZXJ2ZVdoaXRlc3BhY2Ug7Ji17IWY7LKY66asDQogICAgdGhpcy5wcmVzZXJ2ZXdoaXRlc3BhY2UgPSAiMSI7DQogICAgdGhpcy5yZWJmaWxlcyA9IHt9Ow0KICAgIHRoaXMuc3VicmVwb3J0cyA9IHt9Ow0KICAgIHRoaXMucGFyYW1zID0ge307DQogICAgdGhpcy5jb25maWdwYXJhbXMgPSB7fTsNCiAgICB0aGlzLmh0dHBwYXJhbXMgPSB7fTsNCiAgICB0aGlzLmRhdGFzZXRzID0ge307DQogICAgdGhpcy5wcmludG9wdGlvbiA9ICIiOw0KICAgIHRoaXMuZXZlbnQgPSB7fTsNCiAgICB0aGlzLnBsdWdpbiA9IHt9Ow0KICAgIHRoaXMucGx1Z2luLnBhcmFtID0ge307DQogICAgLy8gMjAxMy0wNS0wOSBpcmFlDQogICAgdGhpcy5wbHVnaW4udHlwZSA9ICIiOw0KICAgIHRoaXMucGx1Z2luLmNvb2tpZSA9ICIiOw0KICAgIHRoaXMucGx1Z2luLndlYiA9IHt9Ow0KICAgIHRoaXMucGx1Z2luLndlYi5wYXJhbSA9IHt9Ow0KDQogICAgLy8gMjAxMC0wNy0yMg0KICAgIHRoaXMucHJpbnRpbmZvID0ge307DQogICAgdGhpcy5zYXZlaW5mbyA9IHt9Ow0KICAgIC8vIDIwMTAtMDktMDcNCiAgICB0aGlzLnRpdGxlID0gIiI7DQogICAgdGhpcy53aW4gPSBudWxsOw0KICAgIC8vIDIwMTMtMDctMjYNCiAgICB0aGlzLnVzZXJkZWZpbmVwYXJhbSA9IG51bGw7DQogICAgLy8gMjAxMy0wOC0wMiBpcmFlDQogICAgdGhpcy5lbmNvZGluZyA9ICIiOw0KICAgIHRoaXMucGF0aCA9ICIiOw0KICAgIHRoaXMuaHR0cG1ldGhvZCA9ICJwb3N0IjsNCiAgICB0aGlzLndpbmRvd3RpdGxlID0gIlJleHBlcnQgVmlld2VyIjsNCiAgICB0aGlzLnBhcmFtdHlwZSA9ICJzdHJpbmciOw0KDQogICAgLy8gMjAxNC0wNS0yNw0KICAgIHRoaXMuaHR0cGVuY29kaW5nID0gInV0Zi04LnVybGVuY29kZSI7DQogICAgdGhpcy51c2VyYWdlbnQgPSBuYXZpZ2F0b3IudXNlckFnZW50Ow0KDQogICAgLy8gMjAxNC0wNi0wMw0KICAgIHRoaXMuY2xlYXJwYXJhbWV0ZXIgPSAiMCI7DQoNCiAgICAvLyAyMDE0LTAzLTA1DQogICAgdGhpcy5lbmFibGV0aHJlYWQgPSAiMCI7DQoNCiAgICAvLyAyMDEzLTA1LTA5IGlyYWUNCiAgICB0aGlzLmV2ZW50LmluaXQgPSBudWxsOw0KICAgIHRoaXMuZXZlbnQuZmluaXNoZG9jdW1lbnQgPSBudWxsOw0KICAgIHRoaXMuZXZlbnQuZmluaXNocHJpbnQgPSBudWxsOw0KICAgIHRoaXMuZXZlbnQuZmluaXNocHJpbnRhbGwgPSBudWxsOw0KICAgIHRoaXMuZXZlbnQuZmluaXNocHJpbnRhbGxlYWNoID0gbnVsbDsNCiAgICB0aGlzLmV2ZW50LmZpbmlzaGV4cG9ydCA9IG51bGw7DQogICAgdGhpcy5ldmVudC5maW5pc2hwcmludHJlc3VsdCA9IG51bGw7DQogICAgdGhpcy5ldmVudC5idXR0b25wcmludGNsaWNrYmVmb3JlID0gbnVsbDsNCiAgICB0aGlzLmV2ZW50LmJ1dHRvbnByaW50Y2xpY2thZnRlciA9IG51bGw7DQogICAgdGhpcy5ldmVudC5idXR0b25leHBvcnRjbGlja2JlZm9yZSA9IG51bGw7DQogICAgdGhpcy5ldmVudC5idXR0b25leHBvcnRjbGlja2FmdGVyID0gbnVsbDsNCiAgICB0aGlzLmV2ZW50LmJ1dHRvbnJlZnJlc2hjbGlja2JlZm9yZSA9IG51bGw7DQogICAgdGhpcy5ldmVudC5idXR0b25yZWZyZXNoY2xpY2thZnRlciA9IG51bGw7DQogICAgdGhpcy5ldmVudC5idXR0b25leHBvcnR4bHNjbGlja2JlZm9yZSA9IG51bGw7DQogICAgdGhpcy5ldmVudC5idXR0b25leHBvcnR4bHNjbGlja2FmdGVyID0gbnVsbDsNCiAgICB0aGlzLmV2ZW50LmJ1dHRvbmV4cG9ydHBkZmNsaWNrYmVmb3JlID0gbnVsbDsNCiAgICB0aGlzLmV2ZW50LmJ1dHRvbmV4cG9ydHBkZmNsaWNrYWZ0ZXIgPSBudWxsOw0KICAgIHRoaXMuZXZlbnQuYnV0dG9uZXhwb3J0aHdwY2xpY2tiZWZvcmUgPSBudWxsOw0KICAgIHRoaXMuZXZlbnQuYnV0dG9uZXhwb3J0aHdwY2xpY2thZnRlciA9IG51bGw7DQogICAgdGhpcy5ldmVudC5jYW5jZWxwcmludCA9IG51bGw7DQogICAgdGhpcy5ldmVudC5idXR0b25jbG9zZXdpbmRvd2NsaWNrYmVmb3JlID0gbnVsbDsNCiAgICB0aGlzLmV2ZW50LmJ1dHRvbmNsb3Nld2luZG93Y2xpY2thZnRlciA9IG51bGw7DQogICAgdGhpcy5ldmVudC5wcmludHBhZ2UgPSBudWxsOw0KICAgIHRoaXMuZXZlbnQuY2FuY2VsZXhwb3J0ID0gbnVsbDsNCiAgICB0aGlzLmV2ZW50LmZpbmlzaHByaW50cmVzdWx0ID0gbnVsbDsNCiAgICB0aGlzLmV2ZW50LnJleHBlcnRlcnJvciA9IG51bGw7DQogICAgdGhpcy5ldmVudC5lcnJvcmV2ZW50ID0gbnVsbDsNCiAgICB0aGlzLmV2ZW50LmJlZm9yZXByaW50ID0gbnVsbDsNCiAgICAvLyAyMDE0LTA4LTI1IOy2lOqwgA0KICAgIHRoaXMuZXZlbnQuY2hlY2tlcnJvciA9IG51bGw7DQogICAgLy8gMjAxNC0wNC0yMiBvUmVwb3J0LmNvb2tpZSDstpTqsIAuDQogICAgdGhpcy5jb29raWUgPSAiIjsNCiAgICAvLyAyMDE0LTAzLTE5DQogICAgdGhpcy5ldmVudC5maW5pc2h1cGxvYWQgPSBudWxsOw0KDQogICAgdGhpcy5mb3JlZ3JvdW5kbGlzdCA9IG5ldyBBcnJheSgpOw0KICAgIHRoaXMuYmFja2dyb3VuZGxpc3QgPSBuZXcgQXJyYXkoKTsNCiAgICANCiAgICANCiAgICAvL2ZvcmVncm91bmQtc2V0dGluZw0KICAgIHJleF9QYXJhbVNldC5wcm90b3R5cGUuZm9yZWdyb3VuZCA9IGZ1bmN0aW9uKHR5cGUsIG9yaWVudGF0aW9uLCBwYXRoKSB7DQogICAgICAgIHRoaXMuZm9yZWdyb3VuZGxpc3QucHVzaCh7DQogICAgICAgICAgICB0eXBlIDogdHlwZSwNCiAgICAgICAgICAgIG9yaWVudGF0aW9uIDogb3JpZW50YXRpb24sDQogICAgICAgICAgICBwYXRoIDogcGF0aA0KICAgICAgICB9KTsNCiAgICB9Ow0KICAgIC8vIGJhY2tncm91bmQtc2V0dGluZw0KICAgIHJleF9QYXJhbVNldC5wcm90b3R5cGUuYmFja2dyb3VuZCA9IGZ1bmN0aW9uKHR5cGUsIG9yaWVudGF0aW9uLCBwYXRoKSB7DQogICAgICAgIHRoaXMuYmFja2dyb3VuZGxpc3QucHVzaCh7DQogICAgICAgICAgICB0eXBlIDogdHlwZSwNCiAgICAgICAgICAgIG9yaWVudGF0aW9uIDogb3JpZW50YXRpb24sDQogICAgICAgICAgICBwYXRoIDogcGF0aA0KICAgICAgICB9KTsNCiAgICB9Ow0KICAgIHJleF9QYXJhbVNldC5wcm90b3R5cGUucHVzaGNsZWFyID0gZnVuY3Rpb24oKSB7DQogICAgICAgIHJleF9nYVJlcG9ydHMgPSBuZXcgQXJyYXkoKTsNCiAgICAgICAgcmV4X2dhUmVwb3J0c0luZGV4ID0gMDsNCiAgICB9Ow0KICAgIHJleF9QYXJhbVNldC5wcm90b3R5cGUucHVzaCA9IGZ1bmN0aW9uKG9SZXBvcnQpIHsNCiAgICAgICAgcmV4X2dhUmVwb3J0cy5wdXNoKG9SZXBvcnQpOw0KICAgIH07DQogICAgcmV4X1BhcmFtU2V0LnByb3RvdHlwZS5yZWIgPSBmdW5jdGlvbihpZCkgew0KICAgICAgICBpZiAodGhpcy5yZWJmaWxlc1tpZF0gPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICB0aGlzLnJlYmZpbGVzW2lkXSA9IG5ldyByZXhfUmViRmlsZShpZCk7DQogICAgICAgIH0NCiAgICAgICAgdGhpcy5yZWJmaWxlc1tpZF0udmFsdWUgPSAiIjsNCiAgICAgICAgcmV0dXJuIHRoaXMucmViZmlsZXNbaWRdOw0KICAgIH07DQogICAgcmV4X1BhcmFtU2V0LnByb3RvdHlwZS5wYXJhbSA9IGZ1bmN0aW9uKGlkKSB7DQogICAgICAgIGlmICh0aGlzLnBhcmFtc1tpZF0gPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICB0aGlzLnBhcmFtc1tpZF0gPSB7fTsNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLnBhcmFtc1tpZF0udmFsdWUgPSAiIjsNCiAgICAgICAgcmV0dXJuIHRoaXMucGFyYW1zW2lkXTsNCiAgICB9Ow0KICAgIHJleF9QYXJhbVNldC5wcm90b3R5cGUuaHR0cHBhcmFtID0gZnVuY3Rpb24oaWQpIHsNCiAgICAgICAgaWYgKHRoaXMuaHR0cHBhcmFtc1tpZF0gPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICB0aGlzLmh0dHBwYXJhbXNbaWRdID0ge307DQogICAgICAgIH0NCiAgICAgICAgdGhpcy5odHRwcGFyYW1zW2lkXS52YWx1ZSA9ICIiOw0KICAgICAgICByZXR1cm4gdGhpcy5odHRwcGFyYW1zW2lkXTsNCiAgICB9Ow0KICAgIHJleF9QYXJhbVNldC5wcm90b3R5cGUuY29uZmlncGFyYW0gPSBmdW5jdGlvbihpZCkgew0KICAgICAgICBpZiAodGhpcy5jb25maWdwYXJhbXNbaWRdID09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgdGhpcy5jb25maWdwYXJhbXNbaWRdID0ge307DQogICAgICAgIH0NCiAgICAgICAgdGhpcy5jb25maWdwYXJhbXNbaWRdLnZhbHVlID0gIiI7DQogICAgICAgIHJldHVybiB0aGlzLmNvbmZpZ3BhcmFtc1tpZF07DQogICAgfTsNCiAgICByZXhfUGFyYW1TZXQucHJvdG90eXBlLnN1YiA9IGZ1bmN0aW9uKGlkKSB7DQogICAgICAgIGlmICh0aGlzLnN1YnJlcG9ydHNbaWRdID09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgdGhpcy5zdWJyZXBvcnRzW2lkXSA9IG5ldyByZXhfUmViU3ViUmVwb3J0KGlkKTsNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLnN1YnJlcG9ydHNbaWRdLnZhbHVlID0gIiI7DQogICAgICAgIHJldHVybiB0aGlzLnN1YnJlcG9ydHNbaWRdOw0KICAgIH07DQogICAgcmV4X1BhcmFtU2V0LnByb3RvdHlwZS5jb24gPSBmdW5jdGlvbihpZCkgew0KICAgICAgICBpZiAodGhpcy5zdWJyZXBvcnRzW2lkXSA9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIHRoaXMuc3VicmVwb3J0c1tpZF0gPSBuZXcgcmV4X1JlYlN1YlJlcG9ydChpZCk7DQogICAgICAgIH0NCiAgICAgICAgdGhpcy5zdWJyZXBvcnRzW2lkXS52YWx1ZSA9ICIiOw0KICAgICAgICByZXR1cm4gdGhpcy5zdWJyZXBvcnRzW2lkXTsNCiAgICB9Ow0KICAgIHJleF9QYXJhbVNldC5wcm90b3R5cGUuZGF0YXNldCA9IGZ1bmN0aW9uKGlkKSB7DQogICAgICAgIGlmICh0aGlzLmRhdGFzZXRzW2lkXSA9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIHRoaXMuZGF0YXNldHNbaWRdID0ge307DQogICAgICAgIH0NCiAgICAgICAgdGhpcy5kYXRhc2V0c1tpZF0udmFsdWUgPSAiIjsNCiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YXNldHNbaWRdOw0KICAgIH07DQogICAgcmV4X1BhcmFtU2V0LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICB2YXIgc2IgPSAiIjsNCiAgICAgICAgdmFyIGNvbiA9IG5ldyByZXhfUmViQ29ubmVjdGlvbigpOw0KICAgICAgICB2YXIgb1BhcmFtID0ge307DQogICAgICAgIHZhciByZWJmaWxlID0gbmV3IHJleF9SZWJGaWxlKCk7DQogICAgICAgIHNiICs9ICI8P3htbCB2ZXJzaW9uPScxLjAnIGVuY29kaW5nPSd1dGYtOCc|IjsNCiAgICAgICAgICAgIGZvciAoIHZhciBua2V5IGluIHJleF9nc1BsdWdpblBhcmFtKSB7DQogICAgICAgICAgICAgICAgc2IgKz0gIiAgICAgICAgICAgICAgPGNvbmZpZy1wYXJhbSBuYW1lPSciICsgbmtleSArICInPiIgKyByZXhfZ3NQbHVnaW5QYXJhbVtua2V5XSArICI8L2NvbmZpZy1wYXJhbT4iOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLy8gdXNlciBjb29raWUg7LaU6rCADQogICAgICAgICAgICBpZiAodGhpcy5jb29raWUgIT0gIiIgJiYgdGhpcy5jb29raWUgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgc2IgKz0gIjxjb25maWctcGFyYW0gbmFtZT0nY29va2llJz48IVtDREFUQVsiICsgdGhpcy5jb29raWUgKyAiXV0|IjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC8vIGFsZXJ0KHRoaXMucmViZmlsZXNbbmtleV0uc3VicmVwb3J0c1siQURPMiJdKTsNCiAgICAgICAgICAgIGlmICh0aGlzLnJlYmZpbGVzW25rZXldLnJwdG5hbWUgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgcmViZmlsZSA9IG5ldyByZXhfUmViRmlsZSgpOw0KICAgICAgICAgICAgICAgIHNNdWx0aVJlYiArPSByZWJmaWxlLnRvU3RyaW5nRmlsZSh0aGlzLnJlYmZpbGVzW25rZXldLnJwdG5hbWUsIHJlYmZpbGUudG9TdHJpbmdGaWVsZCh0aGlzLnJlYmZpbGVzW25rZXldLnBhcmFtcywgdGhpcy5wYXJhbXR5cGUpLCBzQ29ubiwgcmViZmlsZS50b1N0cmluZ0NvbmZpZ1BhcmFtKHRoaXMucmViZmlsZXNbbmtleV0uY29uZmlncGFyYW1zKSwgdGhpcy5jb29raWUpICsgIiI7DQogICAgICAgICAgICAgICAgaWYgKHRoaXMuZXhwb3J0c2VydmljZS5maWxlbmFtZSA9PSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZXhwb3J0c2VydmljZS5maWxlbmFtZSA9IHRoaXMucmViZmlsZXNbbmtleV0ucnB0bmFtZS5zdWJzdHIodGhpcy5yZWJmaWxlc1tua2V5XS5ycHRuYW1lLmxhc3RJbmRleE9mKCIvIikgKyAxKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0gLy8gZW5kIGZvcg0KICAgICAgICBpZiAoc011bHRpUmViID09IG51bGwgfHwgc011bHRpUmViID09ICIiKSB7DQogICAgICAgICAgICBzYiArPSBzUmViOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgc2IgKz0gc011bHRpUmViOw0KICAgICAgICB9DQogICAgICAgIHNiICs9ICI8L2ZpbGUtbGlzdD4iOw0KICAgICAgICBzQ29ubk1haW4gPSAiIjsNCiAgICAgICAgc0Nvbm5TdWIgPSAiIjsNCiAgICAgICAgc0Nvbm5NYWluICs9ICI8Y29ubmVjdGlvbi1saXN0PiI7DQogICAgICAgIGZvciAoIHZhciBua2V5IGluIHRoaXMuc3VicmVwb3J0cykgew0KICAgICAgICAgICAgaWYgKHRoaXMuc3VicmVwb3J0c1tua2V5XS5uYW1lc3BhY2UgPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgb1BhcmFtWyJuYW1lc3BhY2UiXSA9IG5rZXk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIG9QYXJhbVsibmFtZXNwYWNlIl0gPSB0aGlzLnN1YnJlcG9ydHNbbmtleV0ubmFtZXNwYWNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgb1BhcmFtWyJ0eXBlIl0gPSB0aGlzLnN1YnJlcG9ydHNbbmtleV0udHlwZTsNCiAgICAgICAgICAgIG9QYXJhbVsicGF0aCJdID0gdGhpcy5zdWJyZXBvcnRzW25rZXldLnBhdGg7DQogICAgICAgICAgICBvUGFyYW1bImh0dHBtZXRob2QiXSA9IHRoaXMuc3VicmVwb3J0c1tua2V5XS5odHRwbWV0aG9kOw0KICAgICAgICAgICAgb1BhcmFtWyJodHRwZW5jb2RpbmciXSA9IHRoaXMuc3VicmVwb3J0c1tua2V5XS5odHRwZW5jb2Rpbmc7DQogICAgICAgICAgICBvUGFyYW1bImRhdGEiXSA9IHRoaXMuc3VicmVwb3J0c1tua2V5XS5kYXRhOw0KICAgICAgICAgICAgb1BhcmFtWyJjb25uZWN0bmFtZSJdID0gdGhpcy5zdWJyZXBvcnRzW25rZXldLmNvbm5lY3RuYW1lOw0KICAgICAgICAgICAgb1BhcmFtWyJjb25uZWN0aW9ub25jZSJdID0gdGhpcy5zdWJyZXBvcnRzW25rZXldLmNvbm5lY3Rpb25vbmNlOw0KICAgICAgICAgICAgb1BhcmFtWyJkYXRhdHlwZSJdID0gdGhpcy5zdWJyZXBvcnRzW25rZXldLmRhdGF0eXBlOw0KICAgICAgICAgICAgb1BhcmFtWyJkYXRhaW5kZXgiXSA9IHRoaXMuc3VicmVwb3J0c1tua2V5XS5kYXRhaW5kZXg7DQogICAgICAgICAgICBvUGFyYW1bInhwYXRoIl0gPSB0aGlzLnN1YnJlcG9ydHNbbmtleV0ueHBhdGg7DQogICAgICAgICAgICBvUGFyYW1bImVycm9yeHBhdGgiXSA9IHRoaXMuc3VicmVwb3J0c1tua2V5XS5lcnJvcnhwYXRoOw0KICAgICAgICAgICAgb1BhcmFtWyJlbmNvZGluZyJdID0gdGhpcy5zdWJyZXBvcnRzW25rZXldLmVuY29kaW5nOw0KICAgICAgICAgICAgLy8gYWRkIGxvZw0KICAgICAgICAgICAgb1BhcmFtWyJycHRuYW1lIl0gPSB0aGlzLnJwdG5hbWU7DQogICAgICAgICAgICBjb24gPSBuZXcgcmV4X1JlYkNvbm5lY3Rpb24oKTsNCiAgICAgICAgICAgIHNDb25uU3ViICs9IGNvbi50b1N0cmluZyhvUGFyYW0sIHRoaXMuc3VicmVwb3J0c1tua2V5XS5odHRwcGFyYW1zLCB0aGlzLnN1YnJlcG9ydHNbbmtleV0uY29uZmlncGFyYW1zLCB0aGlzLnN1YnJlcG9ydHNbbmtleV0uZGF0YXNldHMpOw0KICAgICAgICB9DQogICAgICAgIGlmIChzQ29ublN1YiA9PSAiIikgew0KICAgICAgICAgICAgb1BhcmFtWyJ0eXBlIl0gPSB0aGlzLnR5cGU7IC8vIGh0dHAsIGZpbGUsIG1lbW8NCiAgICAgICAgICAgIG9QYXJhbVsibmFtZXNwYWNlIl0gPSB0aGlzLm5hbWVzcGFjZTsNCiAgICAgICAgICAgIG9QYXJhbVsicGF0aCJdID0gdGhpcy5wYXRoOw0KICAgICAgICAgICAgb1BhcmFtWyJodHRwbWV0aG9kIl0gPSB0aGlzLmh0dHBtZXRob2Q7DQogICAgICAgICAgICBvUGFyYW1bImh0dHBlbmNvZGluZyJdID0gdGhpcy5odHRwZW5jb2Rpbmc7DQogICAgICAgICAgICBvUGFyYW1bImRhdGEiXSA9IHRoaXMuZGF0YTsNCiAgICAgICAgICAgIG9QYXJhbVsiY29ubmVjdG5hbWUiXSA9IHRoaXMuY29ubmVjdG5hbWU7DQogICAgICAgICAgICBvUGFyYW1bImNvbm5lY3Rpb25vbmNlIl0gPSB0aGlzLmNvbm5lY3Rpb25vbmNlOw0KICAgICAgICAgICAgb1BhcmFtWyJwcmVzZXJ2ZXdoaXRlc3BhY2UiXSA9IHRoaXMucHJlc2VydmV3aGl0ZXNwYWNlOw0KICAgICAgICAgICAgb1BhcmFtWyJkYXRhdHlwZSJdID0gdGhpcy5kYXRhdHlwZTsNCiAgICAgICAgICAgIG9QYXJhbVsiZGF0YWluZGV4Il0gPSB0aGlzLmRhdGFpbmRleDsNCiAgICAgICAgICAgIG9QYXJhbVsieHBhdGgiXSA9IHRoaXMueHBhdGg7DQogICAgICAgICAgICBvUGFyYW1bImVycm9yeHBhdGgiXSA9IHRoaXMuZXJyb3J4cGF0aDsNCiAgICAgICAgICAgIG9QYXJhbVsiZW5jb2RpbmciXSA9IHRoaXMuZW5jb2Rpbmc7DQogICAgICAgICAgICAvLyBhZGQgbG9nDQogICAgICAgICAgICBvUGFyYW1bInJwdG5hbWUiXSA9IHRoaXMucnB0bmFtZTsNCiAgICAgICAgICAgIG9QYXJhbVsiY29va2llIl0gPSB0aGlzLmNvb2tpZTsNCiAgICAgICAgICAgIHNDb25uTWFpbiArPSBjb24udG9TdHJpbmcob1BhcmFtLCB0aGlzLmh0dHBwYXJhbXMsIHRoaXMuY29uZmlncGFyYW1zLCB0aGlzLmRhdGFzZXRzKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHNDb25uTWFpbiArPSBzQ29ublN1YjsNCiAgICAgICAgfQ0KICAgICAgICBzQ29ubk1haW4gKz0gIjwvY29ubmVjdGlvbi1saXN0PiI7DQogICAgICAgIGlmIChzQ29ubiA9PSAiIikgew0KICAgICAgICAgICAgLy8gMjAxMS0wNi0xMA0KICAgICAgICAgICAgaWYgKHRoaXMudHlwZSAhPSAiYWRvIikgew0KICAgICAgICAgICAgICAgIHNiICs9IHNDb25uTWFpbjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBzYiArPSByZWJmaWxlLnRvU3RyaW5nRmllbGQodGhpcy5wYXJhbXMsIHRoaXMucGFyYW10eXBlKTsNCiAgICAgICAgc2IgKz0gIjxwbHVnaW4tbGlzdD4iOw0KICAgICAgICBpZiAodGhpcy5wbHVnaW4udHlwZSAhPSAiIikgew0KICAgICAgICAgICAgc2IgKz0gIiA8cGx1Z2luIHR5cGU9JyIgKyB0aGlzLnBsdWdpbi50eXBlICsgIic|PiI7DQogICAgICAgIHNiICs9ICI8b29mIHZlcnNpb24gPSczLjAnPiI7DQogICAgICAgIGlmICh0aGlzLnRpdGxlICE9ICIiKSB7DQogICAgICAgICAgICBzYiArPSAiPGRvY3VtZW50IHRpdGxlPSciICsgdGhpcy50aXRsZSArICInIGVuYWJsZS10aHJlYWQ9JyIgKyB0aGlzLmVuYWJsZXRocmVhZCArICInPiI7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBzYiArPSAiPGRvY3VtZW50IHRpdGxlPSdyZXBvcnQnIGVuYWJsZS10aHJlYWQ9JyIgKyB0aGlzLmVuYWJsZXRocmVhZCArICInPiI7DQogICAgICAgIH0NCiAgICAgICAgLy8gc2IgKz0gIjxkb2N1bWVudCBlbmFibGUtdGhyZWFkPScxJz4iOw0KICAgICAgICAvLyBzYiArPSAiPGRvY3VtZW50PiI7DQogICAgICAgIGlmICh0aGlzLnR5cGUgPT0gdW5kZWZpbmVkKQ0KICAgICAgICAgICAgdGhpcy50eXBlID0gImh0dHAiOw0KICAgICAgICBzYiArPSAiPGZpbGUtbGlzdD4iOw0KICAgICAgICB2YXIgc1JlYiA9ICIiOw0KICAgICAgICB2YXIgc011bHRpUmViID0gIiI7DQogICAgICAgIGlmICh0aGlzLnJwdG5hbWUgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBzUmViICs9IHJlYmZpbGUudG9TdHJpbmdGaWxlKHRoaXMucnB0bmFtZSwgIiIsICIiLCAiIiwgdGhpcy5jb29raWUpICsgIiI7DQogICAgICAgICAgICBpZiAodGhpcy5leHBvcnRzZXJ2aWNlLmZpbGVuYW1lID09IG51bGwpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmV4cG9ydHNlcnZpY2UuZmlsZW5hbWUgPSB0aGlzLnJwdG5hbWUuc3Vic3RyKHRoaXMucnB0bmFtZS5sYXN0SW5kZXhPZigiLyIpICsgMSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgdmFyIHNDb25uTWFpbiA9ICIiOw0KICAgICAgICB2YXIgc0Nvbm5TdWIgPSAiIjsNCiAgICAgICAgdmFyIHNDb25uID0gIiI7DQogICAgICAgIGZvciAoIHZhciBua2V5IGluIHRoaXMucmViZmlsZXMpIHsNCiAgICAgICAgICAgIHNDb25uID0gIiI7DQogICAgICAgICAgICBmb3IgKCB2YXIga2V5IGluIHRoaXMucmViZmlsZXNbbmtleV0uc3VicmVwb3J0cykgew0KICAgICAgICAgICAgICAgIGlmIChrZXkgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnJlYmZpbGVzW25rZXldLnN1YihrZXkpLm5hbWVzcGFjZSA9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9QYXJhbVsibmFtZXNwYWNlIl0gPSBrZXk7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICBvUGFyYW1bIm5hbWVzcGFjZSJdID0gdGhpcy5yZWJmaWxlc1tua2V5XS5zdWIoa2V5KS5uYW1lc3BhY2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgb1BhcmFtWyJ0eXBlIl0gPSB0aGlzLnJlYmZpbGVzW25rZXldLnN1YihrZXkpLnR5cGU7DQogICAgICAgICAgICAgICAgICAgIG9QYXJhbVsicGF0aCJdID0gdGhpcy5yZWJmaWxlc1tua2V5XS5zdWIoa2V5KS5wYXRoOw0KICAgICAgICAgICAgICAgICAgICBvUGFyYW1bImh0dHBtZXRob2QiXSA9IHRoaXMucmViZmlsZXNbbmtleV0uc3ViKGtleSkuaHR0cG1ldGhvZDsNCiAgICAgICAgICAgICAgICAgICAgb1BhcmFtWyJodHRwZW5jb2RpbmciXSA9IHRoaXMucmViZmlsZXNbbmtleV0uc3ViKGtleSkuaHR0cGVuY29kaW5nOw0KICAgICAgICAgICAgICAgICAgICBvUGFyYW1bImRhdGEiXSA9IHRoaXMucmViZmlsZXNbbmtleV0uc3ViKGtleSkuZGF0YTsNCiAgICAgICAgICAgICAgICAgICAgb1BhcmFtWyJjb25uZWN0bmFtZSJdID0gdGhpcy5yZWJmaWxlc1tua2V5XS5zdWIoa2V5KS5jb25uZWN0bmFtZTsNCiAgICAgICAgICAgICAgICAgICAgb1BhcmFtWyJjb25uZWN0aW9ub25jZSJdID0gdGhpcy5yZWJmaWxlc1tua2V5XS5zdWIoa2V5KS5jb25uZWN0aW9ub25jZTsNCiAgICAgICAgICAgICAgICAgICAgb1BhcmFtWyJkYXRhdHlwZSJdID0gdGhpcy5yZWJmaWxlc1tua2V5XS5zdWIoa2V5KS5kYXRhdHlwZTsNCiAgICAgICAgICAgICAgICAgICAgb1BhcmFtWyJkYXRhaW5kZXgiXSA9IHRoaXMucmViZmlsZXNbbmtleV0uc3ViKGtleSkuZGF0YWluZGV4Ow0KICAgICAgICAgICAgICAgICAgICBvUGFyYW1bInhwYXRoIl0gPSB0aGlzLnJlYmZpbGVzW25rZXldLnN1YihrZXkpLnhwYXRoOw0KICAgICAgICAgICAgICAgICAgICBvUGFyYW1bImVycm9yeHBhdGgiXSA9IHRoaXMucmViZmlsZXNbbmtleV0uc3ViKGtleSkuZXJyb3J4cGF0aDsNCiAgICAgICAgICAgICAgICAgICAgb1BhcmFtWyJlbmNvZGluZyJdID0gdGhpcy5yZWJmaWxlc1tua2V5XS5zdWIoa2V5KS5lbmNvZGluZzsNCiAgICAgICAgICAgICAgICAgICAgb1BhcmFtWyJycHRuYW1lIl0gPSB0aGlzLnJlYmZpbGVzW25rZXldLnJwdG5hbWU7DQogICAgICAgICAgICAgICAgICAgIG9QYXJhbVsicHJlc2VydmV3aGl0ZXNwYWNlIl0gPSB0aGlzLnJlYmZpbGVzW25rZXldLnN1YihrZXkpLnByZXNlcnZld2hpdGVzcGFjZTsNCiAgICAgICAgICAgICAgICAgICAgb1BhcmFtWyJjb29raWUiXSA9IHRoaXMuY29va2llOw0KICAgICAgICAgICAgICAgICAgICBjb24gPSBuZXcgcmV4X1JlYkNvbm5lY3Rpb24oKTsNCiAgICAgICAgICAgICAgICAgICAgc0Nvbm4gKz0gY29uLnRvU3RyaW5nKG9QYXJhbSwgdGhpcy5yZWJmaWxlc1tua2V5XS5zdWIoa2V5KS5odHRwcGFyYW1zLCB0aGlzLnJlYmZpbGVzW25rZXldLnN1YihrZXkpLmNvbmZpZ3BhcmFtcywgdGhpcy5yZWJmaWxlc1tua2V5XS5zdWIoa2V5KS5kYXRhc2V0cyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKHNDb25uID09ICIiKSB7DQogICAgICAgICAgICAgICAgLy8gMjAxMS0wNi0xMA0KICAgICAgICAgICAgICAgIGlmICh0aGlzLnR5cGUgIT0gImFkbyIpIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gaWYgKHRoaXMucmViZmlsZXNbbmtleV0uY29ubmVjdG5hbWUgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnJlYmZpbGVzW25rZXldLmNvbm5lY3RuYW1lICE9IHVuZGVmaW5lZCAmJiB0aGlzLnJlYmZpbGVzW25rZXldLnR5cGUgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBvUGFyYW1bInR5cGUiXSA9IHRoaXMucmViZmlsZXNbbmtleV0udHlwZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9QYXJhbVsibmFtZXNwYWNlIl0gPSB0aGlzLnJlYmZpbGVzW25rZXldLm5hbWVzcGFjZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9QYXJhbVsicGF0aCJdID0gdGhpcy5yZWJmaWxlc1tua2V5XS5wYXRoOw0KICAgICAgICAgICAgICAgICAgICAgICAgb1BhcmFtWyJodHRwbWV0aG9kIl0gPSB0aGlzLnJlYmZpbGVzW25rZXldLmh0dHBtZXRob2Q7DQogICAgICAgICAgICAgICAgICAgICAgICBvUGFyYW1bImh0dHBlbmNvZGluZyJdID0gdGhpcy5yZWJmaWxlc1tua2V5XS5odHRwZW5jb2Rpbmc7DQogICAgICAgICAgICAgICAgICAgICAgICBvUGFyYW1bImRhdGEiXSA9IHRoaXMucmViZmlsZXNbbmtleV0uZGF0YTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9QYXJhbVsiY29ubmVjdG5hbWUiXSA9IHRoaXMucmViZmlsZXNbbmtleV0uY29ubmVjdG5hbWU7DQogICAgICAgICAgICAgICAgICAgICAgICBvUGFyYW1bImNvbm5lY3Rpb25vbmNlIl0gPSB0aGlzLnJlYmZpbGVzW25rZXldLmNvbm5lY3Rpb25vbmNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgb1BhcmFtWyJwcmVzZXJ2ZXdoaXRlc3BhY2UiXSA9IHRoaXMucmViZmlsZXNbbmtleV0ucHJlc2VydmV3aGl0ZXNwYWNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgb1BhcmFtWyJkYXRhdHlwZSJdID0gdGhpcy5yZWJmaWxlc1tua2V5XS5kYXRhdHlwZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9QYXJhbVsiZGF0YWluZGV4Il0gPSB0aGlzLnJlYmZpbGVzW25rZXldLmRhdGFpbmRleDsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9QYXJhbVsieHBhdGgiXSA9IHRoaXMucmViZmlsZXNbbmtleV0ueHBhdGg7DQogICAgICAgICAgICAgICAgICAgICAgICBvUGFyYW1bImVycm9yeHBhdGgiXSA9IHRoaXMucmViZmlsZXNbbmtleV0uZXJyb3J4cGF0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9QYXJhbVsiZW5jb2RpbmciXSA9IHRoaXMucmViZmlsZXNbbmtleV0uZW5jb2Rpbmc7DQogICAgICAgICAgICAgICAgICAgICAgICBvUGFyYW1bInJwdG5hbWUiXSA9IHRoaXMucmViZmlsZXNbbmtleV0ucnB0bmFtZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbiA9IG5ldyByZXhfUmViQ29ubmVjdGlvbigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc0Nvbm4gKz0gY29uLnRvU3RyaW5nKG9QYXJhbSwgdGhpcy5yZWJmaWxlc1tua2V5XS5odHRwcGFyYW1zLCB0aGlzLnJlYmZpbGVzW25rZXldLmNvbmZpZ3BhcmFtcywgdGhpcy5yZWJmaWxlc1tua2V5XS5kYXRhc2V0cyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIC8vIDIwMTQtMDItMDQg7LaU6rCALiDrpqztj6ztirjrpbwg66mA7Yuw66GcIOyCrOyaqe2VoCDqsr3smrAg7Luo64Sl7IWYIOuLpOykke2ZlCDsspjrpqwuDQogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnJlYmZpbGVzW25rZXldLmNvbm5lY3RuYW1lICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgb1BhcmFtWyJjb25uZWN0bmFtZSJdID0gdGhpcy5yZWJmaWxlc1tua2V5XS5jb25uZWN0bmFtZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9QYXJhbVsicnB0bmFtZSJdID0gdGhpcy5yZWJmaWxlc1tua2V5XS5ycHRuYW1lOw0KICAgICAgICAgICAgICAgICAgICAgICAgb1BhcmFtWyJodHRwbWV0aG9kIl0gPSB0aGlzLnJlYmZpbGVzW25rZXldLmh0dHBtZXRob2Q7DQogICAgICAgICAgICAgICAgICAgICAgICBvUGFyYW1bImh0dHBlbmNvZGluZyJdID0gdGhpcy5yZWJmaWxlc1tua2V5XS5odHRwZW5jb2Rpbmc7DQogICAgICAgICAgICAgICAgICAgICAgICBzQ29ubiArPSBjb24udG9TdHJpbmcob1BhcmFtLCB0aGlzLnJlYmZpbGVzW25rZXldLmh0dHBwYXJhbXMsIHRoaXMucmViZmlsZXNbbmtleV0uY29uZmlncGFyYW1zLCB0aGlzLnJlYmZpbGVzW25rZXldLmRhdGFzZXRzKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAvLyB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKHNDb25uICE9ICIiKSB7DQogICAgICAgICAgICAgICAgc0Nvbm4gPSAiPGNvbm5lY3Rpb24tbGlzdD4iICsgc0Nvbm4gKyAiPC9jb25uZWN0aW9uLWxpc3Q|IjsNCiAgICAgICAgICAgICAgICAgICAgc0h0dHBQYXJhbXMgKz0gIjwvaHR0cC1wYXJhbS1saXN0PiI7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBpZiAoc0h0dHBQYXJhbXMgIT0gIiIpIHsNCiAgICAgICAgICAgICAgICAgICAgc0h0dHBQYXJhbXMgPSAiPGh0dHAtcGFyYW0tbGlzdD4iICsgc0h0dHBQYXJhbXMgKyAiPC9odHRwLXBhcmFtLWxpc3Q|IDApIHsNCiAgICAgICAgdGhpcy5zYXZldXBsb2FkID0ge307DQogICAgICAgIHRoaXMuc2F2ZXVwbG9hZC5kaWFsb2cgPSBhcmd1bWVudHNbMF07DQogICAgICAgIHRoaXMuc2F2ZXVwbG9hZC5maWxldHlwZSA9IGFyZ3VtZW50c1sxXTsNCiAgICAgICAgdGhpcy5zYXZldXBsb2FkLmZpbGVOYW1lID0gYXJndW1lbnRzWzJdOw0KICAgICAgICB0aGlzLnNhdmV1cGxvYWQuc3RhcnRwYWdlID0gYXJndW1lbnRzWzNdOw0KICAgICAgICB0aGlzLnNhdmV1cGxvYWQuZW5kcGFnZSA9IGFyZ3VtZW50c1s0XTsNCiAgICAgICAgdGhpcy5zYXZldXBsb2FkLk9wdGlvbiA9IGFyZ3VtZW50c1s1XTsNCiAgICAgICAgdGhpcy5zYXZldXBsb2FkLnVwbG9hZHVybCA9IGFyZ3VtZW50c1s2XTsNCiAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLnNhdmV1cGxvYWQgPSB7fTsNCiAgICAgICAgdGhpcy5zYXZldXBsb2FkLmRpYWxvZyA9IHRoaXMuc2F2ZWluZm8uZGlhbG9nOw0KICAgICAgICB0aGlzLnNhdmV1cGxvYWQuZmlsZXR5cGUgPSB0aGlzLnNhdmVpbmZvLmZpbGV0eXBlOw0KICAgICAgICB0aGlzLnNhdmV1cGxvYWQuZmlsZU5hbWUgPSB0aGlzLnNhdmVpbmZvLmZpbGVOYW1lOw0KICAgICAgICB0aGlzLnNhdmV1cGxvYWQuc3RhcnRwYWdlID0gdGhpcy5zYXZlaW5mby5zdGFydHBhZ2U7DQogICAgICAgIHRoaXMuc2F2ZXVwbG9hZC5lbmRwYWdlID0gdGhpcy5zYXZlaW5mby5lbmRwYWdlOw0KICAgICAgICB0aGlzLnNhdmV1cGxvYWQuT3B0aW9uID0gdGhpcy5zYXZlaW5mby5PcHRpb247DQogICAgICAgIHRoaXMuc2F2ZXVwbG9hZC51cGxvYWR1cmwgPSB0aGlzLnNhdmVpbmZvLnVwbG9hZHVybDsNCiAgICB9DQogICAgdmFyIG9BZ2VudCA9IG5ldyByZXhfQWdlbnQoKTsNCiAgICBpZiAob0FnZW50LmlzSUUpIHsNCiAgICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJyZXhfaWZybVJleFByZXZpZXciKSA9PSBudWxsKSB7DQogICAgICAgICAgICB2YXIgc0hUTUwgPSAiPGlmcmFtZSBpZD0ncmV4X2lmcm1SZXhQcmV2aWV3JyBzcmM9JyIgKyByZXhfZ3NQcmVWaWV3VVJMICsgIj9pZD0iICsgdGhpcy5pZCArICInIHdpZHRoPScwJyBoZWlnaHQ9JzAnIGZyYW1lYm9yZGVyPScwJz48L2lmcmFtZT4iOw0KICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5pbnNlcnRBZGphY2VudEhUTUwoImJlZm9yZUVuZCIsIHNIVE1MKTsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJyZXhfaWZybVJleFByZXZpZXciKS5zcmMgPSByZXhfZ3NQcmVWaWV3VVJMICsgIj9pZD0iICsgdGhpcy5pZDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJyZXhfaWZybVJleFByZXZpZXciKS5zcmMgPSByZXhfZ3NQcmVWaWV3VVJMICsgIj9pZD0iICsgdGhpcy5pZDsNCiAgICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmV4X2lmcm1SZXhQcmV2aWV3IikgPT0gbnVsbCkgew0KICAgICAgICAgICAgdmFyIHNIVE1MID0gIjxpZnJhbWUgaWQ9J3JleF9pZnJtUmV4UHJldmlldycgc3JjPSciICsgcmV4X2dzUHJlVmlld1VSTCArICI|IjsNCiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuaW5zZXJ0QWRqYWNlbnRIVE1MKCJiZWZvcmVFbmQiLCBzSFRNTCk7DQogICAgICAgICAgICAvLyBkb2N1bWVudC5ib2R5LmlubmVySFRNTCArPSBzSFRNTDsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJyZXhfaWZybVJleFByZXZpZXciKS5jb250ZW50V2luZG93LmxvY2F0aW9uLmhyZWYgPSByZXhfZ3NQcmVWaWV3VVJMICsgIj9pZD0iICsgdGhpcy5pZDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJyZXhfaWZybVJleFByZXZpZXciKS5jb250ZW50V2luZG93LmxvY2F0aW9uLmhyZWYgPSByZXhfZ3NQcmVWaWV3VVJMICsgIj9pZD0iICsgdGhpcy5pZDsNCiAgICAgICAgfQ0KICAgIH0NCn07DQoNCi8vIDIwMTMtMTEtMjIg7LaU6rCAIOyggOyepSDtm4Qg7JeF66Gc65OcLg0KcmV4X1BhcmFtU2V0LnByb3RvdHlwZS5zYXZldXBsb2FkID0gZnVuY3Rpb24oKSB7DQogICAgdGhpcy5vcGVudHlwZSA9ICJzYXZldXBsb2FkIjsNCiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA|aWQ9IiArIHRoaXMuaWQ7DQogICAgICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgICAvLyB3aW5kb3cub3BlbihyZXhfZ3NQcmVWaWV3VVJMICsgIj9pZD0iICsgdGhpcy5pZCwgIiIsDQogICAgICAgIC8vICJjZW50ZXI9eWVzLHNjcm9sbGJhcnM9bm8sc3RhdHVzPW5vLHRvb2xiYXI9bm8scmVzaXphYmxlPTAsbG9jYXRpb249bm8sbWVudT1ubywNCiAgICAgICAgLy8gbGVmdD0xMDAwLCB0b3A9MTAwMCwgd2lkdGg9MTAsaGVpZ2h0PTEwIik7DQogICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmV4X2lmcm1SZXhQcmV2aWV3IikgPT0gbnVsbCkgew0KICAgICAgICAgICAgdmFyIHNIVE1MID0gIjxpZnJhbWUgaWQ9J3JleF9pZnJtUmV4UHJldmlldycgc3JjPSciICsgcmV4X2dzUHJlVmlld1VSTCArICI|aWQ9IiArIHRoaXMuaWQ7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmV4X2lmcm1SZXhQcmV2aWV3IikuY29udGVudFdpbmRvdy5sb2NhdGlvbi5ocmVmID0gcmV4X2dzUHJlVmlld1VSTCArICI|IjsNCiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuaW5zZXJ0QWRqYWNlbnRIVE1MKCJiZWZvcmVFbmQiLCBzSFRNTCk7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmV4X2lmcm1SZXhQcmV2aWV3IikuY29udGVudFdpbmRvdy5sb2NhdGlvbi5ocmVmID0gcmV4X2dzUHJlVmlld1VSTCArICI|length|aWQ9IiArIHRoaXMuaWQ7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmV4X2lmcm1SZXhQcmV2aWV3Iikuc3JjID0gcmV4X2dzUHJlVmlld1VSTCArICI|IjsNCiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuaW5zZXJ0QWRqYWNlbnRIVE1MKCJiZWZvcmVFbmQiLCBzSFRNTCk7DQogICAgICAgICAgICAvLyBkb2N1bWVudC5ib2R5LmlubmVySFRNTCArPSBzSFRNTDsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJyZXhfaWZybVJleFByZXZpZXciKS5jb250ZW50V2luZG93LmxvY2F0aW9uLmhyZWYgPSByZXhfZ3NQcmVWaWV3VVJMICsgIj9pZD0iICsgdGhpcy5pZDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJyZXhfaWZybVJleFByZXZpZXciKS5jb250ZW50V2luZG93LmxvY2F0aW9uLmhyZWYgPSByZXhfZ3NQcmVWaWV3VVJMICsgIj9pZD0iICsgdGhpcy5pZDsNCiAgICAgICAgfQ0KICAgIH0NCn07DQoNCi8vIDIwMTAtMDctMjINCnJleF9QYXJhbVNldC5wcm90b3R5cGUucHJpbnRkaXJlY3RhbGwgPSBmdW5jdGlvbigpIHsNCiAgICAvLyByZXhfZ2FSZXBvcnRzLnJldmVyc2UoKTsNCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJleF9nYVJlcG9ydHMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgcmV4X2dhUmVwb3J0c1tpXS5vcGVudHlwZSA9ICJwcmludGRpcmVjdCI7DQogICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgcmV4X2dhUmVwb3J0c1tpXS5wcmludGluZm8gPSB7fTsNCiAgICAgICAgICAgIHJleF9nYVJlcG9ydHNbaV0ucHJpbnRpbmZvLnByaW50bmFtZSA9IGFyZ3VtZW50c1swXTsNCiAgICAgICAgICAgIHJleF9nYVJlcG9ydHNbaV0ucHJpbnRpbmZvLnRyYXlpZCA9IGFyZ3VtZW50c1sxXTsNCiAgICAgICAgICAgIHJleF9nYVJlcG9ydHNbaV0ucHJpbnRpbmZvLnN0YXJ0cGFnZSA9IGFyZ3VtZW50c1syXTsNCiAgICAgICAgICAgIHJleF9nYVJlcG9ydHNbaV0ucHJpbnRpbmZvLmVuZHBhZ2UgPSBhcmd1bWVudHNbM107DQogICAgICAgICAgICByZXhfZ2FSZXBvcnRzW2ldLnByaW50aW5mby5jb3B5Y291bnQgPSBhcmd1bWVudHNbNF07DQogICAgICAgICAgICByZXhfZ2FSZXBvcnRzW2ldLnByaW50aW5mby5PcHRpb24gPSBhcmd1bWVudHNbNV07DQogICAgICAgIH0NCiAgICAgICAgaWYgKHRoaXMuZXZlbnQuZmluaXNocHJpbnRkaXJlY3RhbGxlYWNoICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgcmV4X2dhUmVwb3J0c1tpXS5ldmVudC5maW5pc2hwcmludGRpcmVjdGFsbGVhY2ggPSB0aGlzLmV2ZW50LmZpbmlzaHByaW50ZGlyZWN0YWxsZWFjaDsNCiAgICAgICAgfQ0KICAgICAgICBpZiAodGhpcy5ldmVudC5maW5pc2hwcmludGRpcmVjdGFsbCAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIHJleF9nYVJlcG9ydHNbaV0uZXZlbnQuZmluaXNocHJpbnRkaXJlY3RhbGwgPSB0aGlzLmV2ZW50LmZpbmlzaHByaW50ZGlyZWN0YWxsOw0KICAgICAgICB9DQogICAgfQ0KICAgIHJleF9QcmludERpcmVjdEFsbEV2ZW50KCIiLCAiIiwgIiIpOw0KfTsNCg0KZnVuY3Rpb24gcmV4X1ByaW50RGlyZWN0QWxsRXZlbnQob1JleEN0bCwgc0V2ZW50LCBvQXJncykgew0KICAgIHZhciBvUmVwb3J0Ow0KICAgIGlmIChyZXhfZ2FSZXBvcnRzSW5kZXggPiAwKSB7DQogICAgICAgIG9SZXBvcnQgPSByZXhfZ2FSZXBvcnRzW3JleF9nYVJlcG9ydHNJbmRleCAtIDFdOw0KICAgICAgICBpZiAob1JlcG9ydC5ldmVudC5maW5pc2hwcmludGRpcmVjdGFsbGVhY2ggIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBvUmVwb3J0LmV2ZW50LmZpbmlzaHByaW50ZGlyZWN0YWxsZWFjaChvUmV4Q3RsLCAiZmluaXNocHJpbnRkaXJlY3RhbGxlYWNoIiwgew0KICAgICAgICAgICAgICAgICJyZXBvcnQiIDogb1JlcG9ydA0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICB9DQogICAgaWYgKHJleF9nYVJlcG9ydHMubGVuZ3RoID4gMCAmJiByZXhfZ2FSZXBvcnRzLmxlbmd0aCA|IDApIHsNCiAgICAgICAgb1JlcG9ydCA9IHJleF9nYVJlcG9ydHNbcmV4X2dhUmVwb3J0c0luZGV4IC0gMV07DQogICAgICAgIGlmIChvUmVwb3J0LmV2ZW50LmZpbmlzaHByaW50YWxsZWFjaCAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIG9SZXBvcnQuZXZlbnQuZmluaXNocHJpbnRhbGxlYWNoKG9SZXhDdGwsICJmaW5pc2hwcmludGFsbGVhY2giLCB7DQogICAgICAgICAgICAgICAgInJlcG9ydCIgOiBvUmVwb3J0DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICBpZiAocmV4X2dhUmVwb3J0cy5sZW5ndGggPiAwICYmIHJleF9nYVJlcG9ydHMubGVuZ3RoID4gcmV4X2dhUmVwb3J0c0luZGV4KSB7DQogICAgICAgIG9SZXBvcnQgPSByZXhfZ2FSZXBvcnRzW3JleF9nYVJlcG9ydHNJbmRleF07DQogICAgICAgIGlmIChvUmVwb3J0LmV2ZW50LmJlZm9yZXByaW50YWxsZWFjaCAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIHZhciBvVG1wUmVwb3J0ID0gb1JlcG9ydC5ldmVudC5iZWZvcmVwcmludGFsbGVhY2gob1JleEN0bCwgImJlZm9yZXByaW50YWxsZWFjaCIsIHsNCiAgICAgICAgICAgICAgICAicmVwb3J0IiA6IG9SZXBvcnQNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgaWYgKG9UbXBSZXBvcnQgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgIG9SZXBvcnQgPSBvVG1wUmVwb3J0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIG9SZXBvcnQuZXZlbnQuZmluaXNocHJpbnQgPSByZXhfUHJpbnRBbGxFdmVudDsNCiAgICAgICAgb1JlcG9ydC5wcmludCgpOw0KICAgICAgICByZXhfZ2FSZXBvcnRzSW5kZXgrKzsNCiAgICB9IGVsc2Ugew0KICAgICAgICBvUmVwb3J0ID0gcmV4X2dhUmVwb3J0c1tyZXhfZ2FSZXBvcnRzSW5kZXggLSAxXTsNCiAgICAgICAgaWYgKG9SZXBvcnQuZXZlbnQuZmluaXNocHJpbnRhbGwgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBvUmVwb3J0LmV2ZW50LmZpbmlzaHByaW50YWxsKG9SZXhDdGwsICJmaW5pc2hwcmludGFsbCIsIHsNCiAgICAgICAgICAgICAgICAicmVwb3J0cyIgOiByZXhfZ2FSZXBvcnRzDQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgICByZXhfZ2FSZXBvcnRzID0gbmV3IEFycmF5KCk7DQogICAgICAgIHJleF9nYVJlcG9ydHNJbmRleCA9IDA7DQogICAgfQ0KfQ0KDQpyZXhfUGFyYW1TZXQucHJvdG90eXBlLnByaW50ZGlyZWN0ID0gZnVuY3Rpb24oKSB7DQogICAgdGhpcy5vcGVudHlwZSA9ICJwcmludGRpcmVjdCI7DQogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAwKSB7DQogICAgICAgIC8vIHRoaXMucHJpbnQgPSB7fTsNCiAgICAgICAgdGhpcy5wcmludC5wcmludG5hbWUgPSBhcmd1bWVudHNbMF07DQogICAgICAgIHRoaXMucHJpbnQudHJheWlkID0gYXJndW1lbnRzWzFdOw0KICAgICAgICB0aGlzLnByaW50LnN0YXJ0cGFnZSA9IGFyZ3VtZW50c1syXTsNCiAgICAgICAgdGhpcy5wcmludC5lbmRwYWdlID0gYXJndW1lbnRzWzNdOw0KICAgICAgICB0aGlzLnByaW50LmNvcHljb3VudCA9IGFyZ3VtZW50c1s0XTsNCiAgICAgICAgdGhpcy5wcmludC5PcHRpb24gPSAiIjsgLy8gYXJndW1lbnRzWzVdOw0KICAgICAgICB0aGlzLnByaW50b3B0aW9uID0gYXJndW1lbnRzWzVdOw0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIHRoaXMucHJpbnQgPSB7fTsNCiAgICAgICAgdGhpcy5wcmludC5wcmludG5hbWUgPSB0aGlzLnByaW50aW5mby5wcmludG5hbWU7DQogICAgICAgIHRoaXMucHJpbnQudHJheWlkID0gdGhpcy5wcmludGluZm8udHJheWlkOw0KICAgICAgICB0aGlzLnByaW50LnN0YXJ0cGFnZSA9IHRoaXMucHJpbnRpbmZvLnN0YXJ0cGFnZTsNCiAgICAgICAgdGhpcy5wcmludC5lbmRwYWdlID0gdGhpcy5wcmludGluZm8uZW5kcGFnZTsNCiAgICAgICAgdGhpcy5wcmludC5jb3B5Y291bnQgPSB0aGlzLnByaW50aW5mby5jb3B5Y291bnQ7DQogICAgICAgIHRoaXMucHJpbnQuT3B0aW9uID0gIiI7IC8vIHRoaXMucHJpbnRpbmZvLk9wdGlvbjsNCiAgICAgICAgdGhpcy5wcmludG9wdGlvbiA9IHRoaXMucHJpbnRpbmZvLk9wdGlvbjsNCiAgICB9DQogICAgdmFyIG9BZ2VudCA9IG5ldyByZXhfQWdlbnQoKTsNCiAgICBpZiAob0FnZW50LmlzSUUpIHsNCiAgICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJyZXhfaWZybVJleFByZXZpZXciKSA9PSBudWxsKSB7DQogICAgICAgICAgICB2YXIgc0hUTUwgPSAiPGlmcmFtZSBpZD0ncmV4X2lmcm1SZXhQcmV2aWV3JyBzcmM9JyIgKyByZXhfZ3NQcmVWaWV3VVJMICsgIj9pZD0iICsgdGhpcy5pZCArICInIHdpZHRoPScwJyBoZWlnaHQ9JzAnIGZyYW1lYm9yZGVyPScwJz48L2lmcmFtZT4iOw0KICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5pbnNlcnRBZGphY2VudEhUTUwoImJlZm9yZUVuZCIsIHNIVE1MKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJyZXhfaWZybVJleFByZXZpZXciKS5zcmMgPSByZXhfZ3NQcmVWaWV3VVJMICsgIj9pZD0iICsgdGhpcy5pZDsNCiAgICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmV4X2lmcm1SZXhQcmV2aWV3IikgPT0gbnVsbCkgew0KICAgICAgICAgICAgdmFyIHNIVE1MID0gIjxpZnJhbWUgaWQ9J3JleF9pZnJtUmV4UHJldmlldycgc3JjPSciICsgcmV4X2dzUHJlVmlld1VSTCArICI|aWQ9IiArIHRoaXMuaWQsIHdpbmRvdywgcmV4X2dzUHJlVmlld0ZlYXR1cmVzTW9kYWwpOw0KfTsNCg0KcmV4X1BhcmFtU2V0LnByb3RvdHlwZS5wcmludCA9IGZ1bmN0aW9uKCkgew0KICAgIHRoaXMub3BlbnR5cGUgPSAicHJpbnQiOw0KICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMCkgew0KICAgICAgICAvLyB0aGlzLnByaW50ID0ge307DQogICAgICAgIHRoaXMucHJpbnQuZGlhbG9nID0gYXJndW1lbnRzWzBdOw0KICAgICAgICB0aGlzLnByaW50LnN0YXJ0cGFnZSA9IGFyZ3VtZW50c1sxXTsNCiAgICAgICAgdGhpcy5wcmludC5lbmRwYWdlID0gYXJndW1lbnRzWzJdOw0KICAgICAgICB0aGlzLnByaW50LmNvcHljb3VudCA9IGFyZ3VtZW50c1szXTsNCiAgICAgICAgdGhpcy5wcmludC5PcHRpb24gPSAiIjsgLy8gYXJndW1lbnRzWzRdOw0KICAgICAgICB0aGlzLnByaW50b3B0aW9uID0gYXJndW1lbnRzWzRdOw0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIHRoaXMucHJpbnQgPSB7fTsNCiAgICAgICAgdGhpcy5wcmludC5kaWFsb2cgPSB0aGlzLnByaW50aW5mby5kaWFsb2c7DQogICAgICAgIHRoaXMucHJpbnQuc3RhcnRwYWdlID0gdGhpcy5wcmludGluZm8uc3RhcnRwYWdlOw0KICAgICAgICB0aGlzLnByaW50LmVuZHBhZ2UgPSB0aGlzLnByaW50aW5mby5lbmRwYWdlOw0KICAgICAgICB0aGlzLnByaW50LmNvcHljb3VudCA9IHRoaXMucHJpbnRpbmZvLmNvcHljb3VudDsNCiAgICAgICAgdGhpcy5wcmludC5PcHRpb24gPSAiIjsgLy8gdGhpcy5wcmludGluZm8uT3B0aW9uOw0KICAgICAgICB0aGlzLnByaW50b3B0aW9uID0gdGhpcy5wcmludGluZm8uT3B0aW9uOw0KICAgIH0NCiAgICB2YXIgb0FnZW50ID0gbmV3IHJleF9BZ2VudCgpOw0KICAgIGlmIChvQWdlbnQuaXNJRSkgew0KICAgICAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInJleF9pZnJtUmV4UHJldmlldyIpID09IG51bGwpIHsNCiAgICAgICAgICAgIHZhciBzSFRNTCA9ICI8aWZyYW1lIGlkPSdyZXhfaWZybVJleFByZXZpZXcnIHNyYz0nIiArIHJleF9nc1ByZVZpZXdVUkwgKyAiP2lkPSIgKyB0aGlzLmlkICsgIicgd2lkdGg9JzAnIGhlaWdodD0nMCcgZnJhbWVib3JkZXI9JzAnPjwvaWZyYW1lPiI7DQogICAgICAgICAgICBkb2N1bWVudC5ib2R5Lmluc2VydEFkamFjZW50SFRNTCgiYmVmb3JlRW5kIiwgc0hUTUwpOw0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInJleF9pZnJtUmV4UHJldmlldyIpLnNyYyA9IHJleF9nc1ByZVZpZXdVUkwgKyAiP2lkPSIgKyB0aGlzLmlkOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInJleF9pZnJtUmV4UHJldmlldyIpLnNyYyA9IHJleF9nc1ByZVZpZXdVUkwgKyAiP2lkPSIgKyB0aGlzLmlkOw0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJyZXhfaWZybVJleFByZXZpZXciKSA9PSBudWxsKSB7DQogICAgICAgICAgICB2YXIgc0hUTUwgPSAiPGlmcmFtZSBpZD0ncmV4X2lmcm1SZXhQcmV2aWV3JyBzcmM9JyIgKyByZXhfZ3NQcmVWaWV3VVJMICsgIj9pZD0iICsgdGhpcy5pZCArICInIHdpZHRoPScwJyBoZWlnaHQ9JzAnIGZyYW1lYm9yZGVyPScwJz48L2lmcmFtZT4iOw0KICAgICAgICAgICAgLy8gZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgKz0gc0hUTUw7DQogICAgICAgICAgICBkb2N1bWVudC5ib2R5Lmluc2VydEFkamFjZW50SFRNTCgiYmVmb3JlRW5kIiwgc0hUTUwpOw0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInJleF9pZnJtUmV4UHJldmlldyIpLmNvbnRlbnRXaW5kb3cubG9jYXRpb24uaHJlZiA9IHJleF9nc1ByZVZpZXdVUkwgKyAiP2lkPSIgKyB0aGlzLmlkOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInJleF9pZnJtUmV4UHJldmlldyIpLmNvbnRlbnRXaW5kb3cubG9jYXRpb24uaHJlZiA9IHJleF9nc1ByZVZpZXdVUkwgKyAiP2lkPSIgKyB0aGlzLmlkOw0KICAgICAgICB9DQogICAgfQ0KfTsNCg0KLy8gMjAxMC0wNy0yMg0KcmV4X1BhcmFtU2V0LnByb3RvdHlwZS5wcmludGFsbCA9IGZ1bmN0aW9uKCkgew0KICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmV4X2dhUmVwb3J0cy5sZW5ndGg7IGkrKykgew0KICAgICAgICByZXhfZ2FSZXBvcnRzW2ldLm9wZW50eXBlID0gInByaW50IjsNCiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICByZXhfZ2FSZXBvcnRzW2ldLnByaW50aW5mbyA9IHt9Ow0KICAgICAgICAgICAgcmV4X2dhUmVwb3J0c1tpXS5wcmludGluZm8uZGlhbG9nID0gYXJndW1lbnRzWzBdOw0KICAgICAgICAgICAgcmV4X2dhUmVwb3J0c1tpXS5wcmludGluZm8uc3RhcnRwYWdlID0gYXJndW1lbnRzWzFdOw0KICAgICAgICAgICAgcmV4X2dhUmVwb3J0c1tpXS5wcmludGluZm8uZW5kcGFnZSA9IGFyZ3VtZW50c1syXTsNCiAgICAgICAgICAgIHJleF9nYVJlcG9ydHNbaV0ucHJpbnRpbmZvLmNvcHljb3VudCA9IGFyZ3VtZW50c1szXTsNCiAgICAgICAgICAgIHJleF9nYVJlcG9ydHNbaV0ucHJpbnRpbmZvLk9wdGlvbiA9IGFyZ3VtZW50c1s0XTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAodGhpcy5ldmVudC5iZWZvcmVwcmludGFsbGVhY2ggIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICByZXhfZ2FSZXBvcnRzW2ldLmV2ZW50LmJlZm9yZXByaW50YWxsZWFjaCA9IHRoaXMuZXZlbnQuYmVmb3JlcHJpbnRhbGxlYWNoOw0KICAgICAgICB9DQogICAgICAgIGlmICh0aGlzLmV2ZW50LmluaXQgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICByZXhfZ2FSZXBvcnRzW2ldLmV2ZW50LmluaXQgPSB0aGlzLmV2ZW50LmluaXQ7DQogICAgICAgIH0NCiAgICAgICAgaWYgKHRoaXMuZXZlbnQuZmluaXNoZG9jdW1lbnQgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICByZXhfZ2FSZXBvcnRzW2ldLmV2ZW50LmZpbmlzaGRvY3VtZW50ID0gdGhpcy5ldmVudC5maW5pc2hkb2N1bWVudDsNCiAgICAgICAgfQ0KICAgICAgICBpZiAodGhpcy5ldmVudC5maW5pc2hwcmludGFsbGVhY2ggIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICByZXhfZ2FSZXBvcnRzW2ldLmV2ZW50LmZpbmlzaHByaW50YWxsZWFjaCA9IHRoaXMuZXZlbnQuZmluaXNocHJpbnRhbGxlYWNoOw0KICAgICAgICB9DQogICAgICAgIGlmICh0aGlzLmV2ZW50LmZpbmlzaHByaW50YWxsICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgcmV4X2dhUmVwb3J0c1tpXS5ldmVudC5maW5pc2hwcmludGFsbCA9IHRoaXMuZXZlbnQuZmluaXNocHJpbnRhbGw7DQogICAgICAgIH0NCiAgICB9DQogICAgcmV4X1ByaW50QWxsRXZlbnQoIiIsICIiLCAiIik7DQp9Ow0KDQpmdW5jdGlvbiByZXhfUHJpbnRBbGxFdmVudChvUmV4Q3RsLCBzRXZlbnQsIG9BcmdzKSB7DQogICAgdmFyIG9SZXBvcnQ7DQogICAgaWYgKHJleF9nYVJlcG9ydHNJbmRleCA|IjsNCiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuaW5zZXJ0QWRqYWNlbnRIVE1MKCJiZWZvcmVFbmQiLCBzSFRNTCk7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmV4X2lmcm1SZXhQcmV2aWV3Iikuc3JjID0gcmV4X2dzUHJlVmlld1VSTCArICI|IDApIHsNCiAgICAgICAgdGhpcy5zYXZlID0ge307DQogICAgICAgIHRoaXMuc2F2ZS5kaWFsb2cgPSBhcmd1bWVudHNbMF07DQogICAgICAgIHRoaXMuc2F2ZS5maWxldHlwZSA9IGFyZ3VtZW50c1sxXTsNCiAgICAgICAgdGhpcy5zYXZlLmZpbGVOYW1lID0gYXJndW1lbnRzWzJdOw0KICAgICAgICB0aGlzLnNhdmUuc3RhcnRwYWdlID0gYXJndW1lbnRzWzNdOw0KICAgICAgICB0aGlzLnNhdmUuZW5kcGFnZSA9IGFyZ3VtZW50c1s0XTsNCiAgICAgICAgdGhpcy5zYXZlLk9wdGlvbiA9IGFyZ3VtZW50c1s1XTsNCiAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLnNhdmUgPSB7fTsNCiAgICAgICAgdGhpcy5zYXZlLmRpYWxvZyA9IHRoaXMuc2F2ZWluZm8uZGlhbG9nOw0KICAgICAgICB0aGlzLnNhdmUuZmlsZXR5cGUgPSB0aGlzLnNhdmVpbmZvLmZpbGV0eXBlOw0KICAgICAgICB0aGlzLnNhdmUuZmlsZU5hbWUgPSB0aGlzLnNhdmVpbmZvLmZpbGVOYW1lOw0KICAgICAgICB0aGlzLnNhdmUuc3RhcnRwYWdlID0gdGhpcy5zYXZlaW5mby5zdGFydHBhZ2U7DQogICAgICAgIHRoaXMuc2F2ZS5lbmRwYWdlID0gdGhpcy5zYXZlaW5mby5lbmRwYWdlOw0KICAgICAgICB0aGlzLnNhdmUuT3B0aW9uID0gdGhpcy5zYXZlaW5mby5PcHRpb247DQogICAgfQ0KICAgIHZhciBvQWdlbnQgPSBuZXcgcmV4X0FnZW50KCk7DQogICAgaWYgKG9BZ2VudC5pc0lFKSB7DQogICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmV4X2lmcm1SZXhQcmV2aWV3IikgPT0gbnVsbCkgew0KICAgICAgICAgICAgdmFyIHNIVE1MID0gIjxpZnJhbWUgaWQ9J3JleF9pZnJtUmV4UHJldmlldycgc3JjPSciICsgcmV4X2dzUHJlVmlld1VSTCArICI|IHJleF9nYVJlcG9ydHNJbmRleCkgew0KICAgICAgICBvUmVwb3J0ID0gcmV4X2dhUmVwb3J0c1tyZXhfZ2FSZXBvcnRzSW5kZXhdOw0KICAgICAgICBvUmVwb3J0LmV2ZW50LmZpbmlzaHByaW50ID0gcmV4X1ByaW50RGlyZWN0QWxsRXZlbnQ7DQogICAgICAgIG9SZXBvcnQucHJpbnRkaXJlY3QoKTsNCiAgICAgICAgcmV4X2dhUmVwb3J0c0luZGV4Kys7DQogICAgfSBlbHNlIHsNCiAgICAgICAgb1JlcG9ydCA9IHJleF9nYVJlcG9ydHNbcmV4X2dhUmVwb3J0c0luZGV4IC0gMV07DQogICAgICAgIGlmIChvUmVwb3J0LmV2ZW50LmZpbmlzaHByaW50ZGlyZWN0YWxsICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgb1JlcG9ydC5ldmVudC5maW5pc2hwcmludGRpcmVjdGFsbChvUmV4Q3RsLCAiZmluaXNocHJpbnRkaXJlY3RhbGwiLCB7DQogICAgICAgICAgICAgICAgInJlcG9ydHMiIDogcmV4X2dhUmVwb3J0cw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgcmV4X2dhUmVwb3J0cyA9IG5ldyBBcnJheSgpOw0KICAgICAgICByZXhfZ2FSZXBvcnRzSW5kZXggPSAwOw0KICAgIH0NCn0NCg0KcmV4X1BhcmFtU2V0LnByb3RvdHlwZS5zYXZlID0gZnVuY3Rpb24oKSB7DQogICAgdGhpcy5vcGVudHlwZSA9ICJzYXZlIjsNCiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA|aWQ9IiArIHRoaXMuaWQ7DQogICAgICAgIH0NCiAgICB9DQp9Ow0KDQovLyAyMDEwLTA3LTIyDQpyZXhfUGFyYW1TZXQucHJvdG90eXBlLnNhdmVhbGwgPSBmdW5jdGlvbigpIHsNCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJleF9nYVJlcG9ydHMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgcmV4X2dhUmVwb3J0c1tpXS5vcGVudHlwZSA9ICJzYXZlIjsNCiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICByZXhfZ2FSZXBvcnRzW2ldLnNhdmVpbmZvID0ge307DQogICAgICAgICAgICByZXhfZ2FSZXBvcnRzW2ldLnNhdmVpbmZvLmRpYWxvZyA9IGFyZ3VtZW50c1swXTsNCiAgICAgICAgICAgIHJleF9nYVJlcG9ydHNbaV0uc2F2ZWluZm8uZmlsZXR5cGUgPSBhcmd1bWVudHNbMV07DQogICAgICAgICAgICByZXhfZ2FSZXBvcnRzW2ldLnNhdmVpbmZvLmZpbGVOYW1lID0gYXJndW1lbnRzWzJdOw0KICAgICAgICAgICAgcmV4X2dhUmVwb3J0c1tpXS5zYXZlaW5mby5zdGFydHBhZ2UgPSBhcmd1bWVudHNbM107DQogICAgICAgICAgICByZXhfZ2FSZXBvcnRzW2ldLnNhdmVpbmZvLmVuZHBhZ2UgPSBhcmd1bWVudHNbNF07DQogICAgICAgICAgICByZXhfZ2FSZXBvcnRzW2ldLnNhdmVpbmZvLk9wdGlvbiA9IGFyZ3VtZW50c1s1XTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICByZXhfU2F2ZUFsbEV2ZW50KCIiLCAiIiwgIiIpOw0KfTsNCg0KZnVuY3Rpb24gcmV4X1NhdmVBbGxFdmVudChvUmV4Q3RsLCBzRXZlbnQsIG9BcmdzKSB7DQogICAgdmFyIG9SZXBvcnQ7DQogICAgaWYgKHJleF9nYVJlcG9ydHNJbmRleCA|while|IjsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgaWYgKGlzSUUpIHsNCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodElEKS5pbm5lckhUTUwgPSAiPG9iamVjdCBpZD0nIiArIHNJRCArICInIENMQVNTSUQ9J0NMU0lEOkZDMDM1MDk5LTgzM0UtNEFCMS1CRjQ4LTM3RDA4RjVFNTUzQycgd2lkdGg9JyIgKyBzV2lkdGggKyAiJyBoZWlnaHQ9JyIgKyBzSGVpZ2h0ICsgIicvPiI7DQogICAgfQ0KfQ0KDQovLyBQbHVnaW4gRXZlbnQNCmZ1bmN0aW9uIE9uRmluaXNoRG9jdW1lbnQoKSB7DQogICAgdHJ5IHsNCiAgICAgICAgaWYgKHR5cGVvZiAocmV4X2dzTWV0aG9kKSAhPSAidW5kZWZpbmVkIikgew0KICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXhfZ3NNZXRob2QubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICBldmFsKCJSZXhDdGwuIiArIHJleF9nc01ldGhvZFtpXSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9IGNhdGNoIChleCkgew0KICAgIH0NCg0KICAgIGdhUmVwb3J0c0luZGV4VG1wID0gZ2FSZXBvcnRzSW5kZXhUbXAgLSAxOw0KDQogICAgaWYgKGdpZCA9PSAicmV4X3RvYyIpIHsNCiAgICAgICAgaWYgKGdvT09GLmV2ZW50LmZpbmlzaGRvY3VtZW50ICE9IG51bGwpIHsNCiAgICAgICAgICAgIGdvT09GLmV2ZW50LmZpbmlzaGRvY3VtZW50KFJleEN0bCwgImZpbmlzaGRvY3VtZW50IiwgbnVsbCk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGdhUmVwb3J0cy5sZW5ndGggPD0gZ2FSZXBvcnRzSW5kZXggJiYgZ2FSZXBvcnRzSW5kZXhUbXAgPT0gMCkgew0KICAgICAgICAgICAgaWYgKGdvT09GLm9wZW50eXBlID09ICJzYXZlIikgew0KICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZm5UaW1lckV4cG9ydCwgMTAwKTsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoZ29PT0Yub3BlbnR5cGUgPT0gInNhdmV1cGxvYWQiKSB7DQogICAgICAgICAgICAgICAgc2V0VGltZW91dChmblRpbWVyRXhwb3J0VXBsb2FkLCAxMDApOw0KICAgICAgICAgICAgfSBlbHNlIGlmIChnb09PRi5vcGVudHlwZSA9PSAicHJpbnQiKSB7DQogICAgICAgICAgICAgICAgc2V0VGltZW91dChmblRpbWVyUHJpbnQsIDEwMCk7DQogICAgICAgICAgICB9IGVsc2UgaWYgKGdvT09GLm9wZW50eXBlID09ICJwcmludGRpcmVjdCIpIHsNCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZuVGltZXJQcmludERpcmVjdCwgMTAwKTsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoZ29PT0Yub3BlbnR5cGUgPT0gImV4cG9ydCIpIHsNCiAgICAgICAgICAgICAgICBpZiAoIWdvQWdlbnQuaXNJRSkgew0KICAgICAgICAgICAgICAgICAgICB3aW5kb3cuY2xvc2UoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmIChnb09PRi5hdXRvcmVmZXNodGltZSAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dCgiUmV4Q3RsLlJlZnJlc2goKTsiLCBnb09PRi5hdXRvcmVmZXNodGltZSAqIDEwMDApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgaWYgKGdvT09GLmV2ZW50LmZpbmlzaGRvY3VtZW50ICE9IG51bGwpIHsNCiAgICAgICAgICAgIGdvT09GLmV2ZW50LmZpbmlzaGRvY3VtZW50KFJleEN0bCwgImZpbmlzaGRvY3VtZW50IiwgbnVsbCk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoZ29PT0Yub3BlbnR5cGUgPT0gInNhdmUiKSB7DQogICAgICAgICAgICBzZXRUaW1lb3V0KGZuVGltZXJFeHBvcnQsIDEwMCk7DQogICAgICAgIH0gZWxzZSBpZiAoZ29PT0Yub3BlbnR5cGUgPT0gInNhdmV1cGxvYWQiKSB7DQogICAgICAgICAgICBzZXRUaW1lb3V0KGZuVGltZXJFeHBvcnRVcGxvYWQsIDEwMCk7DQogICAgICAgICAgICBpZiAoIWdvQWdlbnQuaXNJRSkgew0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2UgaWYgKGdvT09GLm9wZW50eXBlID09ICJwcmludCIpIHsNCiAgICAgICAgICAgIHNldFRpbWVvdXQoZm5UaW1lclByaW50LCAxMDApOw0KICAgICAgICB9IGVsc2UgaWYgKGdvT09GLm9wZW50eXBlID09ICJwcmludGRpcmVjdCIpIHsNCiAgICAgICAgICAgIHNldFRpbWVvdXQoZm5UaW1lclByaW50RGlyZWN0LCAxMDApOw0KDQogICAgICAgIH0gZWxzZSBpZiAoZ29PT0Yub3BlbnR5cGUgPT0gImV4cG9ydCIpIHsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoZ29PT0YuYXV0b3JlZmVzaHRpbWUgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dCgiUmV4Q3RsLlJlZnJlc2goKTsiLCBnb09PRi5hdXRvcmVmZXNodGltZSAqIDEwMDApOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBPbkZpbmlzaFByaW50KCkgew0KICAgIGlmIChnb09PRi5ldmVudC5maW5pc2hwcmludCAhPSBudWxsKSB7DQogICAgICAgIGdvT09GLmV2ZW50LmZpbmlzaHByaW50KFJleEN0bCwgImZpbmlzaHByaW50IiwgbnVsbCk7DQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBPbkZpbmlzaEV4cG9ydChmaWxlbmFtZSkgew0KICAgIGlmIChnb09PRi5ldmVudC5maW5pc2hleHBvcnQgIT0gbnVsbCkgew0KICAgICAgICBnb09PRi5ldmVudC5maW5pc2hleHBvcnQoUmV4Q3RsLCAiZmluaXNoZXhwb3J0Iiwgew0KICAgICAgICAgICAgImZpbGVuYW1lIiA6IGZpbGVuYW1lDQogICAgICAgIH0pOw0KICAgIH0NCn0NCg0KZnVuY3Rpb24gT25GaW5pc2hVcGxvYWQoU3VjY2VzcywgRmlsZVBhdGgsIFJlc3VsdCkgew0KICAgIGlmIChnb09PRi5ldmVudC5maW5pc2h1cGxvYWQgIT0gbnVsbCkgew0KICAgICAgICBnb09PRi5ldmVudC5maW5pc2h1cGxvYWQoUmV4Q3RsLCAiZmluaXNodXBsb2FkIiwgew0KICAgICAgICAgICAgInN1Y2Nlc3MiIDogU3VjY2VzcywNCiAgICAgICAgICAgICJmaWxlcGF0aCIgOiBGaWxlUGF0aCwNCiAgICAgICAgICAgICJyZXN1bHQiIDogUmVzdWx0DQogICAgICAgIH0pOw0KICAgIH0NCn0NCg0KZnVuY3Rpb24gT25DaGVja0Vycm9yKFJlc3VsdCkgew0KICAgIGlmIChnb09PRi5ldmVudC5jaGVja2Vycm9yICE9IG51bGwpIHsNCiAgICAgICAgZ29PT0YuZXZlbnQuY2hlY2tlcnJvcihSZXhDdGwsICJjaGVja2Vycm9yIiwgUmVzdWx0KTsNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIE1ha2VIeXBlckxpbmtDbGlja2VkQXJnKHNQYXRoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgICAgIlBhdGgiIDogc1BhdGgNCiAgICB9Ow0KfQ0KDQpmdW5jdGlvbiBPbkh5cGVyTGlua0NsaWNrZWQoUGF0aCwgQ2FuY2VsKSB7DQogICAgaWYgKGdvT09GLmV2ZW50Lmh5cGVybGlua2NsaWNrZWQgIT0gbnVsbCkgew0KICAgICAgICBnb09PRi5ldmVudC5oeXBlcmxpbmtjbGlja2VkKFJleEN0bCwgImh5cGVybGlua2NsaWNrZWQiLCBQYXRoKTsNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIE9uQnV0dG9uUHJpbnRDbGlja0JlZm9yZShDYW5jZWwpIHsNCiAgICBpZiAoZ29PT0YuZXZlbnQuYnV0dG9ucHJpbnRjbGlja2JlZm9yZSAhPSBudWxsKSB7DQogICAgICAgIGdvT09GLmV2ZW50LmJ1dHRvbnByaW50Y2xpY2tiZWZvcmUoUmV4Q3RsLCAiYnV0dG9ucHJpbnRjbGlja2JlZm9yZSIsIG51bGwpOw0KICAgIH0NCn0NCg0KZnVuY3Rpb24gT25CdXR0b25QcmludENsaWNrQWZ0ZXIoKSB7DQogICAgaWYgKGdvT09GLmV2ZW50LmJ1dHRvbnByaW50Y2xpY2thZnRlciAhPSBudWxsKSB7DQogICAgICAgIGdvT09GLmV2ZW50LmJ1dHRvbnByaW50Y2xpY2thZnRlcihSZXhDdGwsICJidXR0b25wcmludGNsaWNrYWZ0ZXIiLCBudWxsKTsNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIE9uQnV0dG9uRXhwb3J0Q2xpY2tCZWZvcmUoQ2FuY2VsKSB7DQogICAgaWYgKGdvT09GLmV2ZW50LmJ1dHRvbmV4cG9ydGNsaWNrYmVmb3JlICE9IG51bGwpIHsNCiAgICAgICAgZ29PT0YuZXZlbnQuYnV0dG9uZXhwb3J0Y2xpY2tiZWZvcmUoUmV4Q3RsLCAiYnV0dG9uZXhwb3J0Y2xpY2tiZWZvcmUiLCBudWxsKTsNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIE9uQnV0dG9uRXhwb3J0Q2xpY2tBZnRlcigpIHsNCiAgICBpZiAoZ29PT0YuZXZlbnQuYnV0dG9uZXhwb3J0Y2xpY2thZnRlciAhPSBudWxsKSB7DQogICAgICAgIGdvT09GLmV2ZW50LmJ1dHRvbmV4cG9ydGNsaWNrYWZ0ZXIoUmV4Q3RsLCAiYnV0dG9uZXhwb3J0Y2xpY2thZnRlciIsIG51bGwpOw0KICAgIH0NCn0NCg0KZnVuY3Rpb24gT25CdXR0b25SZWZyZXNoQ2xpY2tCZWZvcmUoQ2FuY2VsKSB7DQogICAgaWYgKGdvT09GLmV2ZW50LmJ1dHRvbnJlZnJlc2hjbGlja2JlZm9yZSAhPSBudWxsKSB7DQogICAgICAgIGdvT09GLmV2ZW50LmJ1dHRvbnJlZnJlc2hjbGlja2JlZm9yZShSZXhDdGwsICJidXR0b25yZWZyZXNoY2xpY2tiZWZvcmUiLCBudWxsKTsNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIE9uQnV0dG9uUmVmcmVzaENsaWNrQWZ0ZXIoKSB7DQogICAgaWYgKGdvT09GLmV2ZW50LmJ1dHRvbnJlZnJlc2hjbGlja2FmdGVyICE9IG51bGwpIHsNCiAgICAgICAgZ29PT0YuZXZlbnQuYnV0dG9ucmVmcmVzaGNsaWNrYWZ0ZXIoUmV4Q3RsLCAiYnV0dG9ucmVmcmVzaGNsaWNrYWZ0ZXIiLCBudWxsKTsNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIE9uQnV0dG9uRXhwb3J0WExTQ2xpY2tCZWZvcmUoQ2FuY2VsKSB7DQogICAgaWYgKGdvT09GLmV2ZW50LmJ1dHRvbmV4cG9ydHhsc2NsaWNrYmVmb3JlICE9IG51bGwpIHsNCiAgICAgICAgZ29PT0YuZXZlbnQuYnV0dG9uZXhwb3J0eGxzY2xpY2tiZWZvcmUoUmV4Q3RsLCAiYnV0dG9uZXhwb3J0eGxzY2xpY2tiZWZvcmUiLCBudWxsKTsNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIE9uQnV0dG9uRXhwb3J0WExTQ2xpY2tBZnRlcigpIHsNCiAgICBpZiAoZ29PT0YuZXZlbnQuYnV0dG9uZXhwb3J0eGxzY2xpY2thZnRlciAhPSBudWxsKSB7DQogICAgICAgIGdvT09GLmV2ZW50LmJ1dHRvbmV4cG9ydHhsc2NsaWNrYWZ0ZXIoUmV4Q3RsLCAiYnV0dG9uZXhwb3J0eGxzY2xpY2thZnRlciIsIG51bGwpOw0KICAgIH0NCn0NCg0KZnVuY3Rpb24gT25CdXR0b25FeHBvcnRQREZDbGlja0JlZm9yZShDYW5jZWwpIHsNCiAgICBpZiAoZ29PT0YuZXZlbnQuYnV0dG9uZXhwb3J0cGRmY2xpY2tiZWZvcmUgIT0gbnVsbCkgew0KICAgICAgICBnb09PRi5ldmVudC5idXR0b25leHBvcnRwZGZjbGlja2JlZm9yZShSZXhDdGwsICJidXR0b25leHBvcnRwZGZjbGlja2JlZm9yZSIsIG51bGwpOw0KICAgIH0NCn0NCg0KZnVuY3Rpb24gT25CdXR0b25FeHBvcnRQREZDbGlja0FmdGVyKCkgew0KICAgIGlmIChnb09PRi5ldmVudC5idXR0b25leHBvcnRwZGZjbGlja2FmdGVyICE9IG51bGwpIHsNCiAgICAgICAgZ29PT0YuZXZlbnQuYnV0dG9uZXhwb3J0cGRmY2xpY2thZnRlcihSZXhDdGwsICJidXR0b25leHBvcnRwZGZjbGlja2FmdGVyIiwgbnVsbCk7DQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBPbkJ1dHRvbkV4cG9ydEhXUENsaWNrQmVmb3JlKENhbmNlbCkgew0KICAgIGlmIChnb09PRi5ldmVudC5idXR0b25leHBvcnRod3BjbGlja2JlZm9yZSAhPSBudWxsKSB7DQogICAgICAgIGdvT09GLmV2ZW50LmJ1dHRvbmV4cG9ydGh3cGNsaWNrYmVmb3JlKFJleEN0bCwgImJ1dHRvbmV4cG9ydGh3cGNsaWNrYmVmb3JlIiwgbnVsbCk7DQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBPbkJ1dHRvbkV4cG9ydEhXUENsaWNrQWZ0ZXIoKSB7DQogICAgaWYgKGdvT09GLmV2ZW50LmJ1dHRvbmV4cG9ydGh3cGNsaWNrYWZ0ZXIgIT0gbnVsbCkgew0KICAgICAgICBnb09PRi5ldmVudC5idXR0b25leHBvcnRod3BjbGlja2FmdGVyKFJleEN0bCwgImJ1dHRvbmV4cG9ydGh3cGNsaWNrYWZ0ZXIiLCBudWxsKTsNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIE9uQ2FuY2VsUHJpbnQoKSB7DQogICAgaWYgKGdvT09GLmV2ZW50LmNhbmNlbHByaW50ICE9IG51bGwpIHsNCiAgICAgICAgZ29PT0YuZXZlbnQuY2FuY2VscHJpbnQoUmV4Q3RsLCAiY2FuY2VscHJpbnQiLCBudWxsKTsNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIE9uQnV0dG9uQ2xvc2VXaW5kb3dDbGlja0JlZm9yZShDYW5jZWwpIHsNCiAgICBpZiAoZ29PT0YuZXZlbnQuYnV0dG9uY2xvc2V3aW5kb3djbGlja2JlZm9yZSAhPSBudWxsKSB7DQogICAgICAgIGdvT09GLmV2ZW50LmJ1dHRvbmNsb3Nld2luZG93Y2xpY2tiZWZvcmUoUmV4Q3RsLCAiYnV0dG9uY2xvc2V3aW5kb3djbGlja2JlZm9yZSIsIG51bGwpOw0KICAgIH0NCn0NCg0KZnVuY3Rpb24gT25CdXR0b25DbG9zZVdpbmRvd0NsaWNrQWZ0ZXIoKSB7DQogICAgaWYgKGdvT09GLmV2ZW50LmJ1dHRvbmNsb3Nld2luZG93Y2xpY2thZnRlciAhPSBudWxsKSB7DQogICAgICAgIGdvT09GLmV2ZW50LmJ1dHRvbmNsb3Nld2luZG93Y2xpY2thZnRlcihSZXhDdGwsICJidXR0b25jbG9zZXdpbmRvd2NsaWNrYWZ0ZXIiLCBudWxsKTsNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIE9uUHJpbnRQYWdlKHRvdGFscGFnZSwgcGFnZSkgew0KICAgIC8vIGFsZXJ0KCItLU9uUHJpbnRQYWdlIiArICIgdG90YWxwYWdlOiIgKyB0b3RhbHBhZ2UgKyAiIHBhZ2U6IiArIHBhZ2UpOw0KICAgIGlmIChnb09PRi5ldmVudC5wcmludHBhZ2UgIT0gbnVsbCkgew0KICAgICAgICBnb09PRi5ldmVudC5wcmludHBhZ2UoUmV4Q3RsLCAicHJpbnRwYWdlIiwgew0KICAgICAgICAgICAgInRvdGFscGFnZSIgOiB0b3RhbHBhZ2UsDQogICAgICAgICAgICAicGFnZSIgOiBwYWdlDQogICAgICAgIH0pOw0KICAgIH0NCn0NCg0KZnVuY3Rpb24gT25SZXhwZXJ0RXJyb3IobmFtZSwgZGVzY3JpcHRpb24pIHsNCiAgICAvLyBhbGVydCgiLS1PblJleHBlcnRFcnJvciIgKyAiIG5hbWU6IiArIG5hbWUgKyAiIGRlc2NyaXB0aW9uOiIgKw0KICAgIC8vIGRlc2NyaXB0aW9uKTsNCiAgICBpZiAoZ29PT0YuZXZlbnQucmV4cGVydGVycm9yICE9IG51bGwpIHsNCiAgICAgICAgZ29PT0YuZXZlbnQucmV4cGVydGVycm9yKFJleEN0bCwgInJleHBlcnRlcnJvciIsIHsNCiAgICAgICAgICAgICJuYW1lIiA6IG5hbWUsDQogICAgICAgICAgICAiZGVzY3JpcHRpb24iIDogZGVzY3JpcHRpb24NCiAgICAgICAgfSk7DQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBPbkNhbmNlbEV4cG9ydCgpIHsNCiAgICBpZiAoZ29PT0YuZXZlbnQuY2FuY2VsZXhwb3J0ICE9IG51bGwpIHsNCiAgICAgICAgZ29PT0YuZXZlbnQuY2FuY2VsZXhwb3J0KFJleEN0bCwgImNhbmNlbGV4cG9ydCIsIG51bGwpOw0KICAgIH0NCn0NCg0KZnVuY3Rpb24gT25GaW5pc2hQcmludFJlc3VsdChyZXN1bHRjb2RlKSB7DQogICAgaWYgKGdvT09GLmV2ZW50LmZpbmlzaHByaW50cmVzdWx0ICE9IG51bGwpIHsNCiAgICAgICAgZ29PT0YuZXZlbnQuZmluaXNocHJpbnRyZXN1bHQoUmV4Q3RsLCAiZmluaXNocHJpbnRyZXN1bHQiLCB7DQogICAgICAgICAgICAicmVzdWx0Y29kZSIgOiByZXN1bHRjb2RlDQogICAgICAgIH0pOw0KICAgIH0NCn0NCg0KZnVuY3Rpb24gT25FcnJvckV2ZW50KGVycm9yWE1MKSB7DQogICAgaWYgKGdvT09GLmV2ZW50LmVycm9yZXZlbnQgIT0gbnVsbCkgew0KICAgICAgICBnb09PRi5ldmVudC5lcnJvcmV2ZW50KFJleEN0bCwgImVycm9yZXZlbnQiLCB7DQogICAgICAgICAgICAiZXJyb3J4bWwiIDogZXJyb3JYTUwNCiAgICAgICAgfSk7DQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBPbkJlZm9yZVByaW50KHByaW50bmFtZSwgZnJvbXBhZ2UsIHRvcGFnZSwgY29waWVzLCBjYW5jZWwpIHsNCiAgICBpZiAoZ29PT0YuZXZlbnQuYmVmb3JlcHJpbnQgIT0gbnVsbCkgew0KICAgICAgICBnb09PRi5ldmVudC5iZWZvcmVwcmludChSZXhDdGwsICJiZWZvcmVwcmludCIsIHsNCiAgICAgICAgICAgICJwcmludG5hbWUiIDogcHJpbnRuYW1lLA0KICAgICAgICAgICAgImZyb21wYWdlIiA6IGZyb21wYWdlLA0KICAgICAgICAgICAgInRvcGFnZSIgOiB0b3BhZ2UsDQogICAgICAgICAgICAiY29waWVzIiA6IGNvcGllcywNCiAgICAgICAgICAgICJjYW5jZWwiIDogY2FuY2VsDQogICAgICAgIH0pOw0KICAgIH0NCn0|IDMpDQogICAgICAgIHNIZWlnaHQgPSBhcmd1bWVudHNbM107DQoNCiAgICB2YXIgaXNJRSA9IHRydWU7DQoNCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5hdmlnYXRvci5taW1lVHlwZXMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgdmFyIG1pbWVUeXBlID0gbmF2aWdhdG9yLm1pbWVUeXBlc1tpXS50eXBlOw0KDQogICAgICAgIGlmIChtaW1lVHlwZS5pbmRleE9mKCJhcHBsaWNhdGlvbi9yZXhwZXJ0My4wLnBsdWdpbiIpID09IDApIHsNCiAgICAgICAgICAgIGlzSUUgPSBmYWxzZTsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRJRCkuaW5uZXJIVE1MID0gIjxvYmplY3QgaWQ9JyIgKyBzSUQgKyAiJyB0eXBlPSciICsgbWltZVR5cGUgKyAiJyB3aWR0aD0nIiArIHNXaWR0aCArICInIGhlaWdodD0nIiArIHNIZWlnaHQgKyAiJy8|do|replace|base64test|IDIpDQogICAgICAgIHNXaWR0aCA9IGFyZ3VtZW50c1syXTsNCiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA|aWQ9IiArIHRoaXMuaWQsICIiLCAiY2VudGVyPXllcyxzY3JvbGxiYXJzPW5vLHN0YXR1cz1ubyx0b29sYmFyPW5vLHJlc2l6YWJsZT0wLGxvY2F0aW9uPW5vLG1lbnU9bm8sIGxlZnQ9MTAwMCwgdG9wPTEwMDAsIHdpZHRoPTEwLGhlaWdodD0xMCIpOw0KICAgIH0NCn07DQoNCi8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQovLyBmblByaW50U2V0dGluZyBjbGFzcyBkZWNsYXJhdGlvbg0KLy8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCmZ1bmN0aW9uIHJleF9mblByaW50U2V0dGluZyhvUmV4Q3RsLCBwcmludG9wdGlvbikgew0KICAgIC8vIHZhciBzYiA9ICIiOw0KICAgIHZhciBhcnJwcmludCA9IHByaW50b3B0aW9uLnNwbGl0KCI7Iik7DQogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJwcmludC5sZW5ndGg7IGkrKykgew0KICAgICAgICBvUmV4Q3RsLlNldENTUygicHJpbnQuIiArIGFycnByaW50W2ldKTsNCiAgICAgICAgLy8gc2IgKz0gIlJleEN0bC5TZXRDU1MoXCJwcmludC4iK2FycnByaW50W2ldKyJcIik7Iik7DQogICAgfQ0KICAgIG9SZXhDdGwuVXBkYXRlQ1NTKCk7DQogICAgLy8gc2IgKz0gIlJleEN0bC5VcGRhdGVDU1MoKTsiKTsNCiAgICAvLyByZXR1cm4gc2I7DQp9DQoNCi8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQovLyBmbkV4cG9ydFZpc2libGUgY2xhc3MgZGVjbGFyYXRpb24NCi8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQpmdW5jdGlvbiByZXhfZm5FeHBvcnRWaXNpYmxlKG9SZXhDdGwsIGV4cG9ydG9wdGlvbikgew0KICAgIC8vIHZhciBzYiA9ICIiOw0KICAgIHZhciBzdHJleHBvcnQgPSBleHBvcnRvcHRpb24uc3BsaXQoIjsiKTsNCiAgICB2YXIgYXJyZXhwb3J0ID0gW107DQogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHJleHBvcnQubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgYXJyZXhwb3J0W2ldID0gc3RyZXhwb3J0W2ldOw0KICAgIH0NCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmV4cG9ydC5sZW5ndGg7IGkrKykgew0KICAgICAgICB2YXIgbGFzdGV4cG9ydCA9IGFycmV4cG9ydFtpXS5zcGxpdCgiPSIpOw0KICAgICAgICAvLyBzYiArPQ0KICAgICAgICAvLyAiUmV4Q3RsLlNldENTUyhcImV4cG9ydC5hcHBlYXJhbmNlLiIrbGFzdGV4cG9ydFswXSsiLnZpc2libGU9IitsYXN0ZXhwb3J0WzFdKyJcIik7Iik7DQogICAgICAgIG9SZXhDdGwuU2V0Q1NTKCJleHBvcnQuYXBwZWFyYW5jZS4iICsgbGFzdGV4cG9ydFswXSArICIudmlzaWJsZT0iICsgbGFzdGV4cG9ydFsxXSk7DQogICAgfQ0KICAgIC8vIHNiICs9ICJSZXhDdGwuVXBkYXRlQ1NTKCk7Iik7DQogICAgb1JleEN0bC5VcGRhdGVDU1MoKTsNCiAgICAvLyByZXR1cm4gc2I7DQp9DQoNCmZ1bmN0aW9uIHJleF9mblRvb2xCYXJCdXR0b25FbmFibGVUcnVlKG9SZXhDdGwsIHRvb2xiYXJidXR0b25vcHRpb24pIHsNCiAgICAvLyB2YXIgc2IgPSAiIjsNCiAgICB2YXIgc3RydG9vbGJhciA9IHRvb2xiYXJidXR0b25vcHRpb24uc3BsaXQoIjsiKTsNCiAgICB2YXIgYXJydG9vbGJhciA9IFtdOw0KICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RydG9vbGJhci5sZW5ndGg7IGkrKykgew0KICAgICAgICBhcnJ0b29sYmFyW2ldID0gc3RydG9vbGJhcltpXTsNCiAgICB9DQogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJ0b29sYmFyLmxlbmd0aDsgaSsrKSB7DQogICAgICAgIHZhciBsYXN0dG9vbGJhciA9IGFycnRvb2xiYXJbaV0uc3BsaXQoIj0iKTsNCiAgICAgICAgLy8gc2IgKz0NCiAgICAgICAgLy8gIlJleEN0bC5TZXRDU1MoXCJleHBvcnQuYXBwZWFyYW5jZS4iK2xhc3RleHBvcnRbMF0rIi52aXNpYmxlPSIrbGFzdGV4cG9ydFsxXSsiXCIpOyIpOw0KICAgICAgICBvUmV4Q3RsLlNldENTUygiYXBwZWFyYW5jZS50b29sYmFyLmJ1dHRvbi4iICsgbGFzdHRvb2xiYXJbMF0gKyAiLnZpc2libGU9IiArIGxhc3R0b29sYmFyWzFdKTsNCiAgICB9DQogICAgLy8gc2IgKz0gIlJleEN0bC5VcGRhdGVDU1MoKTsiKTsNCiAgICBvUmV4Q3RsLlVwZGF0ZUNTUygpOw0KfQ0KLy8gLS0tLS0tLS0tLS0tLS0tIGFqYXggLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KZnVuY3Rpb24gcmV4X2dmR2V0QWpheFJlcXVlc3QoKSB7DQogICAgLy8gaWYgKHdpbmRvdy5YTUxIdHRwUmVxdWVzdCkgew0KICAgIC8vIG5vdGUgSUUNCiAgICAvLyByZXR1cm4gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7DQogICAgLy8gfSBlbHNlIGlmIChXaW5kb3cuQWN0aXZlWE9iamVjdCkgew0KICAgIC8vIElFDQogICAgLy8gcmV0dXJuIG5ldyBBY3RpdmVYT2JqZWN0KCJNaWNyb3NvZnQuWE1MSFRUUCIpOw0KICAgIC8vIHJldHVybiBuZXcgQWN0aXZlWE9iamVjdCgiTXN4bWwyLlhNTEhUVFAiKTsNCiAgICAvLyB9DQogICAgdHJ5IHsNCiAgICAgICAgb2JqID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7DQogICAgfSBjYXRjaCAodHJ5bWljcm9zb2Z0KSB7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBvYmogPSBuZXcgQWN0aXZlWE9iamVjdCgiTXN4bWwyLlhNTEhUVFAiKTsNCiAgICAgICAgfSBjYXRjaCAob3RoZXJtaWNyb3NvZnQpIHsNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgb2JqID0gbmV3IEFjdGl2ZVhPYmplY3QoIk1pY3Jvc29mdC5YTUxIVFRQIik7DQogICAgICAgICAgICB9IGNhdGNoIChmYWlsZWQpIHsNCiAgICAgICAgICAgICAgICBvYmogPSBudWxsOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIHJldHVybiBvYmo7DQp9DQoNCmZ1bmN0aW9uIHJleF9HZXRnb0FqYXgoKSB7DQogICAgcmV0dXJuIG5ldyByZXhfZ29BamF4KCk7DQp9DQoNCmZ1bmN0aW9uIHJleF9nb0FqYXgoKSB7DQogICAgdGhpcy5BamF4ID0gcmV4X2dmR2V0QWpheFJlcXVlc3QoKTsNCiAgICB0aGlzLlNldFJlcXVlc3RIZWFkZXIgPSByZXhfZ29BamF4X1NldFJlcXVlc3RIZWFkZXI7DQogICAgdGhpcy5BZGRQYXJhbWV0ZXIgPSByZXhfZ29BamF4X0FkZFBhcmFtZXRlcjsNCiAgICB0aGlzLk9wZW4gPSByZXhfZ29BamF4X09wZW47DQogICAgdGhpcy5TZW5kID0gcmV4X2dvQWpheF9TZW5kOw0KICAgIC8vIHRoaXMuUmVzcG9uc2UgPSByZXhfZ29BamF4X1Jlc3BvbnNlOw0KICAgIHRoaXMuQWpheC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSByZXhfZ29BamF4X29ucmVhZHlzdGF0ZWNoYW5nZTsNCiAgICB0aGlzLlBhdGggPSAiIjsNCiAgICB0aGlzLlBhcmFtZXRlciA9ICIiOw0KICAgIHRoaXMuUmVzcG9uc2UgPSByZXhfZ29BamF4X1Jlc3BvbnNlOw0KICAgIC8vIHRoaXMuUmV0dXJuRGF0YSA9ICIiOw0KICAgIHRoaXMuTWV0aG9kID0gIlBPU1QiOw0KICAgIHRoaXMuaXNBU3luYyA9IGZhbHNlOw0KICAgIHRoaXMuRGF0YVR5cGUgPSAiWE1MIjsNCiAgICB0aGlzLmlzU2hvd1dhaXQgPSBmYWxzZTsNCiAgICAvLyB0aGlzLlJlcXVlc3RIZWFkZXIgPSBuZXcgT2JqZWN0KCk7DQogICAgLy8gZXZlbnQNCn0NCg0KZnVuY3Rpb24gcmV4X2dvQWpheF9PcGVuKCkgew0KICAgIHRoaXMuQWpheC5vcGVuKHRoaXMuTWV0aG9kLCB0aGlzLlBhdGgsIHRoaXMuaXNBU3luYyk7DQp9DQoNCmZ1bmN0aW9uIHJleF9nb0FqYXhfU2V0UmVxdWVzdEhlYWRlcihzS2V5LCBzVmFsdWUpIHsNCiAgICB0aGlzLkFqYXguc2V0UmVxdWVzdEhlYWRlcihzS2V5LCBzVmFsdWUpOw0KICAgIC8vIHRoaXMuQWpheC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLA0KICAgIC8vICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsNCiAgICAvLyB0aGlzLkFqYXguc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC1UeXBlJywNCiAgICAvLyAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04Jyk7DQogICAgLy8gdGhpcy5BamF4LnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJ0ZXh0L3htbCIpOw0KfQ0KDQpmdW5jdGlvbiByZXhfZ29BamF4X0FkZFBhcmFtZXRlcihzS2V5LCBzVmFsdWUpIHsNCiAgICBpZiAodGhpcy5QYXJhbWV0ZXIgIT0gIiIpDQogICAgICAgIHRoaXMuUGFyYW1ldGVyICs9ICImIjsNCiAgICAvLyB0aGlzLlBhcmFtZXRlciArPSBzS2V5ICsgIj0iICsgZW5jb2RlVVJJKHNWYWx1ZSk7DQogICAgc1ZhbHVlID0gc1ZhbHVlLnJlcGxhY2UoLyUvZywgIiUyNSIpOw0KICAgIHNWYWx1ZSA9IHNWYWx1ZS5yZXBsYWNlKC9cKy9nLCAiJTJCIik7DQogICAgc1ZhbHVlID0gc1ZhbHVlLnJlcGxhY2UoLz0vZywgIiUzRCIpOw0KICAgIHNWYWx1ZSA9IHNWYWx1ZS5yZXBsYWNlKC8mL2csICIlMjYiKTsNCiAgICB0aGlzLlBhcmFtZXRlciArPSBzS2V5ICsgIj0iICsgc1ZhbHVlOw0KfQ0KDQpmdW5jdGlvbiByZXhfZ29BamF4X1NlbmQoc1BhcmFtKSB7DQogICAgLy8gdGhpcy5BamF4LnNlbmQoJ2FzeW5jPXRydWUmb3JnX2lkPScrb3JnX2lkKycmdGJsX2lkPScrdGJsX2lkKycmbHZsPScrbHZsKycmbGFuZz0nK2xhbmcrJyZjdXJvYmpzbj0nK2lkeCsnJm9ial9pdG1fc249JytvYmpfaXRtX3NuKycmb2JqX3Zhcl9pZD0nK29ial92YXJfaWRbaWR4XSsnJmlkeD0nK2lkeCsnJnVzZXI9TlNJJmJhc2ljaXRlbT0mb2JqX2l0ZW09MTM5OTkwMDEnKTsNCiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCAhPSAwKSB7DQogICAgICAgIHRoaXMuUGFyYW1ldGVyID0gYXJndW1lbnRzWzBdOw0KICAgIH0NCiAgICBpZiAodGhpcy5pc0FTeW5jID09IGZhbHNlKSB7DQogICAgICAgIGlmICh0aGlzLk1ldGhvZCA9PSAiUE9TVCIpIHsNCiAgICAgICAgICAgIHRoaXMuQWpheC5zZW5kKHRoaXMuUGFyYW1ldGVyKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHRoaXMuQWpheC5zZW5kKCIiKTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm47DQogICAgfSBlbHNlIHsNCiAgICAgICAgd2luZG93LnNob3dNb2RhbERpYWxvZygiUmV4UHJvZ3Jlc3MuanNwIiwgdGhpcywgImNlbnRlcjp5ZXM7cmVzaXphYmxlOm5vO3Njcm9sbDpubztzdGF0dXM6bm87ZGlhbG9nV2lkdGg6NDAwcHg7ZGlhbG9nSGVpZ2h0OjMwMHB4Iik7DQogICAgfSAvLyBlbmQgaWYNCn0NCg0KZnVuY3Rpb24gcmV4X2dvQWpheF9vbnJlYWR5c3RhdGVjaGFuZ2UoKSB7DQogICAgLyoNCiAgICAgKiBpZiAoIHRoaXMuQWpheC5yZWFkeVN0YXRlPT00ICkgeyBpZiAodGhpcy5BamF4LnN0YXR1cyA9PSAyMDApIHsgaWYNCiAgICAgKiAodGhpcy5EYXRhVHlwZSA9PSAiWE1MIikgeyAvL3JleF9nc0FqYXhfUmV0dXJuRGF0YSA9ICI8P3htbCAiICsNCiAgICAgKiByZXhfZ29BamF4LnJlc3BvbnNlWE1MLmZpcnN0Q2hpbGQubm9kZVZhbHVlICsgIj8|IDAgJiYgcmV4X2dhUmVwb3J0cy5sZW5ndGggPiByZXhfZ2FSZXBvcnRzSW5kZXgpIHsNCiAgICAgICAgb1JlcG9ydCA9IHJleF9nYVJlcG9ydHNbcmV4X2dhUmVwb3J0c0luZGV4XTsNCiAgICAgICAgb1JlcG9ydC5ldmVudC5maW5pc2hleHBvcnQgPSByZXhfU2F2ZUFsbEV2ZW50Ow0KICAgICAgICBvUmVwb3J0LnNhdmUoKTsNCiAgICAgICAgcmV4X2dhUmVwb3J0c0luZGV4Kys7DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gYWxlcnQoImZpbmlzaHNhdmVhbGwiKTsNCiAgICAgICAgcmV4X2dhUmVwb3J0cyA9IG5ldyBBcnJheSgpOw0KICAgICAgICByZXhfZ2FSZXBvcnRzSW5kZXggPSAwOw0KICAgIH0NCn0NCg0KcmV4X1BhcmFtU2V0LnByb3RvdHlwZS5leHBvcnRzZXJ2ZXIgPSBmdW5jdGlvbigpIHsNCiAgICB0aGlzLm9wZW50eXBlID0gImV4cG9ydCI7DQogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAwKSB7DQogICAgICAgIHRoaXMuZXhwb3J0c2VydmljZSA9IHt9Ow0KICAgICAgICB0aGlzLmV4cG9ydHNlcnZpY2UuZmlsZW5hbWUgPSBhcmd1bWVudHNbMF07DQogICAgICAgIHRoaXMuZXhwb3J0c2VydmljZS5maWxldHlwZSA9IGFyZ3VtZW50c1sxXTsNCiAgICAgICAgdGhpcy5leHBvcnRzZXJ2aWNlLmFmdGVyam9iID0gYXJndW1lbnRzWzJdOw0KICAgIH0NCiAgICB2YXIgb0FnZW50ID0gbmV3IHJleF9BZ2VudCgpOw0KICAgIGlmIChvQWdlbnQuaXNJRSkgew0KICAgICAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInJleF9pZnJtUmV4UHJldmlldyIpID09IG51bGwpIHsNCiAgICAgICAgICAgIHZhciBzSFRNTCA9ICI8aWZyYW1lIGlkPSdyZXhfaWZybVJleFByZXZpZXcnIHNyYz0nIiArIHJleF9nc1ByZVZpZXdVUkwgKyAiP2lkPSIgKyB0aGlzLmlkICsgIicgd2lkdGg9JzAnIGhlaWdodD0nMCcgZnJhbWVib3JkZXI9JzAnPjwvaWZyYW1lPiI7DQogICAgICAgICAgICBkb2N1bWVudC5ib2R5Lmluc2VydEFkamFjZW50SFRNTCgiYmVmb3JlRW5kIiwgc0hUTUwpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInJleF9pZnJtUmV4UHJldmlldyIpLnNyYyA9IHJleF9nc1ByZVZpZXdVUkwgKyAiP2lkPSIgKyB0aGlzLmlkOw0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgd2luZG93Lm9wZW4ocmV4X2dzUHJlVmlld1VSTCArICI|IDApIHsNCiAgICAgICAgLy8gYWxlcnQoImZpbmlzaHNhdmVhbGxlYWNoIik7DQogICAgfQ0KICAgIGlmIChyZXhfZ2FSZXBvcnRzLmxlbmd0aCA|IDEpDQogICAgICAgIHNJRCA9IGFyZ3VtZW50c1sxXTsNCiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA|eG1sICIgKw0KICAgICAgICAgICAgICAgIC8vIHJleF9nb0FqYXgucmVzcG9uc2VYTUwuZmlyc3RDaGlsZC5ub2RlVmFsdWUgKyAiPz4iICsNCiAgICAgICAgICAgICAgICAvLyByZXhfZ29BamF4LnJlc3BvbnNlWE1MLmxhc3RDaGlsZC54bWw7DQogICAgICAgICAgICAgICAgLy8gcmV4X2dzQWpheF9SZXR1cm5EYXRhID0gcmV4X2dvQWpheC5yZXNwb25zZVRleHQ7DQogICAgICAgICAgICAgICAgLy8gcmV0dXJuIHRoaXMuQWpheC5yZXNwb25zZVRleHQ7DQogICAgICAgICAgICAgICAgLy8gcmV0dXJuIHRoaXMuQWpheC5yZXNwb25zZVhNTC54bWw7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuQWpheC5yZXNwb25zZVhNTDsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5EYXRhVHlwZSA9PSAiQ1NWIikgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLkFqYXgucmVzcG9uc2VUZXh0Ow0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5BamF4LnJlc3BvbnNlVGV4dDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsgLy8NCiAgICAgICAgICAgIC8vIHJleF9nb0FqYXguZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkNCiAgICAgICAgICAgIC8vIHJleF9nb0FqYXguZ2V0UmVzcG9uc2VIZWFkZXIgKCJoZWFkZXIgbmFtZSIpDQogICAgICAgICAgICAvLyByZXhfZ29BamF4LnJlc3BvbnNlVGV4dDsNCiAgICAgICAgICAgIC8vIHJleF9nb0FqYXgucmVzcG9uc2VYTUwNCiAgICAgICAgICAgIC8vIHJleF9nb0FqYXgucmVzcG9uc2VCb2R5DQogICAgICAgICAgICAvLyByZXhfZ29BamF4LnJlc3BvbnNlU3RyZWFtDQogICAgICAgICAgICAvLyByZXhfZ29BamF4LnJlc3BvbnNlWE1MDQogICAgICAgICAgICAvLyByZXhfZ29BamF4LnN0YXR1cyAvLw0KICAgICAgICAgICAgLy8gcmV4X2dvQWpheC5zdGF0dXNUZXh0IC8vDQogICAgICAgICAgICAvLyByZXR1cm4gdGhpcy5BamF4LnJleF9nb0FqYXguc3RhdHVzVGV4dA0KICAgICAgICAgICAgcmV0dXJuICIiOw0KICAgICAgICB9IC8vIGVuZCBpZg0KICAgIH0gLy8gZW5kIGlmDQp9DQoNCmZ1bmN0aW9uIHJleF9nZkFqYXhFeGN1dGUoc01ldGhvZCwgaXNBU3luYywgc1BhdGgsIHNQYXJhbSwgc0RhdGFUeXBlLCBzUmVxdWVzdEhlYWRlcikgew0KICAgIHZhciBvQ29ubmVjdGlvbiA9IHJleF9HZXRnb0FqYXgoKTsNCiAgICBvQ29ubmVjdGlvbi5NZXRob2QgPSBzTWV0aG9kOw0KICAgIG9Db25uZWN0aW9uLmlzQVN5bmMgPSBpc0FTeW5jOw0KICAgIG9Db25uZWN0aW9uLlBhdGggPSBzUGF0aDsNCiAgICBvQ29ubmVjdGlvbi5EYXRhVHlwZSA9IHNEYXRhVHlwZTsNCiAgICBvQ29ubmVjdGlvbi5PcGVuKCk7DQogICAgaWYgKHNSZXF1ZXN0SGVhZGVyICE9ICIiKSB7DQogICAgICAgIG9Db25uZWN0aW9uLlNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsIHNSZXF1ZXN0SGVhZGVyKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICBvQ29ubmVjdGlvbi5TZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkO2NoYXJzZXQ9RVVDLUtSIik7DQogICAgICAgIC8vIG9Db25uZWN0aW9uLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsDQogICAgICAgIC8vICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7Y2hhcnNldD1VVEYtOCIpOw0KICAgIH0NCiAgICBpZiAoc01ldGhvZCA9PSAiUE9TVCIpIHsNCiAgICAgICAgaWYgKHNQYXJhbSAhPSAiIikgew0KICAgICAgICAgICAgb0Nvbm5lY3Rpb24uU2VuZChzUGFyYW0pOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgb0Nvbm5lY3Rpb24uU2VuZCgpOw0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgb0Nvbm5lY3Rpb24uU2VuZCgpOw0KICAgIH0NCiAgICByZXR1cm4gb0Nvbm5lY3Rpb247DQp9DQoNCi8vIC0tLS0tLS0tLS0tIGFqYXggZW5kIC0tLS0tLS0tLS0tLS0tLS0tLS0tXA0KLy8gVkIgU2NyaXB0IEV2ZW50IEhhbmRsZXINCmZ1bmN0aW9uIGZuVkJFdmVudEhhbmRsZXIob1JleEN0bCwgc0V2ZW50LCBvQXJncykgew0KICAgIGZuUmVwb3J0RXZlbnQob1JleEN0bCwgc0V2ZW50LCBvQXJncyk7DQp9DQoNCi8vIFJleFNjcmlwdCBWZXJzaW9uIEluZm9ybWF0aW9uDQpmdW5jdGlvbiBmblJleFNjcmlwdFZlcnNpb24oKSB7DQogICAgcmV0dXJuIHJleFNjcmlwdF92ZXJzaW9uOw0KfQ0KDQovLyBKYXZhc2NyaXB07JeQ7IScIFBhcmFtZXRlcuulvCDqsIDsoLjsmKTquLAg7JyE7ZWcIO2VqOyImC4NCmZ1bmN0aW9uIGdldFBhcmFtZXRlcih2YXJpYWJsZSkgew0KICAgIHZhciBxdWVyeSA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2guc3Vic3RyaW5nKDEpOw0KICAgIHZhciB2YXJzID0gcXVlcnkuc3BsaXQoIiYiKTsNCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhcnMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgdmFyIHBhaXIgPSB2YXJzW2ldLnNwbGl0KCI9Iik7DQogICAgICAgIGlmIChwYWlyWzBdID09IHZhcmlhYmxlKSB7DQogICAgICAgICAgICByZXR1cm4gcGFpclsxXTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICByZXR1cm4gbnVsbDsNCn0NCg0KZnVuY3Rpb24gZm5QbGFpblJleEN0bCh0SUQpIHsNCiAgICB2YXIgc1dpZHRoID0gIjEwMCUiOw0KICAgIHZhciBzSGVpZ2h0ID0gIjEwMCUiOw0KICAgIHZhciBzSUQgPSAiUmV4Q3RsIjsNCiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA|IiArDQogICAgICogcmV4X2dvQWpheC5yZXNwb25zZVhNTC5sYXN0Q2hpbGQueG1sOyAvL3JleF9nc0FqYXhfUmV0dXJuRGF0YSA9DQogICAgICogcmV4X2dvQWpheC5yZXNwb25zZVRleHQ7DQogICAgICogDQogICAgICogDQogICAgICogLy90aGlzLlJldHVybkRhdGEgPSByZXhfZ29BamF4LnJlc3BvbnNlWE1MLnhtbDsgfSBlbHNlIGlmICh0aGlzLkRhdGFUeXBlID09DQogICAgICogIkNTViIpIHsgLy90aGlzLlJldHVybkRhdGEgPSByZXhfZ29BamF4LnJlc3BvbnNlVGV4dDsgfSBlbHNlIHsNCiAgICAgKiAvL3RoaXMuUmV0dXJuRGF0YSA9IHJleF9nb0FqYXgucmVzcG9uc2VUZXh0OyB9IH0gZWxzZSB7IC8vIGVycm9yIC8vDQogICAgICogcmV4X2dvQWpheC5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSAvLyByZXhfZ29BamF4LmdldFJlc3BvbnNlSGVhZGVyDQogICAgICogKCJoZWFkZXIgbmFtZSIpIC8vIHJleF9nb0FqYXgucmVzcG9uc2VUZXh0OyAvLyByZXhfZ29BamF4LnJlc3BvbnNlWE1MIC8vDQogICAgICogcmV4X2dvQWpheC5yZXNwb25zZUJvZHkgLy8gcmV4X2dvQWpheC5yZXNwb25zZVN0cmVhbSAvLw0KICAgICAqIHJleF9nb0FqYXgucmVzcG9uc2VYTUwgLy8gcmV4X2dvQWpheC5zdGF0dXMgLy8gcmV4X2dvQWpheC5zdGF0dXNUZXh0IH0gLy8NCiAgICAgKiBlbmQgaWYgfSAvLyBlbmQgaWYNCiAgICAgKi8NCn0NCg0KZnVuY3Rpb24gcmV4X2dvQWpheF9SZXNwb25zZSgpIHsNCiAgICBpZiAodGhpcy5BamF4LnJlYWR5U3RhdGUgPT0gNCkgew0KICAgICAgICBpZiAodGhpcy5BamF4LnN0YXR1cyA9PSAyMDApIHsNCiAgICAgICAgICAgIGlmICh0aGlzLkRhdGFUeXBlID09ICJYTUwiKSB7DQogICAgICAgICAgICAgICAgLy8gcmV4X2dzQWpheF9SZXR1cm5EYXRhID0gIjw|PCFbQ0RBVEFbIiArIGRhdGEgKyAiXV0|IjsNCiAgICAgICAgICAgIGlmIChkYXRhdHlwZS50b1VwcGVyQ2FzZSgpID09ICJDU1YiKSB7DQogICAgICAgICAgICAgICAgc2IgKz0gIjxjb25maWctcGFyYW0gbmFtZT0nZGF0YSc|IjsNCiAgICAgICAgICAgIHNiICs9IEFkZENvbmZpZ1BhcmFtczsNCiAgICAgICAgICAgIHNiICs9ICI8L2NvbmZpZy1wYXJhbS1saXN0PiI7DQogICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSAibWVtbyIpIHsNCiAgICAgICAgICAgIHNiICs9ICI8Y29uZmlnLXBhcmFtLWxpc3Q|eval|IjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHNiICs9IEFkZENvbmZpZ1BhcmFtczsNCiAgICAgICAgICAgIHNiICs9ICI8L2NvbmZpZy1wYXJhbS1saXN0PiI7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGRhdGF0eXBlLnRvVXBwZXJDYXNlKCkgPT0gIkNTViIpIHsNCiAgICAgICAgICAgIGlmIChyZXhfZ3NTZXJ2ZXJWZXJzaW9uID09ICIyLjUiKSB7DQogICAgICAgICAgICAgICAgc2IgKz0gIjxjb250ZW50IGNvbnRlbnQtdHlwZT0nY3N2Jz4iOw0KICAgICAgICAgICAgICAgIGlmICh0eXBlID09ICJtZW1vIikgew0KICAgICAgICAgICAgICAgICAgICBzYiArPSAiPGNvbnRlbnQtcGFyYW0gbmFtZT0nY29sLWRlbGltJz4iICsgcmV4X2dzQ3N2U2VwYXJhdG9yQ29sdW1uICsgIjwvY29udGVudC1wYXJhbT4iOw0KICAgICAgICAgICAgICAgICAgICBzYiArPSAiPGNvbnRlbnQtcGFyYW0gbmFtZT0ncm93LWRlbGltJz4iICsgcmV4X2dzQ3N2U2VwYXJhdG9yUm93ICsgIjwvY29udGVudC1wYXJhbT4iOw0KICAgICAgICAgICAgICAgICAgICBzYiArPSAiPGNvbnRlbnQtcGFyYW0gbmFtZT0nZGF0YXNldC1kZWxpbSc|IiArIGRhdGEgKyAiPC9jb25maWctcGFyYW0|IjsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgc2IgKz0gIjxjb25maWctcGFyYW0gbmFtZT0nZGF0YSc|IjsNCiAgICAgICAgICAgIHNDb25maWdQYXJhbXMgKz0gIjxjb25maWctcGFyYW0gbmFtZT0nbWV0aG9kJz4iICsgaHR0cG1ldGhvZCArICI8L2NvbmZpZy1wYXJhbT4iOw0KICAgICAgICAgICAgc0NvbmZpZ1BhcmFtcyArPSAiPGNvbmZpZy1wYXJhbSBuYW1lPSdlbmNvZGluZyc|IjsNCiAgICAgICAgICAgIHNDb25maWdQYXJhbXMgKz0gIjxjb25maWctcGFyYW0gbmFtZT0ncGF0aCc|IjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHZhciBzQ29uZmlnUGFyYW1zID0gIiI7DQogICAgICAgICAgICBzQ29uZmlnUGFyYW1zICs9ICI8Y29uZmlnLXBhcmFtLWxpc3Q|IiArIGh0dHBlbmNvZGluZyArICI8L2NvbmZpZy1wYXJhbT4iOw0KICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb25vbmNlID09ICIxIikgew0KICAgICAgICAgICAgICAgIHNDb25maWdQYXJhbXMgKz0gIjxjb25maWctcGFyYW0gbmFtZT0nY29ubmVjdGlvbi5vbmNlJz4xPC9jb25maWctcGFyYW0|IjsNCg0KICAgICAgICAgICAgc2IgKz0gc0NvbmZpZ1BhcmFtczsNCiAgICAgICAgICAgIHNiICs9IHNIdHRwUGFyYW1zOw0KICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gImZpbGUiKSB7DQogICAgICAgICAgICBzYiArPSAiPGNvbmZpZy1wYXJhbS1saXN0PiI7DQogICAgICAgICAgICBzYiArPSAiPGNvbmZpZy1wYXJhbSBuYW1lPSdjb25uZWN0aW9uLm9uY2UnPjE8L2NvbmZpZy1wYXJhbT4iOw0KICAgICAgICAgICAgc2IgKz0gIjxjb25maWctcGFyYW0gbmFtZT0ncGF0aCc|IjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBzQ29uZmlnUGFyYW1zICs9IEFkZENvbmZpZ1BhcmFtczsNCiAgICAgICAgICAgIHNDb25maWdQYXJhbXMgKz0gIjwvY29uZmlnLXBhcmFtLWxpc3Q|IjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChjb29raWUgIT0gIiIgJiYgY29va2llICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgIHNDb25maWdQYXJhbXMgKz0gIjxjb25maWctcGFyYW0gbmFtZT0nY29va2llJz48IVtDREFUQVsiICsgY29va2llICsgIl1dPjwvY29uZmlnLXBhcmFtPiI7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAocmV4X2dzSHR0cFRpbWVvdXQgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgZm9yICggdmFyIG5rZXkgaW4gcmV4X2dzSHR0cFRpbWVvdXQpIHsNCiAgICAgICAgICAgICAgICAgICAgc0NvbmZpZ1BhcmFtcyArPSAiIDxjb25maWctcGFyYW0gbmFtZT0nIiArIG5rZXkgKyAiJz4iICsgcmV4X2dzSHR0cFRpbWVvdXRbbmtleV0gKyAiPC9jb25maWctcGFyYW0|IiArIGVycm9yeHBhdGggKyAiPC9jb250ZW50LXBhcmFtPiI7DQogICAgICAgICAgICAgICAgICAgIHNEYXRhU2V0cyArPSAiPC9jb250ZW50PiI7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKHNEYXRhU2V0cyA9PSAiIikgew0KICAgICAgICAgICAgICAgIHNEYXRhU2V0cyArPSAiPGNvbnRlbnQgY29udGVudC10eXBlPSd4bWwnPiI7DQogICAgICAgICAgICAgICAgc0RhdGFTZXRzICs9ICI8Y29udGVudC1wYXJhbSBuYW1lPSdyb290Jz4iICsgeHBhdGggKyAiPC9jb250ZW50LXBhcmFtPiI7DQogICAgICAgICAgICAgICAgc0RhdGFTZXRzICs9ICI8Y29udGVudC1wYXJhbSBuYW1lPSdwcmVzZXJ2ZXdoaXRlc3BhY2UnPiIgKyBwcmVzZXJ2ZXdoaXRlc3BhY2UgKyAiPC9jb250ZW50LXBhcmFtPiI7DQogICAgICAgICAgICAgICAgc0RhdGFTZXRzICs9ICI8Y29udGVudC1wYXJhbSBuYW1lPSdiaW5kbW9kZSc|IjsNCiAgICAgICAgICAgICAgICAgICAgc0RhdGFTZXRzICs9ICI8Y29udGVudC1wYXJhbSBuYW1lPSdjaGVjay5lcnJvci54cGF0aCc|ICIwIiA6ICIxIikgKyAiPC9jb250ZW50LXBhcmFtPiI7DQogICAgICAgICAgICAgICAgICAgIHNEYXRhU2V0cyArPSAiPGNvbnRlbnQtcGFyYW0gbmFtZT0nYmluZG1vZGUnPm5hbWU8L2NvbnRlbnQtcGFyYW0|bmFtZTwvY29udGVudC1wYXJhbT4iOw0KICAgICAgICAgICAgICAgIHNEYXRhU2V0cyArPSAiPGNvbnRlbnQtcGFyYW0gbmFtZT0nY2hlY2suZXJyb3IueHBhdGgnPiIgKyBlcnJvcnhwYXRoICsgIjwvY29udGVudC1wYXJhbT4iOw0KICAgICAgICAgICAgICAgIHNEYXRhU2V0cyArPSAiPC9jb250ZW50PiI7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBzYiArPSBzRGF0YVNldHM7DQogICAgICAgIH0NCiAgICAgICAgc2IgKz0gIjwvY29ubmVjdGlvbj4iOw0KICAgICAgICAvLyAyMDExLTA2LTEwDQogICAgICAgIGlmICh0eXBlID09ICJhZG8iKSB7DQogICAgICAgICAgICBzYiA9ICIiOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBzYjsNCiAgICB9Ow0KfSAvLyBlbmQgb2YgcmV4X1JlYkNvbm5lY3Rpb24NCg0KcmV4X1BhcmFtU2V0LnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24oKSB7DQogICAgdGhpcy5vcGVudHlwZSA9ICJvcGVuIjsNCiAgICB2YXIgd29wZW5fYXJncyA9IGFyZ3VtZW50czsNCiAgICB2YXIgb3B0aW9uU3RyID0gIiI7DQogICAgaWYgKHJleF9nc1ByZVZpZXdGZWF0dXJlcy5pbmRleE9mKCJ3aWR0aCIpID09IC0xKSB7DQogICAgICAgIG9wdGlvblN0ciArPSAiLHdpZHRoPTgzNSI7DQogICAgfQ0KICAgIGlmIChyZXhfZ3NQcmVWaWV3RmVhdHVyZXMuaW5kZXhPZigiaGVpZ2h0IikgPT0gLTEpIHsNCiAgICAgICAgb3B0aW9uU3RyICs9ICIsaGVpZ2h0PTYwMCI7DQogICAgfQ0KICAgIHN3aXRjaCAod29wZW5fYXJncy5sZW5ndGgpIHsNCiAgICBjYXNlIDE6DQogICAgICAgIHRoaXMud2luID0gd2luZG93Lm9wZW4ocmV4X2dzUHJlVmlld1VSTCArICI|aWQ9IiArIHRoaXMuaWQ7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChvSWZyYW1lKS5jb250ZW50V2luZG93LmxvY2F0aW9uLmhyZWYgPSByZXhfZ3NQcmVWaWV3VVJMICsgIj9pZD0iICsgdGhpcy5pZDsNCiAgICAgICAgfQ0KICAgIH0NCn07DQoNCnJleF9QYXJhbVNldC5wcm90b3R5cGUuZW1iZWQgPSBmdW5jdGlvbihzUmV4Q3RsKSB7DQogICAgdGhpcy5vcGVudHlwZSA9ICJlbWJlZCI7DQogICAgdmFyIG9BZ2VudCA9IG5ldyByZXhfQWdlbnQoKTsNCiAgICB2YXIgb09PRjsNCiAgICB2YXIgb1JleEN0bDsNCiAgICBvUmV4Q3RsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoc1JleEN0bCk7DQogICAgb09PRiA9IHJleF9nb1BhcmFtU2V0W3RoaXMuaWRdOw0KICAgIGlmIChvQWdlbnQuaXNXaW4pIHsNCiAgICAgICAgdmFyIHByaW50b3B0aW9uID0gb09PRi5wcmludG9wdGlvbjsNCiAgICAgICAgdmFyIGV4cG9ydG9wdGlvbiA9IG9PT0YuZXhwb3J0b3B0aW9uOw0KICAgICAgICB2YXIgdG9vbGJhcmJ1dHRvbm9wdGlvbiA9IG9PT0YudG9vbGJhcmJ1dHRvbm9wdGlvbjsNCiAgICAgICAgaWYgKHByaW50b3B0aW9uICE9IG51bGwpIHsNCiAgICAgICAgICAgIHJleF9mblByaW50U2V0dGluZyhvUmV4Q3RsLCBwcmludG9wdGlvbik7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGV4cG9ydG9wdGlvbiAhPSBudWxsKSB7DQogICAgICAgICAgICByZXhfZm5FeHBvcnRWaXNpYmxlKG9SZXhDdGwsIGV4cG9ydG9wdGlvbik7DQogICAgICAgIH0NCiAgICAgICAgaWYgKHRvb2xiYXJidXR0b25vcHRpb24gIT0gbnVsbCkgew0KICAgICAgICAgICAgcmV4X2ZuVG9vbEJhckJ1dHRvbkVuYWJsZVRydWUob1JleEN0bCwgdG9vbGJhcmJ1dHRvbm9wdGlvbik7DQogICAgICAgIH0NCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIC8vIHZhciBzVmVyID0gb1JleEN0bC5HZXRWZXJzaW9uKCk7DQogICAgICAgIH0gY2F0Y2ggKGV4KSB7DQogICAgICAgICAgICAvLyBhY3RpdmV4IG5vdCBpbnN0YWxsICEhDQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgaWYgKG9PT0YuZXZlbnQuaW5pdCAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIG9PT0YuZXZlbnQuaW5pdChvUmV4Q3RsLCAiaW5pdCIsIG51bGwpOw0KICAgICAgICB9DQogICAgICAgIG9SZXhDdGwuQ2xvc2VBbGwoKTsNCiAgICAgICAgb1JleEN0bC5PcGVuT09GKG9PT0YudG9TdHJpbmcoKSk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgLy8gTWFjLCBMaW51eCwgT3RoZXJzDQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJyZXhfaWZybVJleFByZXZpZXciKS5jb250ZW50V2luZG93LmxvY2F0aW9uLmhyZWYgPSByZXhfZ3NQcmVWaWV3VVJMICsgIj9pZD0iICsgdGhpcy5pZDsNCiAgICAgICAgLyoNCiAgICAgICAgICogZnJtRXhwb3J0U2VydmljZS5hY3Rpb24gPSByZXhfZ3NScHRFeHBvcnRTZXJ2aWNlVVJMOw0KICAgICAgICAgKiBmcm1FeHBvcnRTZXJ2aWNlLm9vZi52YWx1ZSA9IG9PT0YudG9TdHJpbmcoKTsNCiAgICAgICAgICogZnJtRXhwb3J0U2VydmljZS5maWxlbmFtZS52YWx1ZSA9IG9PT0YuZXhwb3J0LmZpbGVuYW1lOw0KICAgICAgICAgKiBmcm1FeHBvcnRTZXJ2aWNlLmZpbGV0eXBlLnZhbHVlID0gb09PRi5leHBvcnQuZmlsZXR5cGU7DQogICAgICAgICAqIGZybUV4cG9ydFNlcnZpY2Uuc3VibWl0KCk7DQogICAgICAgICAqLw0KICAgIH0NCn07DQoNCnJleF9QYXJhbVNldC5wcm90b3R5cGUub3Blbm1vZGFsID0gZnVuY3Rpb24oKSB7DQogICAgdGhpcy5vcGVudHlwZSA9ICJvcGVubW9kYWwiOw0KICAgIHdpbmRvdy5zaG93TW9kYWxEaWFsb2cocmV4X2dzUHJlVmlld1VSTCArICI|aWQ9IiArIHRoaXMuaWQsICIiLCByZXhfZ3NQcmVWaWV3RmVhdHVyZXMgKyAiLHdpZHRoPSIgKyB3b3Blbl9hcmdzWzBdICsgIixoZWlnaHQ9IiArIHdvcGVuX2FyZ3NbMV0gKyAiLCBzdHlsZT1cInJlc2l6ZTpub25lXCIiKTsNCiAgICAgICAgYnJlYWs7DQogICAgY2FzZSAzOg0KICAgICAgICB0aGlzLndpbiA9IHdpbmRvdy5vcGVuKHJleF9nc1ByZVZpZXdVUkwgKyAiP2lkPSIgKyB0aGlzLmlkLCB3b3Blbl9hcmdzWzBdLCByZXhfZ3NQcmVWaWV3RmVhdHVyZXMgKyAiLHdpZHRoPSIgKyB3b3Blbl9hcmdzWzFdICsgIixoZWlnaHQ9IiArIHdvcGVuX2FyZ3NbMl0gKyAiLCBzdHlsZT1cInJlc2l6ZTpub25lXCIiKTsNCiAgICAgICAgYnJlYWs7DQogICAgZGVmYXVsdDoNCiAgICAgICAgdGhpcy53aW4gPSB3aW5kb3cub3BlbihyZXhfZ3NQcmVWaWV3VVJMICsgIj9pZD0iICsgdGhpcy5pZCwgIiIsIHJleF9nc1ByZVZpZXdGZWF0dXJlcyArIG9wdGlvblN0ciArICIsIHN0eWxlPVwicmVzaXplOm5vbmVcIiIpOw0KICAgICAgICBicmVhazsNCiAgICB9DQp9Ow0KDQpyZXhfUGFyYW1TZXQucHJvdG90eXBlLmlmcmFtZSA9IGZ1bmN0aW9uKG9JZnJhbWUpIHsNCiAgICB0aGlzLm9wZW50eXBlID0gImlmcmFtZSI7DQogICAgdmFyIG9BZ2VudCA9IG5ldyByZXhfQWdlbnQoKTsNCiAgICBpZiAob0FnZW50LmlzSUUpIHsNCiAgICAgICAgaWYgKHR5cGVvZiAob0lmcmFtZSkgPT0gIm9iamVjdCIpIHsNCiAgICAgICAgICAgIC8vIG9JZnJhbWUubG9jYXRpb24uaHJlZiA9IHJleF9nc1ByZVZpZXdVUkwgKyAiP2lkPSIgKyB0aGlzLmlkOw0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQob0lmcmFtZS5uYW1lKS5zcmMgPSByZXhfZ3NQcmVWaWV3VVJMICsgIj9pZD0iICsgdGhpcy5pZDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG9JZnJhbWUpLnNyYyA9IHJleF9nc1ByZVZpZXdVUkwgKyAiP2lkPSIgKyB0aGlzLmlkOw0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgaWYgKHR5cGVvZiAob0lmcmFtZSkgPT0gIm9iamVjdCIpIHsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG9JZnJhbWUubmFtZSkuY29udGVudFdpbmRvdy5sb2NhdGlvbi5ocmVmID0gcmV4X2dzUHJlVmlld1VSTCArICI|aWQ9IiArIHRoaXMuaWQsIHdvcGVuX2FyZ3NbMF0sIHJleF9nc1ByZVZpZXdGZWF0dXJlcyArIG9wdGlvblN0ciArICIsIHN0eWxlPVwicmVzaXplOm5vbmVcIiIpOw0KICAgICAgICBicmVhazsNCiAgICBjYXNlIDI6DQogICAgICAgIHRoaXMud2luID0gd2luZG93Lm9wZW4ocmV4X2dzUHJlVmlld1VSTCArICI|IjsNCiAgICAgICAgICAgICAgICBzYiArPSAiPC9jb250ZW50PiI7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHNiICs9ICI8Y29udGVudCBjb250ZW50LXR5cGU9J2Nzdic|IiArIHJleF9nc0NzdlNlcGFyYXRvckRhdGFTZXRfUmV4U2VydmVyMjUgKyAiPC9jb250ZW50LXBhcmFtPiI7DQogICAgICAgICAgICAgICAgICAgIHNiICs9ICI8Y29udGVudC1wYXJhbSBuYW1lPSdkYXRhc2V0LWluZGV4Jz57JWRhdGFzZXQuaW5kZXglfTwvY29udGVudC1wYXJhbT4iOw0KICAgICAgICAgICAgICAgICAgICBlbmNvZGluZyA9ICJ1dGYxNmxlIjsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBzYiArPSAiPGNvbnRlbnQtcGFyYW0gbmFtZT0nY29sLWRlbGltJz4iICsgcmV4X2dzQ3N2U2VwYXJhdG9yQ29sdW1uX1JleFNlcnZlcjI1ICsgIjwvY29udGVudC1wYXJhbT4iOw0KICAgICAgICAgICAgICAgICAgICBzYiArPSAiPGNvbnRlbnQtcGFyYW0gbmFtZT0ncm93LWRlbGltJz4iICsgcmV4X2dzQ3N2U2VwYXJhdG9yUm93X1JleFNlcnZlcjI1ICsgIjwvY29udGVudC1wYXJhbT4iOw0KICAgICAgICAgICAgICAgICAgICBzYiArPSAiPGNvbnRlbnQtcGFyYW0gbmFtZT0nZGF0YXNldC1kZWxpbSc|IiArIHJleF9nc0NzdlNlcGFyYXRvckRhdGFTZXRfUmV4U2VydmVyMjUgKyAiPC9jb250ZW50LXBhcmFtPiI7DQogICAgICAgICAgICAgICAgICAgIC8vIHNiICs9ICI8Y29udGVudC1wYXJhbQ0KICAgICAgICAgICAgICAgICAgICAvLyBuYW1lPSdkYXRhc2V0LWluZGV4Jz57JWRhdGFzZXQuaW5kZXglfTwvY29udGVudC1wYXJhbT4iOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBzYiArPSAiPGNvbnRlbnQtcGFyYW0gbmFtZT0nZW5jb2RpbmcnPiIgKyBlbmNvZGluZyArICI8L2NvbnRlbnQtcGFyYW0|IjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgc2IgKz0gIjxjb250ZW50LXBhcmFtIG5hbWU9J2VuY29kaW5nJz4iICsgZW5jb2RpbmcgKyAiPC9jb250ZW50LXBhcmFtPiI7DQogICAgICAgICAgICAgICAgc2IgKz0gIjwvY29udGVudD4iOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdmFyIHNEYXRhU2V0cyA9ICIiOw0KICAgICAgICAgICAgaWYgKG9EYXRhU2V0cyAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICBmb3IgKCB2YXIga2V5IGluIG9EYXRhU2V0cykgew0KICAgICAgICAgICAgICAgICAgICBzRGF0YVNldHMgKz0gIjxjb250ZW50IGNvbnRlbnQtdHlwZT0neG1sJyBuYW1lc3BhY2U9JyIgKyBrZXkgKyAiJz4iOw0KICAgICAgICAgICAgICAgICAgICBzRGF0YVNldHMgKz0gIjxjb250ZW50LXBhcmFtIG5hbWU9J3Jvb3QnPiIgKyBvRGF0YVNldHNba2V5XS54cGF0aCArICI8L2NvbnRlbnQtcGFyYW0|IjsNCiAgICAgICAgICAgICAgICBzYiArPSAiPGNvbnRlbnQtcGFyYW0gbmFtZT0nY29sLWRlbGltJz4iICsgcmV4X2dzQ3N2U2VwYXJhdG9yQ29sdW1uICsgIjwvY29udGVudC1wYXJhbT4iOw0KICAgICAgICAgICAgICAgIHNiICs9ICI8Y29udGVudC1wYXJhbSBuYW1lPSdyb3ctZGVsaW0nPiIgKyByZXhfZ3NDc3ZTZXBhcmF0b3JSb3cgKyAiPC9jb250ZW50LXBhcmFtPiI7DQogICAgICAgICAgICAgICAgc2IgKz0gIjxjb250ZW50LXBhcmFtIG5hbWU9J2RhdGFzZXQtZGVsaW0nPiIgKyByZXhfZ3NDc3ZTZXBhcmF0b3JEYXRhU2V0ICsgIjwvY29udGVudC1wYXJhbT4iOw0KICAgICAgICAgICAgICAgIGlmICh0eXBlID09ICJtZW1vIikgew0KICAgICAgICAgICAgICAgICAgICBlbmNvZGluZyA9ICJ1dGYxNmxlIjsNCiAgICAgICAgICAgICAgICAgICAgLy8gbWVtbyB0eXBl7J20IOyVhOuLjOqyveyasCDslYTrnpggb29m6rCAIOyCveyeheuQmOuptCDshJzruIzrpqztj6ztirgg642w7J207YSw6rCAIOuCmOyYpOyngCDslYrsnYwuDQogICAgICAgICAgICAgICAgICAgIHNiICs9ICI8Y29udGVudC1wYXJhbSBuYW1lPSdkYXRhc2V0LWluZGV4Jz4iICsgKChkYXRhaW5kZXggIT0gdW5kZWZpbmVkICYmIGRhdGFpbmRleCAhPSAiIikgPyBkYXRhaW5kZXggOiAieyVkYXRhc2V0LmluZGV4JX0iKSArICI8L2NvbnRlbnQtcGFyYW0|IjsNCiAgICAgICAgICAgICAgICAgICAgc0RhdGFTZXRzICs9ICI8Y29udGVudC1wYXJhbSBuYW1lPSdwcmVzZXJ2ZXdoaXRlc3BhY2UnPiIgKyAob0RhdGFTZXRzW2tleV0ucHJlc2VydmV3aGl0ZXNwYWNlID09ICIwIiA'.split('|'),0,{}))
